<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <title>Telegram Bot Web UI (Multi-chat + Media + Notification)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
</head>
<body data-theme="dark">
  <div class="app">
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-header">
        <div class="app-title">Telegram Bot</div>
        <div class="sidebar-actions">
          <button id="themeToggleBtn" class="icon-btn" title="Äá»•i giao diá»‡n" aria-label="Äá»•i giao diá»‡n">ğŸŒ“</button>
          <button id="settingsBtn" class="icon-btn" title="CÃ i Ä‘áº·t" aria-label="CÃ i Ä‘áº·t">âš™ï¸</button>
        </div>
      </div>
      <div class="open-chat">
        <div class="open-chat-wrapper">
          <input id="openChatInput" type="text" placeholder="Nháº­p chat ID hoáº·c @username" />
          <button id="openChatBtn" class="icon-btn primary" title="Má»Ÿ chat" aria-label="Má»Ÿ chat">â¤</button>
        </div>
      </div>
      <div id="chatList" class="chat-list">
        <div id="emptyNotice" class="chat-empty">
          ChÆ°a cÃ³ cuá»™c trÃ² chuyá»‡n. Khi cÃ³ tin nháº¯n Ä‘áº¿n, má»¥c sáº½ hiá»‡n á»Ÿ Ä‘Ã¢y.
        </div>
      </div>
    </aside>

    <main class="chat">
      <div class="chat-header">
        <div class="header-left">
          <button id="menuToggle" class="icon-btn menu-toggle" aria-label="Má»Ÿ danh sÃ¡ch chat">â˜°</button>
          <div id="activeAvatar" class="avatar" style="display:none;">?</div>
          <div>
            <div id="headerTitle" class="header-title">ChÆ°a chá»n cuá»™c trÃ² chuyá»‡n</div>
            <div id="status" class="status">ChÆ°a káº¿t ná»‘i</div>
          </div>
        </div>
        <div class="header-actions">
          <div id="botInfo" class="status"></div>
          <button id="membersBtn" class="icon-btn" title="Quáº£n lÃ½ thÃ nh viÃªn" aria-label="Quáº£n lÃ½ thÃ nh viÃªn" style="display:none;">ğŸ‘¥</button>
        </div>
      </div>

      <div id="messages" class="messages"></div>
      <button id="newMsgBtn" class="floating-btn">â†“ Tin má»›i</button>

      <div class="composer">
        <div id="replyContext" class="reply-context hidden">
          Äang tráº£ lá»i: <span id="replyText"></span>
          <span id="cancelReply" class="cancel-reply" role="button" aria-label="Há»§y tráº£ lá»i">âœ•</span>
        </div>
        <button id="attachBtn" class="icon-btn" title="ÄÃ­nh kÃ¨m" aria-label="ÄÃ­nh kÃ¨m">ğŸ“</button>
        <button id="stickerBtn" class="icon-btn" title="Sticker" aria-label="Sticker">ğŸ˜€</button>
        <input id="input" type="text" placeholder="Nháº­p tin nháº¯n..." disabled />
        <button id="sendBtn" class="icon-btn primary" title="Gá»­i" aria-label="Gá»­i">â¤</button>
        <input id="fileInput" type="file" style="display:none" />
      </div>
      
      <!-- Sticker Panel -->
      <div id="stickerPanel" class="sticker-panel hidden">
        <div class="sticker-panel-header">
          <span>Sticker</span>
          <button id="closeStickerBtn" class="icon-btn" title="ÄÃ³ng">âœ•</button>
        </div>
        <div id="stickerList" class="sticker-list"></div>
      </div>
    </main>
  </div>

  <!-- Settings Overlay -->
  <div id="overlay" class="overlay hidden">
    <div class="dialog dialog-large">
      <div class="dialog-header">
        <h3>Trung tÃ¢m cÃ i Ä‘áº·t</h3>
        <button id="cancelBtn" class="icon-btn" title="ÄÃ³ng" aria-label="ÄÃ³ng">âœ•</button>
      </div>

      <div class="dialog-group">
        <h4>Káº¿t ná»‘i bot</h4>
        <input id="tokenInput" type="password" placeholder="Bot Token (botXXXXXXXX:YYYYYYYYYYYYYYYY)" />
        <div class="row">
          <input id="proxyInput" type="text" placeholder="CORS proxy prefix (tuá»³ chá»n, vd: https://cors.isomorphic-git.org/)" />
          <button id="testBtn" class="btn secondary">Kiá»ƒm tra</button>
        </div>
        <div class="row wrap">
          <button id="deleteWebhookBtn" class="btn danger">XÃ³a webhook</button>
          <button id="notifBtn" class="btn secondary">Báº­t thÃ´ng bÃ¡o</button>
          <button id="saveBtn" class="btn success">LÆ°u &amp; Káº¿t ná»‘i</button>
        </div>
        <div class="hint" id="settingsHint">
          Náº¿u nháº­n lá»—i 409 khi polling, hÃ£y xÃ³a webhook. Náº¿u bá»‹ CORS, thÃªm proxy prefix.
        </div>
      </div>

      <div class="dialog-group">
        <h4>Giao diá»‡n</h4>
        <div class="theme-selector">
          <button id="themeOptionLight" class="theme-option" data-theme="light">
            <span class="icon">ğŸŒ</span>
            <span>SÃ¡ng</span>
          </button>
          <button id="themeOptionDark" class="theme-option" data-theme="dark">
            <span class="icon">ğŸŒš</span>
            <span>Tá»‘i</span>
          </button>
          <button id="themeOptionSystem" class="theme-option" data-theme="system">
            <span class="icon">ğŸ–¥ï¸</span>
            <span>Há»‡ thá»‘ng</span>
          </button>
        </div>
      </div>

      <div class="dialog-group">
        <h4>ThÃ´ng tin bot</h4>
        <div class="bot-details">
          <div><span class="label">TÃªn:</span> <span id="botDetailName">â€”</span></div>
          <div><span class="label">Username:</span> <span id="botDetailUsername">â€”</span></div>
          <div><span class="label">Bot ID:</span> <span id="botDetailId">â€”</span></div>
          <div><span class="label">MÃ´ táº£:</span> <span id="botDetailDescription">â€”</span></div>
          <div><span class="label">MÃ´ táº£ ngáº¯n:</span> <span id="botDetailShortDescription">â€”</span></div>
        </div>
        <div class="bot-section">
          <div class="section-title">Danh sÃ¡ch lá»‡nh</div>
          <ul id="botCommandsList" class="tag-list"></ul>
        </div>
        <div class="bot-section">
          <div class="section-title">TÃ­nh nÄƒng há»— trá»£</div>
          <ul id="botFeatureList" class="tag-list"></ul>
        </div>
      </div>

      <div class="dialog-group">
        <h4>TÃ¹y chá»n</h4>
        <label class="option-item">
          <input id="prefAutoScroll" type="checkbox" checked />
          <span>Tá»± Ä‘á»™ng cuá»™n Ä‘áº¿n tin má»›i</span>
        </label>
        <label class="option-item">
          <input id="prefSound" type="checkbox" checked />
          <span>Ã‚m bÃ¡o thÃ´ng bÃ¡o</span>
        </label>
        <label class="option-item">
          <input id="prefPush" type="checkbox" checked />
          <span>ThÃ´ng bÃ¡o Ä‘áº©y khi tab khÃ´ng hoáº¡t Ä‘á»™ng</span>
        </label>
      </div>
    </div>
  </div>

  <!-- Members Dialog -->
  <div id="membersOverlay" class="overlay hidden">
    <div class="dialog dialog-large members-dialog" id="membersDialog">
      <div class="dialog-header">
        <h3>Quáº£n lÃ½ nhÃ³m</h3>
        <button id="closeMembersBtn" class="icon-btn" title="ÄÃ³ng" aria-label="ÄÃ³ng">âœ•</button>
      </div>
      <div class="dialog-tabs">
        <button id="membersTabBtn" class="dialog-tab active" data-tab="members">ThÃ nh viÃªn</button>
        <button id="groupTabBtn" class="dialog-tab" data-tab="group">ThÃ´ng tin nhÃ³m</button>
      </div>
      <div id="membersTab" class="tab-panel active">
        <p id="groupInfo" class="group-summary">Äang táº£i...</p>
        <div id="membersList" class="members-list"></div>
      </div>
      <div id="groupSettingsTab" class="tab-panel">
        <label class="option-item column">
          <span>TÃªn nhÃ³m</span>
          <input id="groupNameInput" type="text" />
        </label>
        <label class="option-item column">
          <span>MÃ´ táº£</span>
          <textarea id="groupDescriptionInput" rows="3"></textarea>
        </label>
        <label class="option-item column">
          <span>áº¢nh Ä‘áº¡i diá»‡n</span>
          <input id="groupPhotoInput" type="file" accept="image/*" />
        </label>
        <button id="saveGroupBtn" class="btn success full">LÆ°u thay Ä‘á»•i</button>
      </div>
      <div class="actions">
        <div class="hint" id="membersHint"></div>
        <div class="action-buttons">
          <button id="refreshMembersBtn" class="btn secondary">â†» Táº£i láº¡i</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Member Detail Modal -->
  <div id="memberModal" class="overlay hidden">
    <div class="dialog dialog-medium member-modal">
      <div class="dialog-header">
        <h3>ThÃ´ng tin thÃ nh viÃªn</h3>
        <button id="closeMemberModalBtn" class="icon-btn" title="ÄÃ³ng" aria-label="ÄÃ³ng">âœ•</button>
      </div>
      <div class="member-modal-body">
        <div id="memberModalAvatar" class="member-avatar">?</div>
        <div class="member-modal-info">
          <div id="memberModalName" class="member-name">â€”</div>
          <div id="memberModalUsername" class="member-username">â€”</div>
          <div id="memberModalId" class="member-id">â€”</div>
          <div id="memberModalStatus" class="member-status">â€”</div>
          <div id="memberModalJoined" class="member-joined">â€”</div>
        </div>
      </div>
      <div class="member-modal-actions">
        <button id="memberPromoteBtn" class="btn secondary" data-role="admin">â­ ThÄƒng admin</button>
        <button id="memberModeratorBtn" class="btn secondary" data-role="moderator">ğŸ›¡ï¸ Moderator</button>
        <button id="memberDemoteBtn" class="btn secondary" data-role="member">ğŸ‘¤ ThÃ nh viÃªn</button>
        <button id="memberKickBtn" class="btn danger">ğŸš« Kick</button>
      </div>
    </div>
  </div>

  <!-- User Actions Menu -->
  <div id="userActionsMenu" class="user-actions-menu hidden">
    <div class="user-actions-header">
      <span id="userActionsTitle">TÃ¡c vá»¥ vá»›i ngÆ°á»i dÃ¹ng</span>
      <button id="closeUserActionsBtn" class="icon-btn" title="ÄÃ³ng">âœ•</button>
    </div>
    <div class="user-actions-list">
      <button id="kickUserBtn" class="btn danger" data-action="kick">ğŸš« Kick ngÆ°á»i dÃ¹ng</button>
      <button id="promoteUserBtn" class="btn secondary" data-action="promote">â­ ThÄƒng admin</button>
      <button id="moderateUserBtn" class="btn secondary" data-action="moderate">ğŸ›¡ï¸ ThÄƒng moderator</button>
      <button id="demoteUserBtn" class="btn secondary" data-action="demote">ğŸ‘¤ Háº¡ thÃ nh viÃªn</button>
      <button id="restrictUserBtn" class="btn warning" data-action="restrict">ğŸ”’ Háº¡n cháº¿ quyá»n</button>
    </div>
  </div>

  <!-- Toasts -->
  <div id="toasts" class="toasts"></div>

  <script type="module" src="/main.js"></script>
</body>
</html>
