var si=Object.defineProperty;var oi=(r,e,t)=>e in r?si(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var E=(r,e,t)=>oi(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const Er=!1;var or=Array.isArray,ai=Array.prototype.indexOf,ar=Array.from,ui=Object.defineProperty,be=Object.getOwnPropertyDescriptor,nn=Object.getOwnPropertyDescriptors,li=Object.prototype,ci=Array.prototype,ur=Object.getPrototypeOf;function rt(r){return typeof r=="function"}function di(r){return r()}function Vt(r){for(var e=0;e<r.length;e++)r[e]()}const X=2,sn=4,ft=8,lr=16,fe=32,Je=64,Tt=128,je=256,Et=512,q=1024,ge=2048,Ze=4096,ue=8192,Xe=16384,hi=32768,Lt=65536,fi=1<<17,pi=1<<19,on=1<<20,Ce=Symbol("$state"),an=Symbol("legacy props"),mi=Symbol("");function un(r){return r===this.v}function gi(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function cr(r){return!gi(r,this.v)}function _i(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function vi(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function yi(r){throw new Error("https://svelte.dev/e/effect_orphan")}function wi(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function bi(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function Ci(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Mi(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function ki(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function Si(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let pt=!1,Ii=!1;function Ti(){pt=!0}const dr=1,hr=2,ln=4,Ei=8,Ai=16,xi=1,Fi=2,cn=4,Pi=8,Ri=16,Li=2,V=Symbol(),dn="http://www.w3.org/2000/svg";function K(r,e){var t={f:0,v:r,reactions:null,equals:un,rv:0,wv:0};return t}function fr(r){return Ni(K(r))}function hn(r,e=!1){var n;const t=K(r);return e||(t.equals=cr),pt&&O!==null&&O.l!==null&&((n=O.l).s??(n.s=[])).push(t),t}function Ni(r){return R!==null&&R.f&X&&(ce===null?Wi([r]):ce.push(r)),r}function G(r,e){return R!==null&&gt()&&R.f&(X|lr)&&(ce===null||!ce.includes(r))&&Si(),Yt(r,e)}function Yt(r,e){return r.equals(e)||(r.v,r.v=e,r.wv=An(),fn(r,ge),gt()&&F!==null&&F.f&q&&!(F.f&(fe|Je))&&(pe===null?Vi([r]):pe.push(r))),e}function fn(r,e){var t=r.reactions;if(t!==null)for(var n=gt(),i=t.length,s=0;s<i;s++){var o=t[s],c=o.f;c&ge||!n&&o===F||(ne(o,e),c&(q|je)&&(c&X?fn(o,Ze):Dt(o)))}}let pn=!1;function B(r,e=null,t){if(typeof r!="object"||r===null||Ce in r)return r;const n=ur(r);if(n!==li&&n!==ci)return r;var i=new Map,s=or(r),o=K(0);s&&i.set("length",K(r.length));var c;return new Proxy(r,{defineProperty(a,u,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&Ci();var l=i.get(u);return l===void 0?(l=K(d.value),i.set(u,l)):G(l,B(d.value,c)),!0},deleteProperty(a,u){var d=i.get(u);if(d===void 0)u in a&&i.set(u,K(V));else{if(s&&typeof u=="string"){var l=i.get("length"),h=Number(u);Number.isInteger(h)&&h<l.v&&G(l,h)}G(d,V),Ar(o)}return!0},get(a,u,d){var m;if(u===Ce)return r;var l=i.get(u),h=u in a;if(l===void 0&&(!h||(m=be(a,u))!=null&&m.writable)&&(l=K(B(h?a[u]:V,c)),i.set(u,l)),l!==void 0){var p=I(l);return p===V?void 0:p}return Reflect.get(a,u,d)},getOwnPropertyDescriptor(a,u){var d=Reflect.getOwnPropertyDescriptor(a,u);if(d&&"value"in d){var l=i.get(u);l&&(d.value=I(l))}else if(d===void 0){var h=i.get(u),p=h==null?void 0:h.v;if(h!==void 0&&p!==V)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return d},has(a,u){var p;if(u===Ce)return!0;var d=i.get(u),l=d!==void 0&&d.v!==V||Reflect.has(a,u);if(d!==void 0||F!==null&&(!l||(p=be(a,u))!=null&&p.writable)){d===void 0&&(d=K(l?B(a[u],c):V),i.set(u,d));var h=I(d);if(h===V)return!1}return l},set(a,u,d,l){var w;var h=i.get(u),p=u in a;if(s&&u==="length")for(var m=d;m<h.v;m+=1){var g=i.get(m+"");g!==void 0?G(g,V):m in a&&(g=K(V),i.set(m+"",g))}h===void 0?(!p||(w=be(a,u))!=null&&w.writable)&&(h=K(void 0),G(h,B(d,c)),i.set(u,h)):(p=h.v!==V,G(h,B(d,c)));var y=Reflect.getOwnPropertyDescriptor(a,u);if(y!=null&&y.set&&y.set.call(l,d),!p){if(s&&typeof u=="string"){var C=i.get("length"),b=Number(u);Number.isInteger(b)&&b>=C.v&&G(C,b+1)}Ar(o)}return!0},ownKeys(a){I(o);var u=Reflect.ownKeys(a).filter(h=>{var p=i.get(h);return p===void 0||p.v!==V});for(var[d,l]of i)l.v!==V&&!(d in a)&&u.push(d);return u},setPrototypeOf(){Mi()}})}function Ar(r,e=1){G(r,r.v+e)}var xr,mn,gn;function ji(){if(xr===void 0){xr=window;var r=Element.prototype,e=Node.prototype;mn=be(e,"firstChild").get,gn=be(e,"nextSibling").get,r.__click=void 0,r.__className="",r.__attributes=null,r.__styles=null,r.__e=void 0,Text.prototype.__t=void 0}}function Nt(r=""){return document.createTextNode(r)}function Ye(r){return mn.call(r)}function jt(r){return gn.call(r)}function A(r,e){return Ye(r)}function pr(r,e){{var t=Ye(r);return t instanceof Comment&&t.data===""?jt(t):t}}function P(r,e=1,t=!1){let n=r;for(;e--;)n=jt(n);return n}function Ui(r){r.textContent=""}function we(r){var e=X|ge;F===null?e|=je:F.f|=on;var t=R!==null&&R.f&X?R:null;const n={children:null,ctx:O,deps:null,equals:un,f:e,fn:r,reactions:null,rv:0,v:null,wv:0,parent:t??F};return t!==null&&(t.children??(t.children=[])).push(n),n}function _n(r){const e=we(r);return e.equals=cr,e}function vn(r){var e=r.children;if(e!==null){r.children=null;for(var t=0;t<e.length;t+=1){var n=e[t];n.f&X?mr(n):de(n)}}}function $i(r){for(var e=r.parent;e!==null;){if(!(e.f&X))return e;e=e.parent}return null}function yn(r){var e,t=F;he($i(r));try{vn(r),e=Fn(r)}finally{he(t)}return e}function wn(r){var e=yn(r),t=(Pe||r.f&je)&&r.deps!==null?Ze:q;ne(r,t),r.equals(e)||(r.v=e,r.wv=An())}function mr(r){vn(r),ct(r,0),ne(r,Xe),r.v=r.children=r.deps=r.ctx=r.reactions=null}function bn(r){F===null&&R===null&&yi(),R!==null&&R.f&je&&vi(),yr&&_i()}function Di(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function et(r,e,t,n=!0){var i=(r&Je)!==0,s=F,o={ctx:O,deps:null,deriveds:null,nodes_start:null,nodes_end:null,f:r|ge,first:null,fn:e,last:null,next:null,parent:i?null:s,prev:null,teardown:null,transitions:null,wv:0};if(t){var c=qe;try{Fr(!0),wr(o),o.f|=hi}catch(d){throw de(o),d}finally{Fr(c)}}else e!==null&&Dt(o);var a=t&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&(on|Tt))===0;if(!a&&!i&&n&&(s!==null&&Di(o,s),R!==null&&R.f&X)){var u=R;(u.children??(u.children=[])).push(o)}return o}function Oi(r){const e=et(ft,null,!1);return ne(e,q),e.teardown=r,e}function at(r){bn();var e=F!==null&&(F.f&fe)!==0&&O!==null&&!O.m;if(e){var t=O;(t.e??(t.e=[])).push({fn:r,effect:F,reaction:R})}else{var n=gr(r);return n}}function Bi(r){return bn(),_r(r)}function Qi(r){const e=et(Je,r,!0);return(t={})=>new Promise(n=>{t.outro?ut(e,()=>{de(e),n(void 0)}):(de(e),n(void 0))})}function gr(r){return et(sn,r,!1)}function _r(r){return et(ft,r,!0)}function le(r){return mt(r)}function mt(r,e=0){return et(ft|lr|e,r,!0)}function Le(r,e=!0){return et(ft|fe,r,!0,e)}function Cn(r){var e=r.teardown;if(e!==null){const t=yr,n=R;Pr(!0),Me(null);try{e.call(null)}finally{Pr(t),Me(n)}}}function Mn(r){var e=r.deriveds;if(e!==null){r.deriveds=null;for(var t=0;t<e.length;t+=1)mr(e[t])}}function kn(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){var n=t.next;de(t,e),t=n}}function Gi(r){for(var e=r.first;e!==null;){var t=e.next;e.f&fe||de(e),e=t}}function de(r,e=!0){var t=!1;if((e||r.f&pi)&&r.nodes_start!==null){for(var n=r.nodes_start,i=r.nodes_end;n!==null;){var s=n===i?null:jt(n);n.remove(),n=s}t=!0}kn(r,e&&!t),Mn(r),ct(r,0),ne(r,Xe);var o=r.transitions;if(o!==null)for(const a of o)a.stop();Cn(r);var c=r.parent;c!==null&&c.first!==null&&Sn(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=null}function Sn(r){var e=r.parent,t=r.prev,n=r.next;t!==null&&(t.next=n),n!==null&&(n.prev=t),e!==null&&(e.first===r&&(e.first=n),e.last===r&&(e.last=t))}function ut(r,e){var t=[];vr(r,t,!0),In(t,()=>{de(r),e&&e()})}function In(r,e){var t=r.length;if(t>0){var n=()=>--t||e();for(var i of r)i.out(n)}else e()}function vr(r,e,t){if(!(r.f&ue)){if(r.f^=ue,r.transitions!==null)for(const o of r.transitions)(o.is_global||t)&&e.push(o);for(var n=r.first;n!==null;){var i=n.next,s=(n.f&Lt)!==0||(n.f&fe)!==0;vr(n,e,s?t:!1),n=i}}}function lt(r){Tn(r,!0)}function Tn(r,e){if(r.f&ue){r.f^=ue,r.f&q||(r.f^=q),_t(r)&&(ne(r,ge),Dt(r));for(var t=r.first;t!==null;){var n=t.next,i=(t.f&Lt)!==0||(t.f&fe)!==0;Tn(t,i?e:!1),t=n}if(r.transitions!==null)for(const s of r.transitions)(s.is_global||e)&&s.in()}}let zt=!1,Kt=[];function qi(){zt=!1;const r=Kt.slice();Kt=[],Vt(r)}function Ut(r){zt||(zt=!0,queueMicrotask(qi)),Kt.push(r)}let kt=!1,At=!1,xt=null,qe=!1,yr=!1;function Fr(r){qe=r}function Pr(r){yr=r}let Ht=[],st=0;let R=null;function Me(r){R=r}let F=null;function he(r){F=r}let ce=null;function Wi(r){ce=r}let H=null,Z=0,pe=null;function Vi(r){pe=r}let En=1,Ft=0,Pe=!1,O=null;function An(){return++En}function gt(){return!pt||O!==null&&O.l===null}function _t(r){var u;var e=r.f;if(e&ge)return!0;if(e&Ze){var t=r.deps,n=(e&je)!==0;if(t!==null){var i,s,o=(e&Et)!==0,c=n&&F!==null&&!Pe,a=t.length;if(o||c){for(i=0;i<a;i++)s=t[i],(o||!((u=s==null?void 0:s.reactions)!=null&&u.includes(r)))&&(s.reactions??(s.reactions=[])).push(r);o&&(r.f^=Et)}for(i=0;i<a;i++)if(s=t[i],_t(s)&&wn(s),s.wv>r.wv)return!0}(!n||F!==null&&!Pe)&&ne(r,q)}return!1}function Yi(r,e){for(var t=e;t!==null;){if(t.f&Tt)try{t.fn(r);return}catch{t.f^=Tt}t=t.parent}throw kt=!1,r}function zi(r){return(r.f&Xe)===0&&(r.parent===null||(r.parent.f&Tt)===0)}function $t(r,e,t,n){if(kt){if(t===null&&(kt=!1),zi(e))throw r;return}t!==null&&(kt=!0);{Yi(r,e);return}}function xn(r,e,t=0){var n=r.reactions;if(n!==null)for(var i=0;i<n.length;i++){var s=n[i];s.f&X?xn(s,e,t+1):e===s&&(t===0?ne(s,ge):s.f&q&&ne(s,Ze),Dt(s))}}function Fn(r){var h;var e=H,t=Z,n=pe,i=R,s=Pe,o=ce,c=O,a=r.f;H=null,Z=0,pe=null,R=a&(fe|Je)?null:r,Pe=!qe&&(a&je)!==0,ce=null,O=r.ctx,Ft++;try{var u=(0,r.fn)(),d=r.deps;if(H!==null){var l;if(ct(r,Z),d!==null&&Z>0)for(d.length=Z+H.length,l=0;l<H.length;l++)d[Z+l]=H[l];else r.deps=d=H;if(!Pe)for(l=Z;l<d.length;l++)((h=d[l]).reactions??(h.reactions=[])).push(r)}else d!==null&&Z<d.length&&(ct(r,Z),d.length=Z);if(gt()&&pe!==null&&!(r.f&(X|Ze|ge)))for(l=0;l<pe.length;l++)xn(pe[l],r);return i!==null&&Ft++,u}finally{H=e,Z=t,pe=n,R=i,Pe=s,ce=o,O=c}}function Ki(r,e){let t=e.reactions;if(t!==null){var n=ai.call(t,r);if(n!==-1){var i=t.length-1;i===0?t=e.reactions=null:(t[n]=t[i],t.pop())}}t===null&&e.f&X&&(H===null||!H.includes(e))&&(ne(e,Ze),e.f&(je|Et)||(e.f^=Et),ct(e,0))}function ct(r,e){var t=r.deps;if(t!==null)for(var n=e;n<t.length;n++)Ki(r,t[n])}function wr(r){var e=r.f;if(!(e&Xe)){ne(r,q);var t=F,n=O;F=r;try{e&lr?Gi(r):kn(r),Mn(r),Cn(r);var i=Fn(r);r.teardown=typeof i=="function"?i:null,r.wv=En;var s=r.deps,o;Er&&Ii&&r.f&ge}catch(c){$t(c,r,t,n||r.ctx)}finally{F=t}}}function Hi(){if(st>1e3){st=0;try{wi()}catch(r){if(xt!==null)$t(r,xt,null);else throw r}}st++}function Ji(r){var e=r.length;if(e!==0){Hi();var t=qe;qe=!0;try{for(var n=0;n<e;n++){var i=r[n];i.f&q||(i.f^=q);var s=[];Pn(i,s),Zi(s)}}finally{qe=t}}}function Zi(r){var e=r.length;if(e!==0)for(var t=0;t<e;t++){var n=r[t];if(!(n.f&(Xe|ue)))try{_t(n)&&(wr(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?Sn(n):n.fn=null))}catch(i){$t(i,n,null,n.ctx)}}}function Xi(){if(At=!1,st>1001)return;const r=Ht;Ht=[],Ji(r),At||(st=0,xt=null)}function Dt(r){At||(At=!0,queueMicrotask(Xi)),xt=r;for(var e=r;e.parent!==null;){e=e.parent;var t=e.f;if(t&(Je|fe)){if(!(t&q))return;e.f^=q}}Ht.push(e)}function Pn(r,e){var t=r.first,n=[];e:for(;t!==null;){var i=t.f,s=(i&fe)!==0,o=s&&(i&q)!==0,c=t.next;if(!o&&!(i&ue))if(i&ft){if(s)t.f^=q;else try{_t(t)&&wr(t)}catch(l){$t(l,t,null,t.ctx)}var a=t.first;if(a!==null){t=a;continue}}else i&sn&&n.push(t);if(c===null){let l=t.parent;for(;l!==null;){if(r===l)break e;var u=l.next;if(u!==null){t=u;continue e}l=l.parent}}t=c}for(var d=0;d<n.length;d++)a=n[d],e.push(a),Pn(a,e)}function I(r){var d;var e=r.f,t=(e&X)!==0;if(t&&e&Xe){var n=yn(r);return mr(r),n}if(R!==null){ce!==null&&ce.includes(r)&&ki();var i=R.deps;r.rv<Ft&&(r.rv=Ft,H===null&&i!==null&&i[Z]===r?Z++:H===null?H=[r]:H.push(r))}else if(t&&r.deps===null)for(var s=r,o=s.parent,c=s;o!==null;)if(o.f&X){var a=o;c=a,o=a.parent}else{var u=o;(d=u.deriveds)!=null&&d.includes(c)||(u.deriveds??(u.deriveds=[])).push(c);break}return t&&(s=r,_t(s)&&wn(s)),r.v}function dt(r){const e=R;try{return R=null,r()}finally{R=e}}const es=-7169;function ne(r,e){r.f=r.f&es|e}function Rr(r,e=1){var t=I(r),n=e===1?t++:t--;return G(r,t),n}function ke(r,e=!1,t){O={p:O,c:null,e:null,m:!1,s:r,x:null,l:null},pt&&!e&&(O.l={s:null,u:null,r1:[],r2:K(!1)})}function Se(r){const e=O;if(e!==null){const o=e.e;if(o!==null){var t=F,n=R;e.e=null;try{for(var i=0;i<o.length;i++){var s=o[i];he(s.effect),Me(s.reaction),gr(s.fn)}}finally{he(t),Me(n)}}O=e.p,e.m=!0}return{}}function ts(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(Ce in r)Jt(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&Ce in t&&Jt(t)}}}function Jt(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let n in r)try{Jt(r[n],e)}catch{}const t=ur(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const n=nn(t);for(let i in n){const s=n[i].get;if(s)try{s.call(r)}catch{}}}}}function rs(r){return r.endsWith("capture")&&r!=="gotpointercapture"&&r!=="lostpointercapture"}const ns=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function is(r){return ns.includes(r)}const ss={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject"};function os(r){return r=r.toLowerCase(),ss[r]??r}const as=["touchstart","touchmove"];function us(r){return as.includes(r)}function ls(r,e){if(e){const t=document.body;r.autofocus=!0,Ut(()=>{document.activeElement===t&&r.focus()})}}let Lr=!1;function cs(){Lr||(Lr=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Rn(r){var e=R,t=F;Me(null),he(null);try{return r()}finally{Me(e),he(t)}}function ds(r,e,t,n=t){r.addEventListener(e,()=>Rn(t));const i=r.__on_r;i?r.__on_r=()=>{i(),n(!0)}:r.__on_r=()=>n(!0),cs()}const Ln=new Set,Zt=new Set;function Nn(r,e,t,n){function i(s){if(n.capture||it.call(e,s),!s.cancelBubble)return Rn(()=>t.call(this,s))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?Ut(()=>{e.addEventListener(r,i,n)}):e.addEventListener(r,i,n),i}function jn(r,e,t,n,i){var s={capture:n,passive:i},o=Nn(r,e,t,s);(e===document.body||e===window||e===document)&&Oi(()=>{e.removeEventListener(r,o,s)})}function tt(r){for(var e=0;e<r.length;e++)Ln.add(r[e]);for(var t of Zt)t(r)}function it(r){var b;var e=this,t=e.ownerDocument,n=r.type,i=((b=r.composedPath)==null?void 0:b.call(r))||[],s=i[0]||r.target,o=0,c=r.__root;if(c){var a=i.indexOf(c);if(a!==-1&&(e===document||e===window)){r.__root=e;return}var u=i.indexOf(e);if(u===-1)return;a<=u&&(o=a)}if(s=i[o]||r.target,s!==e){ui(r,"currentTarget",{configurable:!0,get(){return s||t}});var d=R,l=F;Me(null),he(null);try{for(var h,p=[];s!==null;){var m=s.assignedSlot||s.parentNode||s.host||null;try{var g=s["__"+n];if(g!==void 0&&!s.disabled)if(or(g)){var[y,...C]=g;y.apply(s,[r,...C])}else g.call(s,r)}catch(w){h?p.push(w):h=w}if(r.cancelBubble||m===e||m===null)break;s=m}if(h){for(let w of p)queueMicrotask(()=>{throw w});throw h}}finally{r.__root=e,delete r.currentTarget,Me(d),he(l)}}}function br(r){var e=document.createElement("template");return e.innerHTML=r,e.content}function vt(r,e){var t=F;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function te(r,e){var t=(e&Li)!==0,n,i=!r.startsWith("<!>");return()=>{n===void 0&&(n=br(i?r:"<!>"+r),n=Ye(n));var s=t?document.importNode(n,!0):n.cloneNode(!0);return vt(s,s),s}}function hs(r,e,t="svg"){var n=!r.startsWith("<!>"),i=`<${t}>${n?r:"<!>"+r}</${t}>`,s;return()=>{if(!s){var o=br(i),c=Ye(o);s=Ye(c)}var a=s.cloneNode(!0);return vt(a,a),a}}function Cr(){var r=document.createDocumentFragment(),e=document.createComment(""),t=Nt();return r.append(e,t),vt(e,t),r}function Q(r,e){r!==null&&r.before(e)}function re(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=t,r.nodeValue=t==null?"":t+"")}function fs(r,e){return ps(r,e)}const Oe=new Map;function ps(r,{target:e,anchor:t,props:n={},events:i,context:s,intro:o=!0}){ji();var c=new Set,a=l=>{for(var h=0;h<l.length;h++){var p=l[h];if(!c.has(p)){c.add(p);var m=us(p);e.addEventListener(p,it,{passive:m});var g=Oe.get(p);g===void 0?(document.addEventListener(p,it,{passive:m}),Oe.set(p,1)):Oe.set(p,g+1)}}};a(ar(Ln)),Zt.add(a);var u=void 0,d=Qi(()=>{var l=t??e.appendChild(Nt());return Le(()=>{if(s){ke({});var h=O;h.c=s}i&&(n.$$events=i),u=r(l,n)||{},s&&Se()}),()=>{var m;for(var h of c){e.removeEventListener(h,it);var p=Oe.get(h);--p===0?(document.removeEventListener(h,it),Oe.delete(h)):Oe.set(h,p)}Zt.delete(a),l!==t&&((m=l.parentNode)==null||m.removeChild(l))}});return ms.set(u,d),u}let ms=new WeakMap;function ht(r,e,t=!1){var n=r,i=null,s=null,o=V,c=t?Lt:0,a=!1;const u=(l,h=!0)=>{a=!0,d(h,l)},d=(l,h)=>{o!==(o=l)&&(o?(i?lt(i):h&&(i=Le(()=>h(n))),s&&ut(s,()=>{s=null})):(s?lt(s):h&&(s=Le(()=>h(n))),i&&ut(i,()=>{i=null})))};mt(()=>{a=!1,e(u),a||d(null,null)},c)}function Mr(r,e){return e}function gs(r,e,t,n){for(var i=[],s=e.length,o=0;o<s;o++)vr(e[o].e,i,!0);var c=s>0&&i.length===0&&t!==null;if(c){var a=t.parentNode;Ui(a),a.append(t),n.clear(),ye(r,e[0].prev,e[s-1].next)}In(i,()=>{for(var u=0;u<s;u++){var d=e[u];c||(n.delete(d.k),ye(r,d.prev,d.next)),de(d.e,!c)}})}function kr(r,e,t,n,i,s=null){var o=r,c={flags:e,items:new Map,first:null},a=(e&ln)!==0;if(a){var u=r;o=u.appendChild(Nt())}var d=null,l=!1,h=_n(()=>{var p=t();return or(p)?p:p==null?[]:ar(p)});mt(()=>{var p=I(h),m=p.length;if(!(l&&m===0)){l=m===0;{var g=R;_s(p,c,o,i,e,(g.f&ue)!==0,n)}s!==null&&(m===0?d?lt(d):d=Le(()=>s(o)):d!==null&&ut(d,()=>{d=null})),I(h)}})}function _s(r,e,t,n,i,s,o,c){var v,_,S,L;var a=(i&Ei)!==0,u=(i&(dr|hr))!==0,d=r.length,l=e.items,h=e.first,p=h,m,g=null,y,C=[],b=[],w,T,M,k;if(a)for(k=0;k<d;k+=1)w=r[k],T=o(w,k),M=l.get(T),M!==void 0&&((v=M.a)==null||v.measure(),(y??(y=new Set)).add(M));for(k=0;k<d;k+=1){if(w=r[k],T=o(w,k),M=l.get(T),M===void 0){var U=p?p.e.nodes_start:t;g=ys(U,e,g,g===null?e.first:g.next,w,T,k,n,i),l.set(T,g),C=[],b=[],p=g.next;continue}if(u&&vs(M,w,k,i),M.e.f&ue&&(lt(M.e),a&&((_=M.a)==null||_.unfix(),(y??(y=new Set)).delete(M))),M!==p){if(m!==void 0&&m.has(M)){if(C.length<b.length){var x=b[0],$;g=x.prev;var ie=C[0],Ie=C[C.length-1];for($=0;$<C.length;$+=1)Nr(C[$],x,t);for($=0;$<b.length;$+=1)m.delete(b[$]);ye(e,ie.prev,Ie.next),ye(e,g,ie),ye(e,Ie,x),p=x,g=Ie,k-=1,C=[],b=[]}else m.delete(M),Nr(M,p,t),ye(e,M.prev,M.next),ye(e,M,g===null?e.first:g.next),ye(e,g,M),g=M;continue}for(C=[],b=[];p!==null&&p.k!==T;)(s||!(p.e.f&ue))&&(m??(m=new Set)).add(p),b.push(p),p=p.next;if(p===null)continue;M=p}C.push(M),g=M,p=M.next}if(p!==null||m!==void 0){for(var se=m===void 0?[]:ar(m);p!==null;)(s||!(p.e.f&ue))&&se.push(p),p=p.next;var Te=se.length;if(Te>0){var yt=i&ln&&d===0?t:null;if(a){for(k=0;k<Te;k+=1)(S=se[k].a)==null||S.measure();for(k=0;k<Te;k+=1)(L=se[k].a)==null||L.fix()}gs(e,se,yt,l)}}a&&Ut(()=>{var ee;if(y!==void 0)for(M of y)(ee=M.a)==null||ee.apply()}),F.first=e.first&&e.first.e,F.last=g&&g.e}function vs(r,e,t,n){n&dr&&Yt(r.v,e),n&hr?Yt(r.i,t):r.i=t}function ys(r,e,t,n,i,s,o,c,a,u){var d=(a&dr)!==0,l=(a&Ai)===0,h=d?l?hn(i):K(i):i,p=a&hr?K(o):o,m={i:p,v:h,k:s,a:null,e:null,prev:t,next:n};try{return m.e=Le(()=>c(r,h,p),pn),m.e.prev=t&&t.e,m.e.next=n&&n.e,t===null?e.first=m:(t.next=m,t.e.next=m.e),n!==null&&(n.prev=m,n.e.prev=m.e),m}finally{}}function Nr(r,e,t){for(var n=r.next?r.next.e.nodes_start:t,i=e?e.e.nodes_start:t,s=r.e.nodes_start;s!==n;){var o=jt(s);i.before(s),s=o}}function ye(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function ws(r,e,t,n,i){var s=r,o="",c;mt(()=>{o!==(o=e()??"")&&(c!==void 0&&(de(c),c=void 0),o!==""&&(c=Le(()=>{var a=o+"",u=br(a);vt(Ye(u),u.lastChild),s.before(u)})))})}function Sr(r,e,t,n,i){var c;var s=(c=e.$$slots)==null?void 0:c[t],o=!1;s===!0&&(s=e.children,o=!0),s===void 0||s(r,o?()=>n:n)}function bs(r,e,t,n,i,s){var o,c,a=null,u=r,d;mt(()=>{const l=e()||null;var h=dn;l!==o&&(d&&(l===null?ut(d,()=>{d=null,c=null}):l===c?lt(d):de(d)),l&&l!==c&&(d=Le(()=>{a=document.createElementNS(h,l),vt(a,a);{var p=a.appendChild(Nt());n(a,p)}F.nodes_end=a,u.before(a)})),o=l,o&&(c=o))},Lt)}function Un(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=Un(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Cs(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=Un(r))&&(n&&(n+=" "),n+=e);return n}function Ms(r){return typeof r=="object"?Cs(r):r??""}function ks(r,e){e?r.hasAttribute("selected")||r.setAttribute("selected",""):r.removeAttribute("selected")}function Ss(r,e,t,n){var i=r.__attributes??(r.__attributes={});i[e]!==(i[e]=t)&&(e==="style"&&"__styles"in r&&(r.__styles={}),e==="loading"&&(r[mi]=t),t==null?r.removeAttribute(e):typeof t!="string"&&$n(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function jr(r,e,t,n,i=!1,s=!1,o=!1){var c=e||{},a=r.tagName==="OPTION";for(var u in e)u in t||(t[u]=null);t.class&&(t.class=Ms(t.class));var d=$n(r),l=r.__attributes??(r.__attributes={});for(const b in t){let w=t[b];if(a&&b==="value"&&w==null){r.value=r.__value="",c[b]=w;continue}var h=c[b];if(w!==h){c[b]=w;var p=b[0]+b[1];if(p!=="$$"){if(p==="on"){const T={},M="$$"+b;let k=b.slice(2);var m=is(k);if(rs(k)&&(k=k.slice(0,-7),T.capture=!0),!m&&h){if(w!=null)continue;r.removeEventListener(k,c[M],T),c[M]=null}if(w!=null)if(m)r[`__${k}`]=w,tt([k]);else{let U=function(x){c[b].call(this,x)};var C=U;c[M]=Nn(k,r,U,T)}else m&&(r[`__${k}`]=void 0)}else if(b==="style"&&w!=null)r.style.cssText=w+"";else if(b==="autofocus")ls(r,!!w);else if(b==="__value"||b==="value"&&w!=null)r.value=r[b]=r.__value=w;else if(b==="selected"&&a)ks(r,w);else{var g=b;i||(g=os(g));var y=g==="defaultValue"||g==="defaultChecked";if(w==null&&!s&&!y)if(l[b]=null,g==="value"||g==="checked"){let T=r;if(g==="value"){let M=T.defaultValue;T.removeAttribute(g),T.defaultValue=M}else{let M=T.defaultChecked;T.removeAttribute(g),T.defaultChecked=M}}else r.removeAttribute(b);else y||d.includes(g)&&(s||typeof w!="string")?r[g]=w:typeof w!="function"&&Ss(r,g,w)}b==="style"&&"__styles"in r&&(r.__styles={})}}}return c}var Ur=new Map;function $n(r){var e=Ur.get(r.nodeName);if(e)return e;Ur.set(r.nodeName,e=[]);for(var t,n=r,i=Element.prototype;i!==n;){t=nn(n);for(var s in t)t[s].set&&e.push(s);n=ur(n)}return e}function Ge(r,e,t){var n=r.__className,i=Is(e);(n!==i||pn)&&(e==null?r.removeAttribute("class"):r.className=i,r.__className=i)}function Is(r,e){return(r??"")+""}function Dn(r,e,t=e){var n=gt();ds(r,"input",i=>{var s=i?r.defaultValue:r.value;if(s=Ot(r)?Bt(s):s,t(s),n&&s!==(s=e())){var o=r.selectionStart,c=r.selectionEnd;r.value=s??"",c!==null&&(r.selectionStart=o,r.selectionEnd=Math.min(c,r.value.length))}}),dt(e)==null&&r.value&&t(Ot(r)?Bt(r.value):r.value),_r(()=>{var i=e();Ot(r)&&i===Bt(r.value)||r.type==="date"&&!i&&!r.value||i!==r.value&&(r.value=i??"")})}function Ot(r){var e=r.type;return e==="number"||e==="range"}function Bt(r){return r===""?null:+r}function $r(r,e){return r===e||(r==null?void 0:r[Ce])===e}function Ts(r={},e,t,n){return gr(()=>{var i,s;return _r(()=>{i=s,s=[],dt(()=>{r!==t(...s)&&(e(r,...s),i&&$r(t(...i),r)&&e(null,...i))})}),()=>{Ut(()=>{s&&$r(t(...s),r)&&e(null,...s)})}}),r}function Es(r=!1){const e=O,t=e.l.u;if(!t)return;let n=()=>ts(e.s);if(r){let i=0,s={};const o=we(()=>{let c=!1;const a=e.s;for(const u in a)a[u]!==s[u]&&(s[u]=a[u],c=!0);return c&&i++,i});n=()=>I(o)}t.b.length&&Bi(()=>{Dr(e,n),Vt(t.b)}),at(()=>{const i=dt(()=>t.m.map(di));return()=>{for(const s of i)typeof s=="function"&&s()}}),t.a.length&&at(()=>{Dr(e,n),Vt(t.a)})}function Dr(r,e){if(r.l.s)for(const t of r.l.s)I(t);e()}let wt=!1;function As(r){var e=wt;try{return wt=!1,[r(),wt]}finally{wt=e}}const xs={get(r,e){if(!r.exclude.includes(e))return I(r.version),e in r.special?r.special[e]():r.props[e]},set(r,e,t){return e in r.special||(r.special[e]=xe({get[e](){return r.props[e]}},e,cn)),r.special[e](t),Rr(r.version),!0},getOwnPropertyDescriptor(r,e){if(!r.exclude.includes(e)&&e in r.props)return{enumerable:!0,configurable:!0,value:r.props[e]}},deleteProperty(r,e){return r.exclude.includes(e)||(r.exclude.push(e),Rr(r.version)),!0},has(r,e){return r.exclude.includes(e)?!1:e in r.props},ownKeys(r){return Reflect.ownKeys(r.props).filter(e=>!r.exclude.includes(e))}};function Pt(r,e){return new Proxy({props:r,exclude:e,special:{},version:K(0)},xs)}const Fs={get(r,e){let t=r.props.length;for(;t--;){let n=r.props[t];if(rt(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n)return n[e]}},set(r,e,t){let n=r.props.length;for(;n--;){let i=r.props[n];rt(i)&&(i=i());const s=be(i,e);if(s&&s.set)return s.set(t),!0}return!1},getOwnPropertyDescriptor(r,e){let t=r.props.length;for(;t--;){let n=r.props[t];if(rt(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n){const i=be(n,e);return i&&!i.configurable&&(i.configurable=!0),i}}},has(r,e){if(e===Ce||e===an)return!1;for(let t of r.props)if(rt(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(r){const e=[];for(let t of r.props){rt(t)&&(t=t());for(const n in t)e.includes(n)||e.push(n)}return e}};function On(...r){return new Proxy({props:r},Fs)}function Or(r){for(var e=F,t=F;e!==null&&!(e.f&(fe|Je));)e=e.parent;try{return he(e),r()}finally{he(t)}}function xe(r,e,t,n){var U;var i=(t&xi)!==0,s=!pt||(t&Fi)!==0,o=(t&Pi)!==0,c=(t&Ri)!==0,a=!1,u;o?[u,a]=As(()=>r[e]):u=r[e];var d=Ce in r||an in r,l=o&&(((U=be(r,e))==null?void 0:U.set)??(d&&e in r&&(x=>r[e]=x)))||void 0,h=n,p=!0,m=!1,g=()=>(m=!0,p&&(p=!1,c?h=dt(n):h=n),h);u===void 0&&n!==void 0&&(l&&s&&bi(),u=g(),l&&l(u));var y;if(s)y=()=>{var x=r[e];return x===void 0?g():(p=!0,m=!1,x)};else{var C=Or(()=>(i?we:_n)(()=>r[e]));C.f|=fi,y=()=>{var x=I(C);return x!==void 0&&(h=void 0),x===void 0?h:x}}if(!(t&cn))return y;if(l){var b=r.$$legacy;return function(x,$){return arguments.length>0?((!s||!$||b||a)&&l($?y():x),x):y()}}var w=!1,T=!1,M=hn(u),k=Or(()=>we(()=>{var x=y(),$=I(M);return w?(w=!1,T=!0,$):(T=!1,M.v=x)}));return i||(k.equals=cr),function(x,$){if(arguments.length>0){const ie=$?I(k):s&&o?B(x):x;return k.equals(ie)||(w=!0,G(M,ie),m&&h!==void 0&&(h=ie),dt(()=>I(k))),x}return I(k)}}const Ps="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ps);const Br=new Map;function Rs(r){const e=Array.isArray(r)?r:[r],t=e.join(","),n=Br.get(t)??(()=>{const i=Bn(e),s=Ls(i);return Br.set(t,s),s})();return i=>n(i)}function Bn(r){return Array.isArray(r)?r.map(e=>e.split(":")):[r.split(":")]}function Ls(r){const e=r.flatMap(i=>Ns(i,Qn(i))),t=Us(e),n=$s(t);return i=>!!n(i.update,i)}function Qn(r){const e=St,t=[r].flatMap(n=>{const[i,s,o]=n;if(!(i in zr))return[n];if(!i&&!s&&!o)return[n];const a=zr[i].map(u=>[u,s,o]);return s===void 0||s in Gt&&(s||o)?a:a.filter(([u])=>{var d;return!!((d=e[u])!=null&&d[s])})}).flatMap(n=>{const[i,s,o]=n;if(!(s in Gt))return[n];if(!s&&!o)return[n];const a=Gt[s].map(u=>[i,u,o]);return o===void 0?a:a.filter(([,u])=>{var d,l;return!!((l=(d=e[i])==null?void 0:d[u])!=null&&l[o])})});if(t.length===0)throw new Error(`Shortcuts in '${r.join(":")}' do not expand to any valid filter query`);return t}function Ns(r,e){if(e.length===0)throw new Error("Empty filter query given");const t=e.map(js).filter(n=>n!==!0);if(t.length===0)return e;throw t.length===1?new Error(t[0]):new Error(`Invalid filter query '${r.join(":")}'. There are ${t.length} errors after expanding the contained shortcuts: ${t.join("; ")}`)}function js(r){const[e,t,n,...i]=r;if(e===void 0)return"Empty filter query given";if(!(e in St)){const c=Object.keys(St);return`Invalid L1 filter '${e}' given in '${r.join(":")}'. Permitted values are: ${c.map(a=>`'${a}'`).join(", ")}.`}if(t===void 0)return!0;const s=St[e];if(!(t in s)){const c=Object.keys(s);return`Invalid L2 filter '${t}' given in '${r.join(":")}'. Permitted values are: ${c.map(a=>`'${a}'`).join(", ")}.`}if(n===void 0)return!0;const o=s[t];if(!(n in o)){const c=Object.keys(o);return`Invalid L3 filter '${n}' given in '${r.join(":")}'. ${c.length===0?`No further filtering is possible after '${e}:${t}'.`:`Permitted values are: ${c.map(a=>`'${a}'`).join(", ")}.`}`}return i.length===0?!0:`Cannot filter further than three levels, ':${i.join(":")}' is invalid!`}function Us(r){const e={};for(const[t,n,i]of r){const s=e[t]??(e[t]={});if(n!==void 0){const o=s[n]??(s[n]=new Set);i!==void 0&&o.add(i)}}return e}function Qt(r,e){return(t,n)=>r(t,n)||e(t,n)}function Qr(r,e){return(t,n)=>{const i=r(t,n);return i&&e(i,n)}}function Gr(r){return(e,t)=>r(e,t)!=null}function $s(r){const e=Object.entries(r).map(([t,n])=>{const i=o=>o[t],s=Object.entries(n).map(([o,c])=>{const a=d=>d[o],u=Array.from(c).map(d=>d==="me"?(h,p)=>{const m=p.me.id;return qr(h,g=>g.id===m)}:h=>qr(h,p=>p[d]||p.type===d));return u.length===0?Gr(a):Qr(a,u.reduce(Qt))});return s.length===0?Gr(i):Qr(i,s.reduce(Qt))});if(e.length===0)throw new Error("Cannot create filter function for empty query");return e.reduce(Qt)}function qr(r,e){const t=n=>n!=null&&e(n);return Array.isArray(r)?r.some(t):t(r)}const Wr={mention:{},hashtag:{},cashtag:{},bot_command:{},url:{},email:{},phone_number:{},bold:{},italic:{},underline:{},strikethrough:{},spoiler:{},blockquote:{},expandable_blockquote:{},code:{},pre:{},text_link:{},text_mention:{},custom_emoji:{}},Xt={me:{},is_bot:{},is_premium:{},added_to_attachment_menu:{}},Ds={user:{},hidden_user:{},chat:{},channel:{}},Os={is_video:{},is_animated:{},premium_animation:{}},er={emoji:{},custom_emoji:{},paid:{}},Gn={forward_origin:Ds,is_topic_message:{},is_automatic_forward:{},business_connection_id:{},text:{},animation:{},audio:{},document:{},paid_media:{},photo:{},sticker:Os,story:{},video:{},video_note:{},voice:{},contact:{},dice:{},game:{},poll:{},venue:{},location:{},entities:Wr,caption_entities:Wr,caption:{},effect_id:{},has_media_spoiler:{},new_chat_title:{},new_chat_photo:{},delete_chat_photo:{},message_auto_delete_timer_changed:{},pinned_message:{},invoice:{},proximity_alert_triggered:{},chat_background_set:{},giveaway_created:{},giveaway:{only_new_members:{},has_public_winners:{}},giveaway_winners:{only_new_members:{},was_refunded:{}},giveaway_completed:{},video_chat_scheduled:{},video_chat_started:{},video_chat_ended:{},video_chat_participants_invited:{},web_app_data:{}},bt={...Gn,new_chat_members:Xt,left_chat_member:Xt,group_chat_created:{},supergroup_chat_created:{},migrate_to_chat_id:{},migrate_from_chat_id:{},successful_payment:{},refunded_payment:{},users_shared:{},chat_shared:{},connected_website:{},write_access_allowed:{},passport_data:{},boost_added:{},forum_topic_created:{},forum_topic_edited:{name:{},icon_custom_emoji_id:{}},forum_topic_closed:{},forum_topic_reopened:{},general_forum_topic_hidden:{},general_forum_topic_unhidden:{},sender_boost_count:{}},Vr={...Gn,channel_chat_created:{}},Bs={can_reply:{},is_enabled:{}},Qs={old_reaction:er,new_reaction:er},Gs={reactions:er},qs={data:{},game_short_name:{}},Yr={from:Xt},St={message:bt,edited_message:bt,channel_post:Vr,edited_channel_post:Vr,business_connection:Bs,business_message:bt,edited_business_message:bt,deleted_business_messages:{},inline_query:{},chosen_inline_result:{},callback_query:qs,shipping_query:{},pre_checkout_query:{},poll:{},poll_answer:{},my_chat_member:Yr,chat_member:Yr,chat_join_request:{},message_reaction:Qs,message_reaction_count:Gs,chat_boost:{},removed_chat_boost:{},purchased_paid_media:{}},zr={"":["message","channel_post"],msg:["message","channel_post"],edit:["edited_message","edited_channel_post"]},Gt={"":["entities","caption_entities"],media:["photo","video"],file:["photo","animation","audio","document","video","video_note","voice","sticker"]},ae={filterQuery(r){const e=Rs(r);return t=>e(t)},text(r){const e=ae.filterQuery([":text",":caption"]),t=Ee(r);return n=>{if(!e(n))return!1;const i=n.message??n.channelPost,s=i.text??i.caption;return Ae(n,s,t)}},command(r){const e=ae.filterQuery(":entities:bot_command"),t=new Set,n=new Set;return Rt(r).forEach(i=>{if(i.startsWith("/"))throw new Error(`Do not include '/' when registering command handlers (use '${i.substring(1)}' not '${i}')`);(i.includes("@")?t:n).add(i)}),i=>{if(!e(i))return!1;const s=i.message??i.channelPost,o=s.text??s.caption;return s.entities.some(c=>{if(c.type!=="bot_command"||c.offset!==0)return!1;const a=o.substring(1,c.length);if(n.has(a)||t.has(a))return i.match=o.substring(a.length+1).trimStart(),!0;const u=a.indexOf("@");if(u===-1)return!1;const d=a.substring(u+1).toLowerCase(),l=i.me.username.toLowerCase();if(d!==l)return!1;const h=a.substring(0,u);return n.has(h)?(i.match=o.substring(a.length+1).trimStart(),!0):!1})}},reaction(r){const e=ae.filterQuery("message_reaction"),t=typeof r=="string"?[{type:"emoji",emoji:r}]:(Array.isArray(r)?r:[r]).map(o=>typeof o=="string"?{type:"emoji",emoji:o}:o),n=new Set(t.filter(o=>o.type==="emoji").map(o=>o.emoji)),i=new Set(t.filter(o=>o.type==="custom_emoji").map(o=>o.custom_emoji_id)),s=t.some(o=>o.type==="paid");return o=>{if(!e(o))return!1;const{old_reaction:c,new_reaction:a}=o.messageReaction;for(const u of a){let d=!1;if(u.type==="emoji"){for(const l of c)if(l.type==="emoji"&&l.emoji===u.emoji){d=!0;break}}else if(u.type==="custom_emoji"){for(const l of c)if(l.type==="custom_emoji"&&l.custom_emoji_id===u.custom_emoji_id){d=!0;break}}else if(u.type==="paid"){for(const l of c)if(l.type==="paid"){d=!0;break}}if(!d)if(u.type==="emoji"){if(n.has(u.emoji))return!0}else if(u.type==="custom_emoji"){if(i.has(u.custom_emoji_id))return!0}else if(u.type==="paid"){if(s)return!0}else return!0}return!1}},chatType(r){const e=new Set(Rt(r));return t=>{var n;return((n=t.chat)==null?void 0:n.type)!==void 0&&e.has(t.chat.type)}},callbackQuery(r){const e=ae.filterQuery("callback_query:data"),t=Ee(r);return n=>e(n)&&Ae(n,n.callbackQuery.data,t)},gameQuery(r){const e=ae.filterQuery("callback_query:game_short_name"),t=Ee(r);return n=>e(n)&&Ae(n,n.callbackQuery.game_short_name,t)},inlineQuery(r){const e=ae.filterQuery("inline_query"),t=Ee(r);return n=>e(n)&&Ae(n,n.inlineQuery.query,t)},chosenInlineResult(r){const e=ae.filterQuery("chosen_inline_result"),t=Ee(r);return n=>e(n)&&Ae(n,n.chosenInlineResult.result_id,t)},preCheckoutQuery(r){const e=ae.filterQuery("pre_checkout_query"),t=Ee(r);return n=>e(n)&&Ae(n,n.preCheckoutQuery.invoice_payload,t)},shippingQuery(r){const e=ae.filterQuery("shipping_query"),t=Ee(r);return n=>e(n)&&Ae(n,n.shippingQuery.invoice_payload,t)}},Y=class Y{constructor(e,t,n){E(this,"update");E(this,"api");E(this,"me");E(this,"match");this.update=e,this.api=t,this.me=n}get message(){return this.update.message}get editedMessage(){return this.update.edited_message}get channelPost(){return this.update.channel_post}get editedChannelPost(){return this.update.edited_channel_post}get businessConnection(){return this.update.business_connection}get businessMessage(){return this.update.business_message}get editedBusinessMessage(){return this.update.edited_business_message}get deletedBusinessMessages(){return this.update.deleted_business_messages}get messageReaction(){return this.update.message_reaction}get messageReactionCount(){return this.update.message_reaction_count}get inlineQuery(){return this.update.inline_query}get chosenInlineResult(){return this.update.chosen_inline_result}get callbackQuery(){return this.update.callback_query}get shippingQuery(){return this.update.shipping_query}get preCheckoutQuery(){return this.update.pre_checkout_query}get poll(){return this.update.poll}get pollAnswer(){return this.update.poll_answer}get myChatMember(){return this.update.my_chat_member}get chatMember(){return this.update.chat_member}get chatJoinRequest(){return this.update.chat_join_request}get chatBoost(){return this.update.chat_boost}get removedChatBoost(){return this.update.removed_chat_boost}get purchasedPaidMedia(){return this.update.purchased_paid_media}get msg(){var e;return this.message??this.editedMessage??this.channelPost??this.editedChannelPost??this.businessMessage??this.editedBusinessMessage??((e=this.callbackQuery)==null?void 0:e.message)}get chat(){var e;return(e=this.msg??this.deletedBusinessMessages??this.messageReaction??this.messageReactionCount??this.myChatMember??this.chatMember??this.chatJoinRequest??this.chatBoost??this.removedChatBoost)==null?void 0:e.chat}get senderChat(){var e;return(e=this.msg)==null?void 0:e.sender_chat}get from(){var e,t,n,i;return((n=this.businessConnection??this.messageReaction??((t=((e=this.chatBoost)==null?void 0:e.boost)??this.removedChatBoost)==null?void 0:t.source))==null?void 0:n.user)??((i=this.callbackQuery??this.msg??this.inlineQuery??this.chosenInlineResult??this.shippingQuery??this.preCheckoutQuery??this.myChatMember??this.chatMember??this.chatJoinRequest??this.purchasedPaidMedia)==null?void 0:i.from)}get msgId(){var e,t,n;return((e=this.msg)==null?void 0:e.message_id)??((t=this.messageReaction)==null?void 0:t.message_id)??((n=this.messageReactionCount)==null?void 0:n.message_id)}get chatId(){var e,t;return((e=this.chat)==null?void 0:e.id)??((t=this.businessConnection)==null?void 0:t.user_chat_id)}get inlineMessageId(){var e,t;return((e=this.callbackQuery)==null?void 0:e.inline_message_id)??((t=this.chosenInlineResult)==null?void 0:t.inline_message_id)}get businessConnectionId(){var e,t,n;return((e=this.msg)==null?void 0:e.business_connection_id)??((t=this.businessConnection)==null?void 0:t.id)??((n=this.deletedBusinessMessages)==null?void 0:n.business_connection_id)}entities(e){const t=this.msg;if(t===void 0)return[];const n=t.text??t.caption;if(n===void 0)return[];let i=t.entities??t.caption_entities;if(i===void 0)return[];if(e!==void 0){const s=new Set(Rt(e));i=i.filter(o=>s.has(o.type))}return i.map(s=>({...s,text:n.substring(s.offset,s.offset+s.length)}))}reactions(){const e=[],t=[],n=[],i=[],s=[],o=[],c=[],a=[];let u=!1,d=!1;const l=this.messageReaction;if(l!==void 0){const{old_reaction:h,new_reaction:p}=l;for(const m of p)m.type==="emoji"?e.push(m.emoji):m.type==="custom_emoji"?s.push(m.custom_emoji_id):m.type==="paid"&&(u=d=!0);for(const m of h)m.type==="emoji"?i.push(m.emoji):m.type==="custom_emoji"?a.push(m.custom_emoji_id):m.type==="paid"&&(d=!1);t.push(...e),o.push(...s);for(let m=0;m<i.length;m++){const g=t.length;if(g===0)break;const y=i[m];for(let C=0;C<g;C++)if(y===t[C]){n.push(y),i.splice(m,1),t.splice(C,1),m--;break}}for(let m=0;m<a.length;m++){const g=o.length;if(g===0)break;const y=a[m];for(let C=0;C<g;C++)if(y===o[C]){c.push(y),a.splice(m,1),o.splice(C,1),m--;break}}}return{emoji:e,emojiAdded:t,emojiKept:n,emojiRemoved:i,customEmoji:s,customEmojiAdded:o,customEmojiKept:c,customEmojiRemoved:a,paid:u,paidAdded:d}}has(e){return Y.has.filterQuery(e)(this)}hasText(e){return Y.has.text(e)(this)}hasCommand(e){return Y.has.command(e)(this)}hasReaction(e){return Y.has.reaction(e)(this)}hasChatType(e){return Y.has.chatType(e)(this)}hasCallbackQuery(e){return Y.has.callbackQuery(e)(this)}hasGameQuery(e){return Y.has.gameQuery(e)(this)}hasInlineQuery(e){return Y.has.inlineQuery(e)(this)}hasChosenInlineResult(e){return Y.has.chosenInlineResult(e)(this)}hasPreCheckoutQuery(e){return Y.has.preCheckoutQuery(e)(this)}hasShippingQuery(e){return Y.has.shippingQuery(e)(this)}reply(e,t,n){return this.api.sendMessage(f(this.chatId,"sendMessage"),e,{business_connection_id:this.businessConnectionId,...t},n)}forwardMessage(e,t,n){return this.api.forwardMessage(e,f(this.chatId,"forwardMessage"),f(this.msgId,"forwardMessage"),t,n)}forwardMessages(e,t,n,i){return this.api.forwardMessages(e,f(this.chatId,"forwardMessages"),t,n,i)}copyMessage(e,t,n){return this.api.copyMessage(e,f(this.chatId,"copyMessage"),f(this.msgId,"copyMessage"),t,n)}copyMessages(e,t,n,i){return this.api.copyMessages(e,f(this.chatId,"copyMessages"),t,n,i)}replyWithPhoto(e,t,n){return this.api.sendPhoto(f(this.chatId,"sendPhoto"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithAudio(e,t,n){return this.api.sendAudio(f(this.chatId,"sendAudio"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithDocument(e,t,n){return this.api.sendDocument(f(this.chatId,"sendDocument"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithVideo(e,t,n){return this.api.sendVideo(f(this.chatId,"sendVideo"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithAnimation(e,t,n){return this.api.sendAnimation(f(this.chatId,"sendAnimation"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithVoice(e,t,n){return this.api.sendVoice(f(this.chatId,"sendVoice"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithVideoNote(e,t,n){return this.api.sendVideoNote(f(this.chatId,"sendVideoNote"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithMediaGroup(e,t,n){return this.api.sendMediaGroup(f(this.chatId,"sendMediaGroup"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithLocation(e,t,n,i){return this.api.sendLocation(f(this.chatId,"sendLocation"),e,t,{business_connection_id:this.businessConnectionId,...n},i)}editMessageLiveLocation(e,t,n,i){const s=this.inlineMessageId;return s!==void 0?this.api.editMessageLiveLocationInline(s,e,t,n):this.api.editMessageLiveLocation(f(this.chatId,"editMessageLiveLocation"),f(this.msgId,"editMessageLiveLocation"),e,t,n,i)}stopMessageLiveLocation(e,t){const n=this.inlineMessageId;return n!==void 0?this.api.stopMessageLiveLocationInline(n,e):this.api.stopMessageLiveLocation(f(this.chatId,"stopMessageLiveLocation"),f(this.msgId,"stopMessageLiveLocation"),e,t)}sendPaidMedia(e,t,n,i){return this.api.sendPaidMedia(f(this.chatId,"sendPaidMedia"),e,t,n,i)}replyWithVenue(e,t,n,i,s,o){return this.api.sendVenue(f(this.chatId,"sendVenue"),e,t,n,i,{business_connection_id:this.businessConnectionId,...s},o)}replyWithContact(e,t,n,i){return this.api.sendContact(f(this.chatId,"sendContact"),e,t,{business_connection_id:this.businessConnectionId,...n},i)}replyWithPoll(e,t,n,i){return this.api.sendPoll(f(this.chatId,"sendPoll"),e,t,{business_connection_id:this.businessConnectionId,...n},i)}replyWithDice(e,t,n){return this.api.sendDice(f(this.chatId,"sendDice"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithChatAction(e,t,n){return this.api.sendChatAction(f(this.chatId,"sendChatAction"),e,{business_connection_id:this.businessConnectionId,...t},n)}react(e,t,n){return this.api.setMessageReaction(f(this.chatId,"setMessageReaction"),f(this.msgId,"setMessageReaction"),typeof e=="string"?[{type:"emoji",emoji:e}]:(Array.isArray(e)?e:[e]).map(i=>typeof i=="string"?{type:"emoji",emoji:i}:i),t,n)}getUserProfilePhotos(e,t){return this.api.getUserProfilePhotos(f(this.from,"getUserProfilePhotos").id,e,t)}setUserEmojiStatus(e,t){return this.api.setUserEmojiStatus(f(this.from,"setUserEmojiStatus").id,e,t)}getUserChatBoosts(e,t){return this.api.getUserChatBoosts(e,f(this.from,"getUserChatBoosts").id,t)}getBusinessConnection(e){return this.api.getBusinessConnection(f(this.businessConnectionId,"getBusinessConnection"),e)}getFile(e){const t=f(this.msg,"getFile"),n=t.photo!==void 0?t.photo[t.photo.length-1]:t.animation??t.audio??t.document??t.video??t.video_note??t.voice??t.sticker;return this.api.getFile(f(n,"getFile").file_id,e)}kickAuthor(...e){return this.banAuthor(...e)}banAuthor(e,t){return this.api.banChatMember(f(this.chatId,"banAuthor"),f(this.from,"banAuthor").id,e,t)}kickChatMember(...e){return this.banChatMember(...e)}banChatMember(e,t,n){return this.api.banChatMember(f(this.chatId,"banChatMember"),e,t,n)}unbanChatMember(e,t,n){return this.api.unbanChatMember(f(this.chatId,"unbanChatMember"),e,t,n)}restrictAuthor(e,t,n){return this.api.restrictChatMember(f(this.chatId,"restrictAuthor"),f(this.from,"restrictAuthor").id,e,t,n)}restrictChatMember(e,t,n,i){return this.api.restrictChatMember(f(this.chatId,"restrictChatMember"),e,t,n,i)}promoteAuthor(e,t){return this.api.promoteChatMember(f(this.chatId,"promoteAuthor"),f(this.from,"promoteAuthor").id,e,t)}promoteChatMember(e,t,n){return this.api.promoteChatMember(f(this.chatId,"promoteChatMember"),e,t,n)}setChatAdministratorAuthorCustomTitle(e,t){return this.api.setChatAdministratorCustomTitle(f(this.chatId,"setChatAdministratorAuthorCustomTitle"),f(this.from,"setChatAdministratorAuthorCustomTitle").id,e,t)}setChatAdministratorCustomTitle(e,t,n){return this.api.setChatAdministratorCustomTitle(f(this.chatId,"setChatAdministratorCustomTitle"),e,t,n)}banChatSenderChat(e,t){return this.api.banChatSenderChat(f(this.chatId,"banChatSenderChat"),e,t)}unbanChatSenderChat(e,t){return this.api.unbanChatSenderChat(f(this.chatId,"unbanChatSenderChat"),e,t)}setChatPermissions(e,t,n){return this.api.setChatPermissions(f(this.chatId,"setChatPermissions"),e,t,n)}exportChatInviteLink(e){return this.api.exportChatInviteLink(f(this.chatId,"exportChatInviteLink"),e)}createChatInviteLink(e,t){return this.api.createChatInviteLink(f(this.chatId,"createChatInviteLink"),e,t)}editChatInviteLink(e,t,n){return this.api.editChatInviteLink(f(this.chatId,"editChatInviteLink"),e,t,n)}createChatSubscriptionInviteLink(e,t,n,i){return this.api.createChatSubscriptionInviteLink(f(this.chatId,"createChatSubscriptionInviteLink"),e,t,n,i)}editChatSubscriptionInviteLink(e,t,n){return this.api.editChatSubscriptionInviteLink(f(this.chatId,"editChatSubscriptionInviteLink"),e,t,n)}revokeChatInviteLink(e,t){return this.api.revokeChatInviteLink(f(this.chatId,"editChatInviteLink"),e,t)}approveChatJoinRequest(e,t){return this.api.approveChatJoinRequest(f(this.chatId,"approveChatJoinRequest"),e,t)}declineChatJoinRequest(e,t){return this.api.declineChatJoinRequest(f(this.chatId,"declineChatJoinRequest"),e,t)}setChatPhoto(e,t){return this.api.setChatPhoto(f(this.chatId,"setChatPhoto"),e,t)}deleteChatPhoto(e){return this.api.deleteChatPhoto(f(this.chatId,"deleteChatPhoto"),e)}setChatTitle(e,t){return this.api.setChatTitle(f(this.chatId,"setChatTitle"),e,t)}setChatDescription(e,t){return this.api.setChatDescription(f(this.chatId,"setChatDescription"),e,t)}pinChatMessage(e,t,n){return this.api.pinChatMessage(f(this.chatId,"pinChatMessage"),e,t,n)}unpinChatMessage(e,t){return this.api.unpinChatMessage(f(this.chatId,"unpinChatMessage"),e,t)}unpinAllChatMessages(e){return this.api.unpinAllChatMessages(f(this.chatId,"unpinAllChatMessages"),e)}leaveChat(e){return this.api.leaveChat(f(this.chatId,"leaveChat"),e)}getChat(e){return this.api.getChat(f(this.chatId,"getChat"),e)}getChatAdministrators(e){return this.api.getChatAdministrators(f(this.chatId,"getChatAdministrators"),e)}getChatMembersCount(...e){return this.getChatMemberCount(...e)}getChatMemberCount(e){return this.api.getChatMemberCount(f(this.chatId,"getChatMemberCount"),e)}getAuthor(e){return this.api.getChatMember(f(this.chatId,"getAuthor"),f(this.from,"getAuthor").id,e)}getChatMember(e,t){return this.api.getChatMember(f(this.chatId,"getChatMember"),e,t)}setChatStickerSet(e,t){return this.api.setChatStickerSet(f(this.chatId,"setChatStickerSet"),e,t)}deleteChatStickerSet(e){return this.api.deleteChatStickerSet(f(this.chatId,"deleteChatStickerSet"),e)}createForumTopic(e,t,n){return this.api.createForumTopic(f(this.chatId,"createForumTopic"),e,t,n)}editForumTopic(e,t){const n=f(this.msg,"editForumTopic"),i=f(n.message_thread_id,"editForumTopic");return this.api.editForumTopic(n.chat.id,i,e,t)}closeForumTopic(e){const t=f(this.msg,"closeForumTopic"),n=f(t.message_thread_id,"closeForumTopic");return this.api.closeForumTopic(t.chat.id,n,e)}reopenForumTopic(e){const t=f(this.msg,"reopenForumTopic"),n=f(t.message_thread_id,"reopenForumTopic");return this.api.reopenForumTopic(t.chat.id,n,e)}deleteForumTopic(e){const t=f(this.msg,"deleteForumTopic"),n=f(t.message_thread_id,"deleteForumTopic");return this.api.deleteForumTopic(t.chat.id,n,e)}unpinAllForumTopicMessages(e){const t=f(this.msg,"unpinAllForumTopicMessages"),n=f(t.message_thread_id,"unpinAllForumTopicMessages");return this.api.unpinAllForumTopicMessages(t.chat.id,n,e)}editGeneralForumTopic(e,t){return this.api.editGeneralForumTopic(f(this.chatId,"editGeneralForumTopic"),e,t)}closeGeneralForumTopic(e){return this.api.closeGeneralForumTopic(f(this.chatId,"closeGeneralForumTopic"),e)}reopenGeneralForumTopic(e){return this.api.reopenGeneralForumTopic(f(this.chatId,"reopenGeneralForumTopic"),e)}hideGeneralForumTopic(e){return this.api.hideGeneralForumTopic(f(this.chatId,"hideGeneralForumTopic"),e)}unhideGeneralForumTopic(e){return this.api.unhideGeneralForumTopic(f(this.chatId,"unhideGeneralForumTopic"),e)}unpinAllGeneralForumTopicMessages(e){return this.api.unpinAllGeneralForumTopicMessages(f(this.chatId,"unpinAllGeneralForumTopicMessages"),e)}answerCallbackQuery(e,t){return this.api.answerCallbackQuery(f(this.callbackQuery,"answerCallbackQuery").id,typeof e=="string"?{text:e}:e,t)}setChatMenuButton(e,t){return this.api.setChatMenuButton(e,t)}getChatMenuButton(e,t){return this.api.getChatMenuButton(e,t)}setMyDefaultAdministratorRights(e,t){return this.api.setMyDefaultAdministratorRights(e,t)}getMyDefaultAdministratorRights(e,t){return this.api.getMyDefaultAdministratorRights(e,t)}editMessageText(e,t,n){var s,o,c;const i=this.inlineMessageId;return i!==void 0?this.api.editMessageTextInline(i,e,t):this.api.editMessageText(f(this.chatId,"editMessageText"),f(((s=this.msg)==null?void 0:s.message_id)??((o=this.messageReaction)==null?void 0:o.message_id)??((c=this.messageReactionCount)==null?void 0:c.message_id),"editMessageText"),e,t,n)}editMessageCaption(e,t){var i,s,o;const n=this.inlineMessageId;return n!==void 0?this.api.editMessageCaptionInline(n,e):this.api.editMessageCaption(f(this.chatId,"editMessageCaption"),f(((i=this.msg)==null?void 0:i.message_id)??((s=this.messageReaction)==null?void 0:s.message_id)??((o=this.messageReactionCount)==null?void 0:o.message_id),"editMessageCaption"),e,t)}editMessageMedia(e,t,n){var s,o,c;const i=this.inlineMessageId;return i!==void 0?this.api.editMessageMediaInline(i,e,t):this.api.editMessageMedia(f(this.chatId,"editMessageMedia"),f(((s=this.msg)==null?void 0:s.message_id)??((o=this.messageReaction)==null?void 0:o.message_id)??((c=this.messageReactionCount)==null?void 0:c.message_id),"editMessageMedia"),e,t,n)}editMessageReplyMarkup(e,t){var i,s,o;const n=this.inlineMessageId;return n!==void 0?this.api.editMessageReplyMarkupInline(n,e):this.api.editMessageReplyMarkup(f(this.chatId,"editMessageReplyMarkup"),f(((i=this.msg)==null?void 0:i.message_id)??((s=this.messageReaction)==null?void 0:s.message_id)??((o=this.messageReactionCount)==null?void 0:o.message_id),"editMessageReplyMarkup"),e,t)}stopPoll(e,t){var n,i,s;return this.api.stopPoll(f(this.chatId,"stopPoll"),f(((n=this.msg)==null?void 0:n.message_id)??((i=this.messageReaction)==null?void 0:i.message_id)??((s=this.messageReactionCount)==null?void 0:s.message_id),"stopPoll"),e,t)}deleteMessage(e){var t,n,i;return this.api.deleteMessage(f(this.chatId,"deleteMessage"),f(((t=this.msg)==null?void 0:t.message_id)??((n=this.messageReaction)==null?void 0:n.message_id)??((i=this.messageReactionCount)==null?void 0:i.message_id),"deleteMessage"),e)}deleteMessages(e,t){return this.api.deleteMessages(f(this.chatId,"deleteMessages"),e,t)}replyWithSticker(e,t,n){return this.api.sendSticker(f(this.chatId,"sendSticker"),e,{business_connection_id:this.businessConnectionId,...t},n)}getCustomEmojiStickers(e){var t;return this.api.getCustomEmojiStickers((((t=this.msg)==null?void 0:t.entities)??[]).filter(n=>n.type==="custom_emoji").map(n=>n.custom_emoji_id),e)}replyWithGift(e,t,n){return this.api.sendGift(f(this.from,"sendGift").id,e,t,n)}answerInlineQuery(e,t,n){return this.api.answerInlineQuery(f(this.inlineQuery,"answerInlineQuery").id,e,t,n)}savePreparedInlineMessage(e,t,n){return this.api.savePreparedInlineMessage(f(this.from,"savePreparedInlineMessage").id,e,t,n)}replyWithInvoice(e,t,n,i,s,o,c){return this.api.sendInvoice(f(this.chatId,"sendInvoice"),e,t,n,i,s,o,c)}answerShippingQuery(e,t,n){return this.api.answerShippingQuery(f(this.shippingQuery,"answerShippingQuery").id,e,t,n)}answerPreCheckoutQuery(e,t,n){return this.api.answerPreCheckoutQuery(f(this.preCheckoutQuery,"answerPreCheckoutQuery").id,e,typeof t=="string"?{error_message:t}:t,n)}refundStarPayment(e){var t;return this.api.refundStarPayment(f(this.from,"refundStarPayment").id,f((t=this.msg)==null?void 0:t.successful_payment,"refundStarPayment").telegram_payment_charge_id,e)}editUserStarSubscription(e,t,n){return this.api.editUserStarSubscription(f(this.from,"editUserStarSubscription").id,e,t,n)}verifyUser(e,t){return this.api.verifyUser(f(this.from,"verifyUser").id,e,t)}verifyChat(e,t){return this.api.verifyChat(f(this.chatId,"verifyChat"),e,t)}removeUserVerification(e){return this.api.removeUserVerification(f(this.from,"removeUserVerification").id,e)}removeChatVerification(e){return this.api.removeChatVerification(f(this.chatId,"removeChatVerification"),e)}setPassportDataErrors(e,t){return this.api.setPassportDataErrors(f(this.from,"setPassportDataErrors").id,e,t)}replyWithGame(e,t,n){return this.api.sendGame(f(this.chatId,"sendGame"),e,{business_connection_id:this.businessConnectionId,...t},n)}};E(Y,"has",ae);let z=Y;function f(r,e){if(r===void 0)throw new Error(`Missing information for API call to ${e}`);return r}function Ee(r){return Rt(r).map(e=>typeof e=="string"?t=>t===e?e:null:t=>t.match(e))}function Ae(r,e,t){for(const n of t){const i=n(e);if(i)return r.match=i,!0}return!1}function Rt(r){return Array.isArray(r)?r:[r]}class tr extends Error{constructor(t,n){super(Ws(t));E(this,"error");E(this,"ctx");this.error=t,this.ctx=n,this.name="BotError",t instanceof Error&&(this.stack=t.stack)}}function Ws(r){let e;if(r instanceof Error)e=`${r.name} in middleware: ${r.message}`;else{const t=typeof r;switch(e=`Non-error value of type ${t} thrown in middleware`,t){case"bigint":case"boolean":case"number":case"symbol":e+=`: ${r}`;break;case"string":e+=`: ${String(r).substring(0,50)}`;break;default:e+="!";break}}return e}function nt(r){return typeof r=="function"?r:(e,t)=>r.middleware()(e,t)}function Kr(r,e){return async(t,n)=>{let i=!1;await r(t,async()=>{if(i)throw new Error("`next` already called before!");i=!0,await e(t,n)})}}function qt(r,e){return e()}const Vs=()=>Promise.resolve();async function qn(r,e){await r(e,Vs)}class Fe{constructor(...e){E(this,"handler");this.handler=e.length===0?qt:e.map(nt).reduce(Kr)}middleware(){return this.handler}use(...e){const t=new Fe(...e);return this.handler=Kr(this.handler,nt(t)),t}on(e,...t){return this.filter(z.has.filterQuery(e),...t)}hears(e,...t){return this.filter(z.has.text(e),...t)}command(e,...t){return this.filter(z.has.command(e),...t)}reaction(e,...t){return this.filter(z.has.reaction(e),...t)}chatType(e,...t){return this.filter(z.has.chatType(e),...t)}callbackQuery(e,...t){return this.filter(z.has.callbackQuery(e),...t)}gameQuery(e,...t){return this.filter(z.has.gameQuery(e),...t)}inlineQuery(e,...t){return this.filter(z.has.inlineQuery(e),...t)}chosenInlineResult(e,...t){return this.filter(z.has.chosenInlineResult(e),...t)}preCheckoutQuery(e,...t){return this.filter(z.has.preCheckoutQuery(e),...t)}shippingQuery(e,...t){return this.filter(z.has.shippingQuery(e),...t)}filter(e,...t){const n=new Fe(...t);return this.branch(e,n,qt),n}drop(e,...t){return this.filter(async n=>!await e(n),...t)}fork(...e){const t=new Fe(...e),n=nt(t);return this.use((i,s)=>Promise.all([s(),qn(n,i)])),t}lazy(e){return this.use(async(t,n)=>{const i=await e(t),s=Array.isArray(i)?i:[i];await nt(new Fe(...s))(t,n)})}route(e,t,n=qt){return this.lazy(async i=>{const s=await e(i);return(s===void 0||!t[s]?n:t[s])??[]})}branch(e,t,n){return this.lazy(async i=>await e(i)?t:n)}errorBoundary(e,...t){const n=new Fe(...t),i=nt(n);return this.use(async(s,o)=>{let c=!1;const a=()=>(c=!0,Promise.resolve());try{await i(s,a)}catch(u){c=!1,await e(new tr(u,s),a)}c&&await o()}),n}}var ze=1e3,Ke=ze*60,He=Ke*60,Ne=He*24,Ys=Ne*7,zs=Ne*365.25,Ks=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return Hs(r);if(t==="number"&&isFinite(r))return e.long?Zs(r):Js(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function Hs(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*zs;case"weeks":case"week":case"w":return t*Ys;case"days":case"day":case"d":return t*Ne;case"hours":case"hour":case"hrs":case"hr":case"h":return t*He;case"minutes":case"minute":case"mins":case"min":case"m":return t*Ke;case"seconds":case"second":case"secs":case"sec":case"s":return t*ze;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Js(r){var e=Math.abs(r);return e>=Ne?Math.round(r/Ne)+"d":e>=He?Math.round(r/He)+"h":e>=Ke?Math.round(r/Ke)+"m":e>=ze?Math.round(r/ze)+"s":r+"ms"}function Zs(r){var e=Math.abs(r);return e>=Ne?Ct(r,e,Ne,"day"):e>=He?Ct(r,e,He,"hour"):e>=Ke?Ct(r,e,Ke,"minute"):e>=ze?Ct(r,e,ze,"second"):r+" ms"}function Ct(r,e,t,n){var i=e>=t*1.5;return Math.round(r/t)+" "+n+(i?"s":"")}function Wn(){throw new Error("setTimeout has not been defined")}function Vn(){throw new Error("clearTimeout has not been defined")}var _e=Wn,ve=Vn,We;typeof window<"u"?We=window:typeof self<"u"?We=self:We={};typeof We.setTimeout=="function"&&(_e=setTimeout);typeof We.clearTimeout=="function"&&(ve=clearTimeout);function Yn(r){if(_e===setTimeout)return setTimeout(r,0);if((_e===Wn||!_e)&&setTimeout)return _e=setTimeout,setTimeout(r,0);try{return _e(r,0)}catch{try{return _e.call(null,r,0)}catch{return _e.call(this,r,0)}}}function Xs(r){if(ve===clearTimeout)return clearTimeout(r);if((ve===Vn||!ve)&&clearTimeout)return ve=clearTimeout,clearTimeout(r);try{return ve(r)}catch{try{return ve.call(null,r)}catch{return ve.call(this,r)}}}var me=[],Ve=!1,Re,It=-1;function eo(){!Ve||!Re||(Ve=!1,Re.length?me=Re.concat(me):It=-1,me.length&&zn())}function zn(){if(!Ve){var r=Yn(eo);Ve=!0;for(var e=me.length;e;){for(Re=me,me=[];++It<e;)Re&&Re[It].run();It=-1,e=me.length}Re=null,Ve=!1,Xs(r)}}function to(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];me.push(new Kn(r,e)),me.length===1&&!Ve&&Yn(zn)}function Kn(r,e){this.fun=r,this.array=e}Kn.prototype.run=function(){this.fun.apply(null,this.array)};var ro="browser",no="browser",io=!0,so=[],oo="",ao={},uo={},lo={};function Ue(){}var co=Ue,ho=Ue,fo=Ue,po=Ue,mo=Ue,go=Ue,_o=Ue;function vo(r){throw new Error("process.binding is not supported")}function yo(){return"/"}function wo(r){throw new Error("process.chdir is not supported")}function bo(){return 0}var Be=We.performance||{},Co=Be.now||Be.mozNow||Be.msNow||Be.oNow||Be.webkitNow||function(){return new Date().getTime()};function Mo(r){var e=Co.call(Be)*.001,t=Math.floor(e),n=Math.floor(e%1*1e9);return r&&(t=t-r[0],n=n-r[1],n<0&&(t--,n+=1e9)),[t,n]}var ko=new Date;function So(){var r=new Date,e=r-ko;return e/1e3}var Wt={nextTick:to,title:ro,browser:io,env:{NODE_ENV:"production"},argv:so,version:oo,versions:ao,on:co,addListener:ho,once:fo,off:po,removeListener:mo,removeAllListeners:go,emit:_o,binding:vo,cwd:yo,chdir:wo,umask:bo,hrtime:Mo,platform:no,release:uo,config:lo,uptime:So};function Io(r,e,t){return t={path:e,exports:{},require:function(n,i){return To(n,i??t.path)}},r(t,t.exports),t.exports}function To(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}function Eo(r){t.debug=t,t.default=t,t.coerce=a,t.disable=s,t.enable=i,t.enabled=o,t.humanize=Ks,t.destroy=u,Object.keys(r).forEach(d=>{t[d]=r[d]}),t.names=[],t.skips=[],t.formatters={};function e(d){let l=0;for(let h=0;h<d.length;h++)l=(l<<5)-l+d.charCodeAt(h),l|=0;return t.colors[Math.abs(l)%t.colors.length]}t.selectColor=e;function t(d){let l,h=null,p,m;function g(...y){if(!g.enabled)return;const C=g,b=Number(new Date),w=b-(l||b);C.diff=w,C.prev=l,C.curr=b,l=b,y[0]=t.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let T=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(k,U)=>{if(k==="%%")return"%";T++;const x=t.formatters[U];if(typeof x=="function"){const $=y[T];k=x.call(C,$),y.splice(T,1),T--}return k}),t.formatArgs.call(C,y),(C.log||t.log).apply(C,y)}return g.namespace=d,g.useColors=t.useColors(),g.color=t.selectColor(d),g.extend=n,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(p!==t.namespaces&&(p=t.namespaces,m=t.enabled(d)),m),set:y=>{h=y}}),typeof t.init=="function"&&t.init(g),g}function n(d,l){const h=t(this.namespace+(typeof l>"u"?":":l)+d);return h.log=this.log,h}function i(d){t.save(d),t.namespaces=d,t.names=[],t.skips=[];let l;const h=(typeof d=="string"?d:"").split(/[\s,]+/),p=h.length;for(l=0;l<p;l++)h[l]&&(d=h[l].replace(/\*/g,".*?"),d[0]==="-"?t.skips.push(new RegExp("^"+d.slice(1)+"$")):t.names.push(new RegExp("^"+d+"$")))}function s(){const d=[...t.names.map(c),...t.skips.map(c).map(l=>"-"+l)].join(",");return t.enable(""),d}function o(d){if(d[d.length-1]==="*")return!0;let l,h;for(l=0,h=t.skips.length;l<h;l++)if(t.skips[l].test(d))return!1;for(l=0,h=t.names.length;l<h;l++)if(t.names[l].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function a(d){return d instanceof Error?d.stack||d.message:d}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var Ao=Eo,W=Io(function(r,e){e.formatArgs=n,e.save=i,e.load=s,e.useColors=t,e.storage=o(),e.destroy=(()=>{let a=!1;return()=>{a||(a=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(a){if(a[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+a[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;a.splice(1,0,u,"color: inherit");let d=0,l=0;a[0].replace(/%[a-zA-Z%]/g,h=>{h!=="%%"&&(d++,h==="%c"&&(l=d))}),a.splice(l,0,u)}e.log=console.debug||console.log||(()=>{});function i(a){try{a?e.storage.setItem("debug",a):e.storage.removeItem("debug")}catch{}}function s(){let a;try{a=e.storage.getItem("debug")}catch{}return!a&&typeof Wt<"u"&&"env"in Wt&&(a=Wt.env.DEBUG),a}function o(){try{return localStorage}catch{}}r.exports=Ao(e);const{formatters:c}=r.exports;c.j=function(a){try{return JSON.stringify(a)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}});W.colors;W.destroy;W.formatArgs;W.load;W.log;W.save;W.storage;W.useColors;const xo=r=>{const e=r[Symbol.asyncIterator]();return new ReadableStream({async pull(t){const n=await e.next();n.done?t.close():t.enqueue(n.value)}})},Fo=r=>({}),Hr=W("grammy:warn");class Ir extends Error{constructor(t,n,i,s){super(`${t} (${n.error_code}: ${n.description})`);E(this,"method");E(this,"payload");E(this,"ok");E(this,"error_code");E(this,"description");E(this,"parameters");this.method=i,this.payload=s,this.ok=!1,this.name="GrammyError",this.error_code=n.error_code,this.description=n.description,this.parameters=n.parameters??{}}}function Po(r,e,t){switch(r.error_code){case 401:Hr("Error 401 means that your bot token is wrong, talk to https://t.me/BotFather to check it.");break;case 409:Hr("Error 409 means that you are running your bot several times on long polling. Consider revoking the bot token if you believe that no other instance is running.");break}return new Ir(`Call to '${e}' failed!`,r,e,t)}class Hn extends Error{constructor(t,n){super(t);E(this,"error");this.error=n,this.name="HttpError"}}function Ro(r){return typeof r=="object"&&r!==null&&"status"in r&&"statusText"in r}function Lo(r,e){return t=>{let n=`Network request for '${r}' failed!`;throw Ro(t)&&(n+=` (${t.status}: ${t.statusText})`),e&&t instanceof Error&&(n+=` ${t.message}`),new Hn(n,t)}}const No=(()=>{var t,n,i;const{Deno:r}=globalThis;if(typeof((t=r==null?void 0:r.build)==null?void 0:t.os)=="string")return r.build.os;const{navigator:e}=globalThis;return(i=(n=e==null?void 0:e.appVersion)==null?void 0:n.includes)!=null&&i.call(n,"Win")?"windows":"linux"})(),jo=No==="windows";function Uo(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function Jn(r,e){if(e.length>=r.length)return r;const t=r.length-e.length;for(let n=e.length-1;n>=0;--n)if(r.charCodeAt(t+n)!==e.charCodeAt(n))return r;return r.slice(0,-e.length)}function Zn(r,e,t=0){let n=!1,i=r.length;for(let s=r.length-1;s>=t;--s)if(e(r.charCodeAt(s))){if(n){t=s+1;break}}else n||(n=!0,i=s+1);return r.slice(t,i)}function Xn(r,e){if(Uo(r),r.length===0)return r;if(typeof e!="string")throw new TypeError(`Suffix must be a string. Received ${JSON.stringify(e)}`)}function ei(r,e){if(r.length<=1)return r;let t=r.length;for(let n=r.length-1;n>0&&e(r.charCodeAt(n));n--)t=n;return r.slice(0,t)}function Jr(r){return r===47}function $o(r,e=""){Xn(r,e);const t=Zn(r,Jr),n=ei(t,Jr);return e?Jn(n,e):n}function Zr(r){return r===47||r===92}function Do(r){return r>=97&&r<=122||r>=65&&r<=90}function Oo(r,e=""){Xn(r,e);let t=0;if(r.length>=2){const s=r.charCodeAt(0);Do(s)&&r.charCodeAt(1)===58&&(t=2)}const n=Zn(r,Zr,t),i=ei(n,Zr);return e?Jn(i,e):i}function Mt(r,e=""){return jo?Oo(r,e):$o(r,e)}class rr{constructor(e,t){E(this,"consumed",!1);E(this,"fileData");E(this,"filename");this.fileData=e,t??(t=this.guessFilename(e)),this.filename=t}guessFilename(e){if(typeof e=="string")return Mt(e);if(typeof e=="object"){if("url"in e)return Mt(e.url);if(e instanceof URL)return Mt(e.pathname)||Mt(e.hostname)}}toRaw(){if(this.consumed)throw new Error("Cannot reuse InputFile data source!");const e=this.fileData;return e instanceof Blob?e.stream():e instanceof URL?Xr(e):"url"in e?Xr(e.url):(e instanceof Uint8Array||(this.consumed=!0),e)}}async function*Xr(r){const{body:e}=await fetch(r);if(e===null)throw new Error(`Download failed, no response body from '${r}'`);yield*e}function nr(r){return r instanceof rr||typeof r=="object"&&r!==null&&Object.values(r).some(e=>Array.isArray(e)?e.some(nr):e instanceof rr||nr(e))}function ti(r){return JSON.stringify(r,(e,t)=>t??void 0)}function en(r){return{method:"POST",headers:{"content-type":"application/json",connection:"keep-alive"},body:ti(r)}}async function*Bo(r,e){try{yield*r}catch(t){e(t)}}function Qo(r,e){const t=Go(),n=qo(r,t),i=Bo(n,e),s=xo(i);return{method:"POST",headers:{"content-type":`multipart/form-data; boundary=${t}`,connection:"keep-alive"},body:s}}function Go(){return"----------"+ri(32)}function ri(r=16){return Array.from(Array(r)).map(()=>Math.random().toString(36)[2]||0).join("")}const ot=new TextEncoder;async function*qo(r,e){const t=ir(r);yield ot.encode(`--${e}\r
`);const n=ot.encode(`\r
--${e}\r
`);let i=!0;for(const[s,o]of Object.entries(r))o!=null&&(i||(yield n),yield Wo(s,typeof o=="object"?ti(o):o),i=!1);for(const{id:s,origin:o,file:c}of t)i||(yield n),yield*Vo(s,o,c),i=!1;yield ot.encode(`\r
--${e}--\r
`)}function ir(r){return typeof r!="object"||r===null?[]:Object.entries(r).flatMap(([e,t])=>{if(Array.isArray(t))return t.flatMap(n=>ir(n));if(t instanceof rr){const n=ri();Object.assign(r,{[e]:`attach://${n}`});const i=e==="media"&&"type"in r&&typeof r.type=="string"?r.type:e;return{id:n,origin:i,file:t}}else return ir(t)})}function Wo(r,e){return ot.encode(`content-disposition:form-data;name="${r}"\r
\r
${e}`)}async function*Vo(r,e,t){const n=t.filename||`${e}.${Yo(e)}`;if(n.includes("\r")||n.includes(`
`))throw new Error(`File paths cannot contain carriage-return (\\r) or newline (\\n) characters! Filename for property '${e}' was:
"""
${n}
"""`);yield ot.encode(`content-disposition:form-data;name="${r}";filename=${n}\r
content-type:application/octet-stream\r
\r
`);const i=await t.toRaw();i instanceof Uint8Array?yield i:yield*i}function Yo(r){switch(r){case"certificate":return"pem";case"photo":case"thumbnail":return"jpg";case"voice":return"ogg";case"audio":return"mp3";case"animation":case"video":case"video_note":return"mp4";case"sticker":return"webp";default:return"dat"}}const zo=W("grammy:core");function Ko(r,e){return(t,n,i)=>e(r,t,n,i)}class Ho{constructor(e,t={},n={}){E(this,"token");E(this,"webhookReplyEnvelope");E(this,"options");E(this,"fetch");E(this,"hasUsedWebhookReply");E(this,"installedTransformers");E(this,"call");this.token=e,this.webhookReplyEnvelope=n,this.hasUsedWebhookReply=!1,this.installedTransformers=[],this.call=async(a,u,d)=>{const l=u??{};zo(`Calling ${a}`),d!==void 0&&na(a,l,d);const h=this.options,p=nr(l);if(this.webhookReplyEnvelope.send!==void 0&&!this.hasUsedWebhookReply&&!p&&h.canUseWebhookReply(a)){this.hasUsedWebhookReply=!0;const U=en({...l,method:a});return await this.webhookReplyEnvelope.send(U.body),{ok:!0,result:!0}}const m=ra(d),g=ea(m,h.timeoutSeconds,a),y=ta(m),C=h.buildUrl(h.apiRoot,this.token,a,h.environment),b=p?Qo(l,U=>y.catch(U)):en(l),w=m.signal,T={...h.baseFetchConfig,signal:w,...b},k=[this.fetch(C instanceof URL?C.href:C,T).catch(Lo(a,h.sensitiveLogs)),y.promise,g.promise];try{return await(await Promise.race(k)).json()}finally{g.handle!==void 0&&clearTimeout(g.handle)}};const i=t.apiRoot??"https://api.telegram.org",s=t.environment??"prod",{fetch:o}=t,c=o??fetch;if(this.options={apiRoot:i,environment:s,buildUrl:t.buildUrl??Zo,timeoutSeconds:t.timeoutSeconds??500,baseFetchConfig:{...Fo(),...t.baseFetchConfig},canUseWebhookReply:t.canUseWebhookReply??(()=>!1),sensitiveLogs:t.sensitiveLogs??!1,fetch:(...a)=>c(...a)},this.fetch=this.options.fetch,this.options.apiRoot.endsWith("/"))throw new Error(`Remove the trailing '/' from the 'apiRoot' option (use '${this.options.apiRoot.substring(0,this.options.apiRoot.length-1)}' instead of '${this.options.apiRoot}')`)}use(...e){return this.call=e.reduce(Ko,this.call),this.installedTransformers.push(...e),this}async callApi(e,t,n){const i=await this.call(e,t,n);if(i.ok)return i.result;throw Po(i,e,t)}}function Jo(r,e,t){const n=new Ho(r,e,t),i={get(a,u){return u==="toJSON"?"__internal":u==="getMe"||u==="getWebhookInfo"||u==="getForumTopicIconStickers"||u==="logOut"||u==="close"?n.callApi.bind(n,u,{}):n.callApi.bind(n,u)},...Xo},s=new Proxy({},i),o=n.installedTransformers,c={raw:s,installedTransformers:o,use:(...a)=>(n.use(...a),c)};return c}const Zo=(r,e,t,n)=>`${r}/bot${e}/${n==="test"?"test/":""}${t}`,Xo={set(){return!1},defineProperty(){return!1},deleteProperty(){return!1},ownKeys(){return[]}};function ea(r,e,t){let n;return{promise:new Promise((s,o)=>{n=setTimeout(()=>{const c=`Request to '${t}' timed out after ${e} seconds`;o(new Error(c)),r.abort()},1e3*e)}),handle:n}}function ta(r){let e=n=>{throw n};return{promise:new Promise((n,i)=>{e=s=>{i(s),r.abort()}}),catch:e}}function ra(r){const e=new AbortController;if(r===void 0)return e;const t=r;function n(){e.abort(),t.removeEventListener("abort",n)}return t.aborted?n():t.addEventListener("abort",n),{abort:n,signal:e.signal}}function na(r,e,t){if(typeof(t==null?void 0:t.addEventListener)=="function")return;let n=JSON.stringify(e);n.length>20&&(n=n.substring(0,16)+" ...");let i=JSON.stringify(t);throw i.length>20&&(i=i.substring(0,16)+" ..."),new Error(`Incorrect abort signal instance found! You passed two payloads to '${r}' but you should merge the second one containing '${i}' into the first one containing '${n}'! If you are using context shortcuts, you may want to use a method on 'ctx.api' instead.

If you want to prevent such mistakes in the future, consider using TypeScript. https://www.typescriptlang.org/`)}class tn{constructor(e,t,n){E(this,"token");E(this,"options");E(this,"raw");E(this,"config");this.token=e,this.options=t;const{raw:i,use:s,installedTransformers:o}=Jo(e,t,n);this.raw=i,this.config={use:s,installedTransformers:()=>o.slice()}}getUpdates(e,t){return this.raw.getUpdates({...e},t)}setWebhook(e,t,n){return this.raw.setWebhook({url:e,...t},n)}deleteWebhook(e,t){return this.raw.deleteWebhook({...e},t)}getWebhookInfo(e){return this.raw.getWebhookInfo(e)}getMe(e){return this.raw.getMe(e)}logOut(e){return this.raw.logOut(e)}close(e){return this.raw.close(e)}sendMessage(e,t,n,i){return this.raw.sendMessage({chat_id:e,text:t,...n},i)}forwardMessage(e,t,n,i,s){return this.raw.forwardMessage({chat_id:e,from_chat_id:t,message_id:n,...i},s)}forwardMessages(e,t,n,i,s){return this.raw.forwardMessages({chat_id:e,from_chat_id:t,message_ids:n,...i},s)}copyMessage(e,t,n,i,s){return this.raw.copyMessage({chat_id:e,from_chat_id:t,message_id:n,...i},s)}copyMessages(e,t,n,i,s){return this.raw.copyMessages({chat_id:e,from_chat_id:t,message_ids:n,...i},s)}sendPhoto(e,t,n,i){return this.raw.sendPhoto({chat_id:e,photo:t,...n},i)}sendAudio(e,t,n,i){return this.raw.sendAudio({chat_id:e,audio:t,...n},i)}sendDocument(e,t,n,i){return this.raw.sendDocument({chat_id:e,document:t,...n},i)}sendVideo(e,t,n,i){return this.raw.sendVideo({chat_id:e,video:t,...n},i)}sendAnimation(e,t,n,i){return this.raw.sendAnimation({chat_id:e,animation:t,...n},i)}sendVoice(e,t,n,i){return this.raw.sendVoice({chat_id:e,voice:t,...n},i)}sendVideoNote(e,t,n,i){return this.raw.sendVideoNote({chat_id:e,video_note:t,...n},i)}sendMediaGroup(e,t,n,i){return this.raw.sendMediaGroup({chat_id:e,media:t,...n},i)}sendLocation(e,t,n,i,s){return this.raw.sendLocation({chat_id:e,latitude:t,longitude:n,...i},s)}editMessageLiveLocation(e,t,n,i,s,o){return this.raw.editMessageLiveLocation({chat_id:e,message_id:t,latitude:n,longitude:i,...s},o)}editMessageLiveLocationInline(e,t,n,i,s){return this.raw.editMessageLiveLocation({inline_message_id:e,latitude:t,longitude:n,...i},s)}stopMessageLiveLocation(e,t,n,i){return this.raw.stopMessageLiveLocation({chat_id:e,message_id:t,...n},i)}stopMessageLiveLocationInline(e,t,n){return this.raw.stopMessageLiveLocation({inline_message_id:e,...t},n)}sendPaidMedia(e,t,n,i,s){return this.raw.sendPaidMedia({chat_id:e,star_count:t,media:n,...i},s)}sendVenue(e,t,n,i,s,o,c){return this.raw.sendVenue({chat_id:e,latitude:t,longitude:n,title:i,address:s,...o},c)}sendContact(e,t,n,i,s){return this.raw.sendContact({chat_id:e,phone_number:t,first_name:n,...i},s)}sendPoll(e,t,n,i,s){return this.raw.sendPoll({chat_id:e,question:t,options:n,...i},s)}sendDice(e,t,n,i){return this.raw.sendDice({chat_id:e,emoji:t,...n},i)}setMessageReaction(e,t,n,i,s){return this.raw.setMessageReaction({chat_id:e,message_id:t,reaction:n,...i},s)}sendChatAction(e,t,n,i){return this.raw.sendChatAction({chat_id:e,action:t,...n},i)}getUserProfilePhotos(e,t,n){return this.raw.getUserProfilePhotos({user_id:e,...t},n)}setUserEmojiStatus(e,t,n){return this.raw.setUserEmojiStatus({user_id:e,...t},n)}getUserChatBoosts(e,t,n){return this.raw.getUserChatBoosts({chat_id:e,user_id:t},n)}getBusinessConnection(e,t){return this.raw.getBusinessConnection({business_connection_id:e},t)}getFile(e,t){return this.raw.getFile({file_id:e},t)}kickChatMember(...e){return this.banChatMember(...e)}banChatMember(e,t,n,i){return this.raw.banChatMember({chat_id:e,user_id:t,...n},i)}unbanChatMember(e,t,n,i){return this.raw.unbanChatMember({chat_id:e,user_id:t,...n},i)}restrictChatMember(e,t,n,i,s){return this.raw.restrictChatMember({chat_id:e,user_id:t,permissions:n,...i},s)}promoteChatMember(e,t,n,i){return this.raw.promoteChatMember({chat_id:e,user_id:t,...n},i)}setChatAdministratorCustomTitle(e,t,n,i){return this.raw.setChatAdministratorCustomTitle({chat_id:e,user_id:t,custom_title:n},i)}banChatSenderChat(e,t,n){return this.raw.banChatSenderChat({chat_id:e,sender_chat_id:t},n)}unbanChatSenderChat(e,t,n){return this.raw.unbanChatSenderChat({chat_id:e,sender_chat_id:t},n)}setChatPermissions(e,t,n,i){return this.raw.setChatPermissions({chat_id:e,permissions:t,...n},i)}exportChatInviteLink(e,t){return this.raw.exportChatInviteLink({chat_id:e},t)}createChatInviteLink(e,t,n){return this.raw.createChatInviteLink({chat_id:e,...t},n)}editChatInviteLink(e,t,n,i){return this.raw.editChatInviteLink({chat_id:e,invite_link:t,...n},i)}createChatSubscriptionInviteLink(e,t,n,i,s){return this.raw.createChatSubscriptionInviteLink({chat_id:e,subscription_period:t,subscription_price:n,...i},s)}editChatSubscriptionInviteLink(e,t,n,i){return this.raw.editChatSubscriptionInviteLink({chat_id:e,invite_link:t,...n},i)}revokeChatInviteLink(e,t,n){return this.raw.revokeChatInviteLink({chat_id:e,invite_link:t},n)}approveChatJoinRequest(e,t,n){return this.raw.approveChatJoinRequest({chat_id:e,user_id:t},n)}declineChatJoinRequest(e,t,n){return this.raw.declineChatJoinRequest({chat_id:e,user_id:t},n)}setChatPhoto(e,t,n){return this.raw.setChatPhoto({chat_id:e,photo:t},n)}deleteChatPhoto(e,t){return this.raw.deleteChatPhoto({chat_id:e},t)}setChatTitle(e,t,n){return this.raw.setChatTitle({chat_id:e,title:t},n)}setChatDescription(e,t,n){return this.raw.setChatDescription({chat_id:e,description:t},n)}pinChatMessage(e,t,n,i){return this.raw.pinChatMessage({chat_id:e,message_id:t,...n},i)}unpinChatMessage(e,t,n){return this.raw.unpinChatMessage({chat_id:e,message_id:t},n)}unpinAllChatMessages(e,t){return this.raw.unpinAllChatMessages({chat_id:e},t)}leaveChat(e,t){return this.raw.leaveChat({chat_id:e},t)}getChat(e,t){return this.raw.getChat({chat_id:e},t)}getChatAdministrators(e,t){return this.raw.getChatAdministrators({chat_id:e},t)}getChatMembersCount(...e){return this.getChatMemberCount(...e)}getChatMemberCount(e,t){return this.raw.getChatMemberCount({chat_id:e},t)}getChatMember(e,t,n){return this.raw.getChatMember({chat_id:e,user_id:t},n)}setChatStickerSet(e,t,n){return this.raw.setChatStickerSet({chat_id:e,sticker_set_name:t},n)}deleteChatStickerSet(e,t){return this.raw.deleteChatStickerSet({chat_id:e},t)}getForumTopicIconStickers(e){return this.raw.getForumTopicIconStickers(e)}createForumTopic(e,t,n,i){return this.raw.createForumTopic({chat_id:e,name:t,...n},i)}editForumTopic(e,t,n,i){return this.raw.editForumTopic({chat_id:e,message_thread_id:t,...n},i)}closeForumTopic(e,t,n){return this.raw.closeForumTopic({chat_id:e,message_thread_id:t},n)}reopenForumTopic(e,t,n){return this.raw.reopenForumTopic({chat_id:e,message_thread_id:t},n)}deleteForumTopic(e,t,n){return this.raw.deleteForumTopic({chat_id:e,message_thread_id:t},n)}unpinAllForumTopicMessages(e,t,n){return this.raw.unpinAllForumTopicMessages({chat_id:e,message_thread_id:t},n)}editGeneralForumTopic(e,t,n){return this.raw.editGeneralForumTopic({chat_id:e,name:t},n)}closeGeneralForumTopic(e,t){return this.raw.closeGeneralForumTopic({chat_id:e},t)}reopenGeneralForumTopic(e,t){return this.raw.reopenGeneralForumTopic({chat_id:e},t)}hideGeneralForumTopic(e,t){return this.raw.hideGeneralForumTopic({chat_id:e},t)}unhideGeneralForumTopic(e,t){return this.raw.unhideGeneralForumTopic({chat_id:e},t)}unpinAllGeneralForumTopicMessages(e,t){return this.raw.unpinAllGeneralForumTopicMessages({chat_id:e},t)}answerCallbackQuery(e,t,n){return this.raw.answerCallbackQuery({callback_query_id:e,...t},n)}setMyName(e,t,n){return this.raw.setMyName({name:e,...t},n)}getMyName(e,t){return this.raw.getMyName(e??{},t)}setMyCommands(e,t,n){return this.raw.setMyCommands({commands:e,...t},n)}deleteMyCommands(e,t){return this.raw.deleteMyCommands({...e},t)}getMyCommands(e,t){return this.raw.getMyCommands({...e},t)}setMyDescription(e,t,n){return this.raw.setMyDescription({description:e,...t},n)}getMyDescription(e,t){return this.raw.getMyDescription({...e},t)}setMyShortDescription(e,t,n){return this.raw.setMyShortDescription({short_description:e,...t},n)}getMyShortDescription(e,t){return this.raw.getMyShortDescription({...e},t)}setChatMenuButton(e,t){return this.raw.setChatMenuButton({...e},t)}getChatMenuButton(e,t){return this.raw.getChatMenuButton({...e},t)}setMyDefaultAdministratorRights(e,t){return this.raw.setMyDefaultAdministratorRights({...e},t)}getMyDefaultAdministratorRights(e,t){return this.raw.getMyDefaultAdministratorRights({...e},t)}editMessageText(e,t,n,i,s){return this.raw.editMessageText({chat_id:e,message_id:t,text:n,...i},s)}editMessageTextInline(e,t,n,i){return this.raw.editMessageText({inline_message_id:e,text:t,...n},i)}editMessageCaption(e,t,n,i){return this.raw.editMessageCaption({chat_id:e,message_id:t,...n},i)}editMessageCaptionInline(e,t,n){return this.raw.editMessageCaption({inline_message_id:e,...t},n)}editMessageMedia(e,t,n,i,s){return this.raw.editMessageMedia({chat_id:e,message_id:t,media:n,...i},s)}editMessageMediaInline(e,t,n,i){return this.raw.editMessageMedia({inline_message_id:e,media:t,...n},i)}editMessageReplyMarkup(e,t,n,i){return this.raw.editMessageReplyMarkup({chat_id:e,message_id:t,...n},i)}editMessageReplyMarkupInline(e,t,n){return this.raw.editMessageReplyMarkup({inline_message_id:e,...t},n)}stopPoll(e,t,n,i){return this.raw.stopPoll({chat_id:e,message_id:t,...n},i)}deleteMessage(e,t,n){return this.raw.deleteMessage({chat_id:e,message_id:t},n)}deleteMessages(e,t,n){return this.raw.deleteMessages({chat_id:e,message_ids:t},n)}sendSticker(e,t,n,i){return this.raw.sendSticker({chat_id:e,sticker:t,...n},i)}getStickerSet(e,t){return this.raw.getStickerSet({name:e},t)}getCustomEmojiStickers(e,t){return this.raw.getCustomEmojiStickers({custom_emoji_ids:e},t)}uploadStickerFile(e,t,n,i){return this.raw.uploadStickerFile({user_id:e,sticker_format:t,sticker:n},i)}createNewStickerSet(e,t,n,i,s,o){return this.raw.createNewStickerSet({user_id:e,name:t,title:n,stickers:i,...s},o)}addStickerToSet(e,t,n,i){return this.raw.addStickerToSet({user_id:e,name:t,sticker:n},i)}setStickerPositionInSet(e,t,n){return this.raw.setStickerPositionInSet({sticker:e,position:t},n)}deleteStickerFromSet(e,t){return this.raw.deleteStickerFromSet({sticker:e},t)}replaceStickerInSet(e,t,n,i,s){return this.raw.replaceStickerInSet({user_id:e,name:t,old_sticker:n,sticker:i},s)}setStickerEmojiList(e,t,n){return this.raw.setStickerEmojiList({sticker:e,emoji_list:t},n)}setStickerKeywords(e,t,n){return this.raw.setStickerKeywords({sticker:e,keywords:t},n)}setStickerMaskPosition(e,t,n){return this.raw.setStickerMaskPosition({sticker:e,mask_position:t},n)}setStickerSetTitle(e,t,n){return this.raw.setStickerSetTitle({name:e,title:t},n)}deleteStickerSet(e,t){return this.raw.deleteStickerSet({name:e},t)}setStickerSetThumbnail(e,t,n,i,s){return this.raw.setStickerSetThumbnail({name:e,user_id:t,thumbnail:n,format:i},s)}setCustomEmojiStickerSetThumbnail(e,t,n){return this.raw.setCustomEmojiStickerSetThumbnail({name:e,custom_emoji_id:t},n)}getAvailableGifts(e){return this.raw.getAvailableGifts(e)}sendGift(e,t,n,i){return this.raw.sendGift({user_id:e,gift_id:t,...n},i)}answerInlineQuery(e,t,n,i){return this.raw.answerInlineQuery({inline_query_id:e,results:t,...n},i)}answerWebAppQuery(e,t,n){return this.raw.answerWebAppQuery({web_app_query_id:e,result:t},n)}savePreparedInlineMessage(e,t,n,i){return this.raw.savePreparedInlineMessage({user_id:e,result:t,...n},i)}sendInvoice(e,t,n,i,s,o,c,a){return this.raw.sendInvoice({chat_id:e,title:t,description:n,payload:i,currency:s,prices:o,...c},a)}createInvoiceLink(e,t,n,i,s,o,c,a){return this.raw.createInvoiceLink({title:e,description:t,payload:n,provider_token:i,currency:s,prices:o,...c},a)}answerShippingQuery(e,t,n,i){return this.raw.answerShippingQuery({shipping_query_id:e,ok:t,...n},i)}answerPreCheckoutQuery(e,t,n,i){return this.raw.answerPreCheckoutQuery({pre_checkout_query_id:e,ok:t,...n},i)}getStarTransactions(e,t){return this.raw.getStarTransactions({...e},t)}refundStarPayment(e,t,n){return this.raw.refundStarPayment({user_id:e,telegram_payment_charge_id:t},n)}editUserStarSubscription(e,t,n,i){return this.raw.editUserStarSubscription({user_id:e,telegram_payment_charge_id:t,is_canceled:n},i)}verifyUser(e,t,n){return this.raw.verifyUser({user_id:e,...t},n)}verifyChat(e,t,n){return this.raw.verifyChat({chat_id:e,...t},n)}removeUserVerification(e,t){return this.raw.removeUserVerification({user_id:e},t)}removeChatVerification(e,t){return this.raw.removeChatVerification({chat_id:e},t)}setPassportDataErrors(e,t,n){return this.raw.setPassportDataErrors({user_id:e,errors:t},n)}sendGame(e,t,n,i){return this.raw.sendGame({chat_id:e,game_short_name:t,...n},i)}setGameScore(e,t,n,i,s,o){return this.raw.setGameScore({chat_id:e,message_id:t,user_id:n,score:i,...s},o)}setGameScoreInline(e,t,n,i,s){return this.raw.setGameScore({inline_message_id:e,user_id:t,score:n,...i},s)}getGameHighScores(e,t,n,i){return this.raw.getGameHighScores({chat_id:e,message_id:t,user_id:n},i)}getGameHighScoresInline(e,t,n){return this.raw.getGameHighScores({inline_message_id:e,user_id:t},n)}}const oe=W("grammy:bot"),ia=W("grammy:warn"),Qe=W("grammy:error"),ni=["message","edited_message","channel_post","edited_channel_post","business_connection","business_message","edited_business_message","deleted_business_messages","inline_query","chosen_inline_result","callback_query","shipping_query","pre_checkout_query","poll","poll_answer","my_chat_member","chat_join_request","chat_boost","removed_chat_boost"];class sa extends Fe{constructor(t,n){super();E(this,"token");E(this,"pollingRunning");E(this,"pollingAbortController");E(this,"lastTriedUpdateId");E(this,"api");E(this,"me");E(this,"mePromise");E(this,"clientConfig");E(this,"ContextConstructor");E(this,"observedUpdateTypes");E(this,"errorHandler");if(this.token=t,this.pollingRunning=!1,this.lastTriedUpdateId=0,this.observedUpdateTypes=new Set,this.errorHandler=async i=>{var s,o;throw console.error("Error in middleware while handling update",(o=(s=i.ctx)==null?void 0:s.update)==null?void 0:o.update_id,i.error),console.error("No error handler was set!"),console.error("Set your own error handler with `bot.catch = ...`"),this.pollingRunning&&(console.error("Stopping bot"),await this.stop()),i},!t)throw new Error("Empty token!");this.me=n==null?void 0:n.botInfo,this.clientConfig=n==null?void 0:n.client,this.ContextConstructor=(n==null?void 0:n.ContextConstructor)??z,this.api=new tn(t,this.clientConfig)}set botInfo(t){this.me=t}get botInfo(){if(this.me===void 0)throw new Error("Bot information unavailable! Make sure to call `await bot.init()` before accessing `bot.botInfo`!");return this.me}on(t,...n){for(const[i]of Bn(t).flatMap(Qn))this.observedUpdateTypes.add(i);return super.on(t,...n)}reaction(t,...n){return this.observedUpdateTypes.add("message_reaction"),super.reaction(t,...n)}isInited(){return this.me!==void 0}async init(t){if(!this.isInited()){oe("Initializing bot"),this.mePromise??(this.mePromise=rn(()=>this.api.getMe(t),t));let n;try{n=await this.mePromise}finally{this.mePromise=void 0}this.me===void 0?this.me=n:oe("Bot info was set by now, will not overwrite")}oe(`I am ${this.me.username}!`)}async handleUpdates(t){for(const n of t){this.lastTriedUpdateId=n.update_id;try{await this.handleUpdate(n)}catch(i){if(i instanceof tr)await this.errorHandler(i);else throw console.error("FATAL: grammY unable to handle:",i),i}}}async handleUpdate(t,n){if(this.me===void 0)throw new Error("Bot not initialized! Either call `await bot.init()`, or directly set the `botInfo` option in the `Bot` constructor to specify a known bot info object.");oe(`Processing update ${t.update_id}`);const i=new tn(this.token,this.clientConfig,n),s=this.api.config.installedTransformers();s.length>0&&i.config.use(...s);const o=new this.ContextConstructor(t,i,this.me);try{await qn(this.middleware(),o)}catch(c){throw Qe(`Error in middleware for update ${t.update_id}`),new tr(c,o)}}async start(t){var i,s,o;const n=[];if(this.isInited()||n.push(this.init((i=this.pollingAbortController)==null?void 0:i.signal)),this.pollingRunning){await Promise.all(n),oe("Simple long polling already running!");return}this.pollingRunning=!0,this.pollingAbortController=new AbortController;try{n.push(rn(async()=>{var c;await this.api.deleteWebhook({drop_pending_updates:t==null?void 0:t.drop_pending_updates},(c=this.pollingAbortController)==null?void 0:c.signal)},(s=this.pollingAbortController)==null?void 0:s.signal)),await Promise.all(n),await((o=t==null?void 0:t.onStart)==null?void 0:o.call(t,this.botInfo))}catch(c){throw this.pollingRunning=!1,this.pollingAbortController=void 0,c}this.pollingRunning&&(oa(this.observedUpdateTypes,t==null?void 0:t.allowed_updates),this.use=aa,oe("Starting simple long polling"),await this.loop(t),oe("Middleware is done running"))}async stop(){var t;if(this.pollingRunning){oe("Stopping bot, saving update offset"),this.pollingRunning=!1,(t=this.pollingAbortController)==null||t.abort();const n=this.lastTriedUpdateId+1;await this.api.getUpdates({offset:n,limit:1}).finally(()=>this.pollingAbortController=void 0)}else oe("Bot is not running!")}isRunning(){return this.pollingRunning}catch(t){this.errorHandler=t}async loop(t){const n=t==null?void 0:t.limit,i=(t==null?void 0:t.timeout)??30;let s=(t==null?void 0:t.allowed_updates)??[];try{for(;this.pollingRunning;){const o=await this.fetchUpdates({limit:n,timeout:i,allowed_updates:s});if(o===void 0)break;await this.handleUpdates(o),s=void 0}}finally{this.pollingRunning=!1}}async fetchUpdates({limit:t,timeout:n,allowed_updates:i}){var c;const s=this.lastTriedUpdateId+1;let o;do try{o=await this.api.getUpdates({offset:s,limit:t,timeout:n,allowed_updates:i},(c=this.pollingAbortController)==null?void 0:c.signal)}catch(a){await this.handlePollingError(a)}while(o===void 0&&this.pollingRunning);return o}async handlePollingError(t){if(!this.pollingRunning){oe("Pending getUpdates request cancelled");return}let n=3;if(t instanceof Ir){if(Qe(t.message),t.error_code===401||t.error_code===409)throw t;t.error_code===429&&(Qe("Bot API server is closing."),n=t.parameters.retry_after??n)}else Qe(t);Qe(`Call to getUpdates failed, retrying in ${n} seconds ...`),await sr(n)}}async function rn(r,e){let n=50;async function i(o){let c=!1,a="rethrow";if(o instanceof Hn)c=!0,a="retry";else if(o instanceof Ir){if(o.error_code>=500)c=!0,a="retry";else if(o.error_code===429){const u=o.parameters.retry_after;typeof u=="number"?(await sr(u,e),n=50):c=!0,a="retry"}}if(c){n!==50&&await sr(n,e);const u=20*60*1e3;n=Math.min(u,2*n)}return a}let s={ok:!1};for(;!s.ok;)try{s={ok:!0,value:await r()}}catch(o){switch(Qe(o),await i(o)){case"retry":continue;case"rethrow":throw o}}return s.value}async function sr(r,e){let t,n;function i(){n==null||n(new Error("Aborted delay")),t!==void 0&&clearTimeout(t)}try{await new Promise((s,o)=>{if(n=o,e!=null&&e.aborted){i();return}e==null||e.addEventListener("abort",i),t=setTimeout(s,1e3*r)})}finally{e==null||e.removeEventListener("abort",i)}}function oa(r,e=ni){const t=Array.from(r).filter(n=>!e.includes(n));t.length>0&&ia(`You registered listeners for the following update types, but you did not specify them in \`allowed_updates\` so they may not be received: ${t.map(n=>`'${n}'`).join(", ")}`)}function aa(){throw new Error(`It looks like you are registering more listeners on your bot from within other listeners! This means that every time your bot handles a message like this one, new listeners will be added. This list grows until your machine crashes, so grammY throws this error to tell you that you should probably do things a bit differently. If you're unsure how to resolve this problem, you can ask in the group chat: https://telegram.me/grammyjs

On the other hand, if you actually know what you're doing and you do need to install further middleware while your bot is running, consider installing a composer instance on your bot, and in turn augment the composer after the fact. This way, you can circumvent this protection against memory leaks.`)}[...ni];W("grammy:session");W("grammy:error");function ua(r){var s,o;const e=(r||"").trim();if(!e)return"?";const t=e.split(/\s+/).filter(Boolean),n=((s=t[0])==null?void 0:s[0])||"",i=((o=t[1])==null?void 0:o[0])||"";return(n+i).toUpperCase()||n.toUpperCase()||"?"}function la(r){return(r||"").replace(/\s+/g," ").slice(0,60)}function ca(r){return r.from?[r.from.first_name,r.from.last_name].filter(Boolean).join(" ")||r.from.username||"Ngi dng":r.author_signature?r.author_signature:"H thng"}function da(){let r=localStorage.getItem("token")||"",e=$state(r),t=$state(localStorage.getItem("proxyBase")||""),n=$state(new Map),i=$state(null),s=$state(null),o=$state(new Map),c=$state([]),a=$state(null),u=$state(!1),d=$state(window.innerWidth>768),l=$state(!1),h=null;const p=v=>{e=v,localStorage.setItem("token",v),n.clear(),i=null,o.clear(),y(),v&&C()},m=()=>{const v=prompt("Enter your bot token:");if(!v)throw new Error("Bot token is required");return p(v),v},g=()=>{if(!e)return;const v={proxyBase:t,chats:Array.from(n.entries()).map(([_,S])=>[_,{...S,messageIds:[...S.messageIds]}]),currentChatId:i,cachedFileUrls:Array.from(o.entries())};localStorage.setItem(`telegram_${e}`,JSON.stringify(v))},y=()=>{if(!e)return;const v=localStorage.getItem(`telegram_${e}`);if(v)try{const _=JSON.parse(v);if(t=_.proxyBase||"",_.chats){const S=new Map;for(const[L,ee]of _.chats){const J=ee;S.set(L,{...J,messageIds:new Set(J.messageIds)})}n=S}i=_.currentChatId||null,_.cachedFileUrls&&(o=new Map(_.cachedFileUrls))}catch(_){console.error("Error loading state:",_)}},C=async()=>{if(e)try{h=new sa(e),t&&h.api.config.use(async(v,_,S,L)=>{const ee=`https://api.telegram.org/bot${e}/${_}`,J=t.replace(/\/+$/,"")+"/"+ee;return(await fetch(J,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S||{}),signal:L})).json()}),a=await h.api.getMe(),document.title=`${a==null?void 0:a.first_name} - Bottelegram`||"Bottelegram",h.command("start",v=>v.reply(`Welcome! This bot is powered by 
https://bottelegram.web.app

Channel: @contentdownload

Group: @contentdownload_group`)),h.on("message",async v=>{const _=v.message;_!=null&&_.chat&&await b(_.chat.id.toString(),_,!0)}),await h.start(),u=!0}catch(v){console.error("Error initializing bot:",v),u=!1}},b=async(v,_,S)=>{var Tr;if(!n.has(v)){const N=_.chat,De=N.type==="private"?[_.chat.first_name,_.chat.last_name].filter(Boolean).join(" ")||_.chat.username||"Ngi dng":_.chat.title||N.type||"Chat";n.set(v,{id:v,type:N.type,title:De,avatarText:ua(De),messages:[],messageIds:new Set,lastText:"",lastDate:0,unread:0})}const L=n.get(v),ee=ca(_),J={id:_.message_id,chatId:v,side:S?"left":"right",date:(_.date||Math.floor(Date.now()/1e3))*1e3,fromName:ee,reply_to:(Tr=_.reply_to_message)==null?void 0:Tr.message_id,reply_preview:_.reply_to_message?la(_.reply_to_message.text||_.reply_to_message.caption||""):void 0};let D;if(_.text)D={...J,type:"text",text:_.text};else if(_.photo){const N=_.photo[_.photo.length-1],$e=await w(N.file_id);D={...J,type:"photo",mediaUrl:$e,caption:_.caption||""}}else if(_.video){const N=await w(_.video.file_id);D={...J,type:"video",mediaUrl:N,caption:_.caption||""}}else if(_.audio){const N=await w(_.audio.file_id);D={...J,type:"audio",mediaUrl:N,caption:_.caption||""}}else if(_.voice){const N=await w(_.voice.file_id);D={...J,type:"voice",mediaUrl:N,caption:_.caption||""}}else if(_.document){const N=await w(_.document.file_id);D={...J,type:"document",mediaUrl:N,caption:_.caption||"",fileName:_.document.file_name||"Tp"}}else if(_.sticker){const N=_.sticker;let $e="tgs",De="";N.is_video?($e="webm",De=await w(N.file_id)):N.is_animated||($e="webp",De=await w(N.file_id)),D={...J,type:"sticker",mediaUrl:De,stickerFormat:$e,emoji:N.emoji||""}}else D={...J,type:"text",text:"[Khng hin th loi ni dung ny]"};if(!L.messageIds.has(D.id)){L.messageIds.add(D.id),L.messages.push(D);let N="";D.type==="text"?N=D.text:"caption"in D&&D.caption?N=D.caption:"text"in D?N=D.text:N=`[${D.type}]`,L.lastText=N,L.lastDate=D.date,S&&v!==i&&(L.unread++,k(L.title,L.lastText)),g()}},w=async v=>{if(o.has(v))return o.get(v);if(!h)throw new Error("Bot not initialized");try{const _=await h.api.getFile(v),L=`https://api.telegram.org/file/bot${e}/${_.file_path}`;if(t){const ee=t.replace(/\/+$/,"")+"/"+L;o.set(v,ee)}else o.set(v,L);return g(),o.get(v)}catch(_){throw console.error("Error getting file URL:",_),_}},T=v=>{i=v;const _=n.get(v);_&&(_.unread=0,g())},M=v=>{const _=n.get(v);_&&(_.unread=0,g())},k=(v,_)=>{const S={id:Date.now().toString(),title:v,body:_,timestamp:Date.now()};c.push(S)},U=async(v,_,S)=>{if(!h)throw new Error("Bot not initialized");try{const L={chat_id:v,text:_};S&&(L.reply_to_message_id=S);const ee=await h.api.sendMessage(v,_,{reply_to_message_id:S});await b(v,ee,!1)}catch(L){throw console.error("Error sending message:",L),L}},x=async(v,_)=>{if(!h)throw new Error("Bot not initialized");await h.api.sendChatAction(v,_)},$=async(v,_)=>{if(!h)throw new Error("Bot not initialized");try{await h.api.deleteMessage(v,_);const S=n.get(v);S&&(S.messages=S.messages.filter(L=>L.id!==_),S.messageIds.delete(_),g())}catch(S){throw console.error("Error deleting message:",S),S}},ie=async v=>{if(!h)throw new Error("Bot not initialized");return h.api.getChat(v)},Ie=async v=>{if(!h)throw new Error("Bot not initialized");return h.api.getChatAdministrators(v)},se=()=>{s=null},Te=(v,_)=>{s=v};return y(),{token:e,proxyBase:t,chats:n,currentChatId:i,replyTo:s,cachedFileUrls:o,toastQueue:c,botInfo:a,isConnected:u,showSidebar:d,showSettings:l,...{initializeBot:C,selectChat:T,markRead:M,saveState:g,loadState:y,enqueueToast:k,sendText:U,sendChatAction:x,deleteMessage:$,getChat:ie,getChatAdministrators:Ie,getFileUrl:w,clearReplyContext:se,setReplyContext:Te,setToken:p,getTokenPrompt:m}}}const j=da(),ha=(r,e)=>{Notification.permission==="granted"?new Notification(r,{body:e}):Notification.permission!=="denied"&&Notification.requestPermission().then(t=>{t==="granted"&&new Notification(r,{body:e})})};Ti();/**
 * @license lucide-svelte v0.473.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 */const fa={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var pa=hs("<svg><!><!></svg>");function ii(r,e){const t=Pt(e,["children","$$slots","$$events","$$legacy"]),n=Pt(t,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);ke(e,!1);let i=xe(e,"name",8,void 0),s=xe(e,"color",8,"currentColor"),o=xe(e,"size",8,24),c=xe(e,"strokeWidth",8,2),a=xe(e,"absoluteStrokeWidth",8,!1),u=xe(e,"iconNode",24,()=>[]);const d=(...g)=>g.filter((y,C,b)=>!!y&&b.indexOf(y)===C).join(" ");Es();var l=pa();let h;var p=A(l);kr(p,1,u,Mr,(g,y)=>{let C=()=>I(y)[0],b=()=>I(y)[1];var w=Cr(),T=pr(w);bs(T,C,!0,(M,k)=>{let U;le(()=>U=jr(M,U,{...b()},void 0,M.namespaceURI===dn,M.nodeName.includes("-")))}),Q(g,w)});var m=P(p);Sr(m,e,"default",{}),le(()=>h=jr(l,h,{...fa,...n,width:o(),height:o(),stroke:s(),"stroke-width":a()?Number(c())*24/Number(o()):c(),class:d("lucide-icon","lucide",i()?`lucide-${i()}`:"",t.class)},void 0,!0)),Q(r,l),Se()}function ma(r,e){const t=Pt(e,["children","$$slots","$$events","$$legacy"]);ii(r,On({name:"menu"},()=>t,{iconNode:[["line",{x1:"4",x2:"20",y1:"12",y2:"12"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18"}]],children:(i,s)=>{var o=Cr(),c=pr(o);Sr(c,e,"default",{}),Q(i,o)},$$slots:{default:!0}}))}function ga(r,e){const t=Pt(e,["children","$$slots","$$events","$$legacy"]);ii(r,On({name:"settings-2"},()=>t,{iconNode:[["path",{d:"M20 7h-9"}],["path",{d:"M14 17H5"}],["circle",{cx:"17",cy:"17",r:"3"}],["circle",{cx:"7",cy:"7",r:"3"}]],children:(i,s)=>{var o=Cr(),c=pr(o);Sr(c,e,"default",{}),Q(i,o)},$$slots:{default:!0}}))}var _a=te('<div class="flex justify-between items-center p-4 bg-white border-b"><div class="flex items-center gap-2"><button class="md:hidden p-2 hover:bg-gray-100 rounded-lg" aria-label="Toggle sidebar"><!></button> <h1 class="text-lg font-medium"> </h1></div> <div class="flex items-center gap-4"><a href="https://t.me/contentdownload_group" target="_blank" rel="noopener noreferrer" class="text-blue-500 hover:text-blue-600" title="Join Telegram Group"><img src="https://web.telegram.org/favicon.ico" class="h-6 w-6" alt="Telegram"></a> <button class="p-2 hover:bg-gray-100 rounded-lg" title="Settings"><!></button></div></div>');function va(r,e){ke(e,!0);var t=_a(),n=A(t),i=A(n);i.__click=function(...l){var h;(h=e.toggleSidebar)==null||h.apply(this,l)};var s=A(i);ma(s,{class:"h-6 w-6"});var o=P(i,2),c=A(o),a=P(n,2),u=P(A(a),2);u.__click=function(...l){var h;(h=e.toggleSettings)==null||h.apply(this,l)};var d=A(u);ga(d,{class:"h-6 w-6"}),le(()=>{var l;return re(c,(l=e.botInfo)==null?void 0:l.first_name)}),Q(r,t),Se()}tt(["click"]);const ya=(r,e)=>{localStorage.setItem("token",I(e)),window.location.reload()};var wa=te('<div class="bg-gray-50 p-4 rounded-lg mb-4"><h2 class="text-lg font-semibold mb-2">Bot Information</h2> <p><strong>ID:</strong> </p> <p><strong>Name:</strong> </p> <p><strong>Username:</strong> </p> <p><strong>Can Join Groups:</strong> </p> <p><strong>Can Read Group Messages:</strong> </p></div>'),ba=te('<div class="p-4 bg-white border-b"><div class="mb-4"><!></div> <div class="flex gap-2"><input class="flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-green-500" type="text" placeholder="Enter new bot token..."> <button class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors">Update Token</button> <button class="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors">Clear Data</button></div></div>');function Ca(r,e){ke(e,!0);let t=fr(B(e.token));var n=ba(),i=A(n),s=A(i);{var o=l=>{var h=wa(),p=P(A(h),2),m=P(A(p)),g=P(p,2),y=P(A(g)),C=P(g,2),b=P(A(C)),w=P(C,2),T=P(A(w)),M=P(w,2),k=P(A(M));le(()=>{re(m,` ${e.botInfo.id??""}`),re(y,` ${e.botInfo.first_name??""}`),re(b,` @${e.botInfo.username??""}`),re(T,` ${(e.botInfo.can_join_groups?"Yes":"No")??""}`),re(k,` ${(e.botInfo.can_read_all_group_messages?"Yes":"No")??""}`)}),Q(l,h)};ht(s,l=>{e.botInfo&&l(o)})}var c=P(i,2),a=A(c),u=P(a,2);u.__click=[ya,t];var d=P(u,2);d.__click=function(...l){var h;(h=e.clearData)==null||h.apply(this,l)},Dn(a,()=>I(t),l=>G(t,l)),Q(r,n),Se()}tt(["click"]);var Ma=(r,e,t)=>{e.selectChat(I(t).id),window.innerWidth<768&&e.toggleSidebar()},ka=te('<span class="bg-green-500 text-white text-xs px-2 py-1 rounded-full"> </span>'),Sa=te('<div><div class="flex justify-between items-center"><span class="font-medium truncate"> </span> <!></div></div>'),Ia=te("<div></div>");function Ta(r,e){ke(e,!0);var t=Ia();kr(t,21,()=>e.chats,Mr,(n,i)=>{var s=Sa();s.__click=[Ma,e,i];var o=A(s),c=A(o),a=A(c),u=P(c,2);{var d=l=>{var h=ka(),p=A(h);le(()=>re(p,I(i).unread)),Q(l,h)};ht(u,l=>{I(i).unread&&l(d)})}le(()=>{Ge(s,`p-3 cursor-pointer hover:bg-gray-100 ${(e.currentChat===I(i).id?"bg-gray-200":"")??""} ${(I(i).hasNotification?"bg-yellow-50":"")??""}`),re(a,I(i).name)}),Q(n,s)}),le(()=>Ge(t,`${(e.showSidebar?"block":"hidden")??""} md:block w-64 bg-gray-50 border-r overflow-y-auto absolute md:relative z-10`)),Q(r,t),Se()}tt(["click"]);var Ea=te('<div class="mb-1 p-2 bg-gray-50 border-l-2 border-gray-300 rounded text-sm text-gray-600"><div class="font-medium">Replying to:</div> <div class="truncate"> </div></div>'),Aa=te('<div style="max-width: 70%"><div><span> </span> <span class="text-gray-500 text-sm ml-2"> </span></div> <!> <div><!></div></div>'),xa=te('<button class="fixed bottom-24 right-8 bg-gray-800 text-white p-2 rounded-full shadow-lg hover:bg-gray-700" aria-label="Scroll to bottom"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg></button>'),Fa=te('<div class="flex-1 overflow-y-auto p-4 bg-gray-100 relative"><!> <!></div>');function Pa(r,e){ke(e,!0);let t;at(()=>{t&&e.setContainer(t)});function n(a){switch(a.type){case"text":return a.text;case"photo":return`<img src="${a.mediaUrl}" alt="Photo" class="max-w-full rounded-lg shadow-sm" />${a.caption?`<p class="mt-2 text-sm">${a.caption}</p>`:""}`;case"video":return`<video src="${a.mediaUrl}" controls class="max-w-full rounded-lg shadow-sm" />${a.caption?`<p class="mt-2 text-sm">${a.caption}</p>`:""}`;case"audio":return`<audio src="${a.mediaUrl}" controls class="w-full" />${a.caption?`<p class="mt-2 text-sm">${a.caption}</p>`:""}`;case"voice":return`<audio src="${a.mediaUrl}" controls class="w-full" />${a.caption?`<p class="mt-2 text-sm">${a.caption}</p>`:""}`;case"document":return`<a href="${a.mediaUrl}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 p-2 bg-gray-50 rounded hover:bg-gray-100"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>${a.fileName||"Document"}</a>${a.caption?`<p class="mt-2 text-sm">${a.caption}</p>`:""}`;case"sticker":return a.stickerFormat==="webp"?`<img src="${a.mediaUrl}" alt="${a.emoji||"Sticker"}" class="max-w-32 h-auto" />`:a.stickerFormat==="webm"?`<video src="${a.mediaUrl}" autoplay loop muted playsinline class="max-w-32 h-auto" />`:`<span class="text-2xl">${a.emoji||""}</span>`;default:return"[Unsupported message type]"}}var i=Fa(),s=A(i);kr(s,17,()=>e.messages,Mr,(a,u)=>{var d=Aa(),l=A(d),h=A(l),p=A(h),m=P(h,2),g=A(m);le(()=>re(g,new Date(I(u).date).toLocaleString()));var y=P(l,2);{var C=T=>{var M=Ea(),k=P(A(M),2),U=A(k);le(()=>re(U,I(u).reply_preview)),Q(T,M)};ht(y,T=>{I(u).reply_preview&&T(C)})}var b=P(y,2),w=A(b);ws(w,()=>n(I(u))),le(()=>{Ge(d,`mb-4 ${(I(u).side==="right"?"ml-auto":"")??""}`),Ge(l,`flex items-center mb-1 ${(I(u).side==="right"?"justify-end":"")??""}`),Ge(h,`font-bold ${(I(u).side==="right"?"text-blue-600":"text-green-600")??""}`),re(p,I(u).fromName),Ge(b,`p-3 rounded-lg shadow-sm break-words overflow-wrap-anywhere ${(I(u).side==="right"?"bg-blue-100":"bg-white")??""}`)}),Q(a,d)});var o=P(s,2);{var c=a=>{var u=xa();u.__click=function(...d){var l;(l=e.scrollToBottom)==null||l.apply(this,d)},Q(a,u)};ht(o,a=>{e.showScrollButton&&a(c)})}Ts(i,a=>t=a,()=>t),jn("scroll",i,function(...a){var u;(u=e.handleScroll)==null||u.apply(this,a)}),Q(r,i),Se()}tt(["click"]);var Ra=(r,e,t)=>{e.sendMessage(I(t)),G(t,"")},La=te('<div class="p-4 bg-white border-t"><div class="flex gap-2"><input class="flex-1 border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-green-500" type="text" placeholder="Type a message..."> <button class="bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"></path></svg> Send</button></div></div>');function Na(r,e){ke(e,!0);let t=fr("");const n=a=>{a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),e.sendMessage(I(t)),G(t,""))};var i=La(),s=A(i),o=A(s),c=P(o,2);c.__click=[Ra,e,t],jn("keypress",o,n),Dn(o,()=>I(t),a=>G(t,a)),Q(r,i),Se()}tt(["click"]);var ja=te('<div class="flex flex-col h-screen max-h-screen max-w-screen overflow-hidden"><!> <!> <div class="flex flex-1 overflow-hidden"><!> <div class="flex-1 flex flex-col min-h-0 max-w-full md:max-w-[calc(100vw-16rem)]"><!> <!></div></div></div>');function Ua(r,e){ke(e,!0);const t=j.initializeBot,n=j.selectChat,i=j.sendText,s=j.clearReplyContext,o=j.getTokenPrompt;let c=B(j.token);B(j.proxyBase);let a=B(j.chats),u=B(j.currentChatId),d=B(j.replyTo),l=B(j.toastQueue),h=B(j.botInfo);B(j.isConnected),B(j.showSidebar),B(j.showSettings);let p=fr(null);at(()=>{if(c)t();else try{o()}catch(S){console.error("Failed to get token:",S)}}),at(()=>{l.forEach(S=>{ha(S.title,S.body)}),l.length=0});const m=we(()=>u?a.get(u):void 0),g=we(()=>{var S;return((S=I(m))==null?void 0:S.messages)||[]}),y=we(()=>Array.from(a.values()).map(S=>({id:S.id,name:S.title,unread:S.unread,hasNotification:S.unread>0}))),C=S=>{!S.trim()||!u||(i(u,S,d||void 0),s(),T())},b=()=>{c&&(localStorage.removeItem(`telegram_${c}`),j.chats.clear(),j.currentChatId=null)},w=()=>{I(p)&&I(p)},T=()=>{I(p)&&(I(p).scrollTop=I(p).scrollHeight)},M=()=>{j.showSidebar=!j.showSidebar},k=()=>{j.showSettings=!j.showSettings};var U=ja(),x=A(U);va(x,{get botInfo(){return h},toggleSettings:k,toggleSidebar:M});var $=P(x,2);{var ie=S=>{Ca(S,{get botInfo(){return h},get token(){return c},clearData:b})};ht($,S=>{j.showSettings&&S(ie)})}var Ie=P($,2),se=A(Ie),Te=we(()=>u||"");Ta(se,{get chats(){return I(y)},get currentChat(){return I(Te)},selectChat:n,get showSidebar(){return j.showSidebar},toggleSidebar:()=>j.showSidebar=!j.showSidebar});var yt=P(se,2),v=A(yt);Pa(v,{get messages(){return I(g)},setContainer:S=>{G(p,B(S))},showScrollButton:!1,scrollToBottom:T,handleScroll:w});var _=P(v,2);Na(_,{sendMessage:C}),Q(r,U),Se()}fs(Ua,{target:document.getElementById("app")});
