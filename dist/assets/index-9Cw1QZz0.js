var Li=Object.defineProperty;var Ni=(r,e,t)=>e in r?Li(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var P=(r,e,t)=>Ni(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const Jr=!1;var Tr=Array.isArray,ji=Array.prototype.indexOf,Ir=Array.from,Di=Object.defineProperty,We=Object.getOwnPropertyDescriptor,In=Object.getOwnPropertyDescriptors,Ui=Object.prototype,Oi=Array.prototype,Er=Object.getPrototypeOf;function St(r){return typeof r=="function"}function Bi(r){return r()}function hr(r){for(var e=0;e<r.length;e++)r[e]()}const fe=2,En=4,$t=8,Ar=16,Ee=32,wt=64,Vt=128,it=256,zt=512,ne=1024,Ne=2048,yt=4096,Me=8192,bt=16384,Qi=32768,Lt=65536,qi=1<<17,Gi=1<<19,An=1<<20,Ve=Symbol("$state"),Fn=Symbol("legacy props"),Wi=Symbol("");function Pn(r){return r===this.v}function Vi(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function Fr(r){return!Vi(r,this.v)}function zi(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Hi(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Yi(r){throw new Error("https://svelte.dev/e/effect_orphan")}function Ki(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ji(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function Zi(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Xi(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function es(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function ts(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Ct=!1,rs=!1;function ns(){Ct=!0}const Pr=1,Rr=2,Rn=4,is=8,ss=16,as=1,os=2,$n=4,ls=8,us=16,cs=2,ae=Symbol(),Ln="http://www.w3.org/2000/svg";function ue(r,e){var t={f:0,v:r,reactions:null,equals:Pn,rv:0,wv:0};return t}function Et(r){return ds(ue(r))}function Nn(r,e=!1){var n;const t=ue(r);return e||(t.equals=Fr),Ct&&W!==null&&W.l!==null&&((n=W.l).s??(n.s=[])).push(t),t}function ds(r){return U!==null&&U.f&fe&&(Se===null?bs([r]):Se.push(r)),r}function J(r,e){return U!==null&&Nt()&&U.f&(fe|Ar)&&(Se===null||!Se.includes(r))&&ts(),fr(r,e)}function fr(r,e){return r.equals(e)||(r.v,r.v=e,r.wv=ei(),jn(r,Ne),Nt()&&D!==null&&D.f&ne&&!(D.f&(Ee|wt))&&(Re===null?Cs([r]):Re.push(r))),e}function jn(r,e){var t=r.reactions;if(t!==null)for(var n=Nt(),i=t.length,s=0;s<i;s++){var a=t[s],c=a.f;c&Ne||!n&&a===D||(ye(a,e),c&(ne|it)&&(c&fe?jn(a,yt):nr(a)))}}let Dn=!1;function X(r,e=null,t){if(typeof r!="object"||r===null||Ve in r)return r;const n=Er(r);if(n!==Ui&&n!==Oi)return r;var i=new Map,s=Tr(r),a=ue(0);s&&i.set("length",ue(r.length));var c;return new Proxy(r,{defineProperty(u,d,o){(!("value"in o)||o.configurable===!1||o.enumerable===!1||o.writable===!1)&&Zi();var l=i.get(d);return l===void 0?(l=ue(o.value),i.set(d,l)):J(l,X(o.value,c)),!0},deleteProperty(u,d){var o=i.get(d);if(o===void 0)d in u&&i.set(d,ue(ae));else{if(s&&typeof d=="string"){var l=i.get("length"),h=Number(d);Number.isInteger(h)&&h<l.v&&J(l,h)}J(o,ae),Zr(a)}return!0},get(u,d,o){var m;if(d===Ve)return r;var l=i.get(d),h=d in u;if(l===void 0&&(!h||(m=We(u,d))!=null&&m.writable)&&(l=ue(X(h?u[d]:ae,c)),i.set(d,l)),l!==void 0){var f=_(l);return f===ae?void 0:f}return Reflect.get(u,d,o)},getOwnPropertyDescriptor(u,d){var o=Reflect.getOwnPropertyDescriptor(u,d);if(o&&"value"in o){var l=i.get(d);l&&(o.value=_(l))}else if(o===void 0){var h=i.get(d),f=h==null?void 0:h.v;if(h!==void 0&&f!==ae)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return o},has(u,d){var f;if(d===Ve)return!0;var o=i.get(d),l=o!==void 0&&o.v!==ae||Reflect.has(u,d);if(o!==void 0||D!==null&&(!l||(f=We(u,d))!=null&&f.writable)){o===void 0&&(o=ue(l?X(u[d],c):ae),i.set(d,o));var h=_(o);if(h===ae)return!1}return l},set(u,d,o,l){var S;var h=i.get(d),f=d in u;if(s&&d==="length")for(var m=o;m<h.v;m+=1){var g=i.get(m+"");g!==void 0?J(g,ae):m in u&&(g=ue(ae),i.set(m+"",g))}h===void 0?(!f||(S=We(u,d))!=null&&S.writable)&&(h=ue(void 0),J(h,X(o,c)),i.set(d,h)):(f=h.v!==ae,J(h,X(o,c)));var w=Reflect.getOwnPropertyDescriptor(u,d);if(w!=null&&w.set&&w.set.call(l,o),!f){if(s&&typeof d=="string"){var k=i.get("length"),C=Number(d);Number.isInteger(C)&&C>=k.v&&J(k,C+1)}Zr(a)}return!0},ownKeys(u){_(a);var d=Reflect.ownKeys(u).filter(h=>{var f=i.get(h);return f===void 0||f.v!==ae});for(var[o,l]of i)l.v!==ae&&!(o in u)&&d.push(o);return d},setPrototypeOf(){Xi()}})}function Zr(r,e=1){J(r,r.v+e)}var Xr,Un,On;function hs(){if(Xr===void 0){Xr=window;var r=Element.prototype,e=Node.prototype;Un=We(e,"firstChild").get,On=We(e,"nextSibling").get,r.__click=void 0,r.__className="",r.__attributes=null,r.__styles=null,r.__e=void 0,Text.prototype.__t=void 0}}function Xt(r=""){return document.createTextNode(r)}function pt(r){return Un.call(r)}function er(r){return On.call(r)}function y(r,e){return pt(r)}function ge(r,e){{var t=pt(r);return t instanceof Comment&&t.data===""?er(t):t}}function A(r,e=1,t=!1){let n=r;for(;e--;)n=er(n);return n}function fs(r){r.textContent=""}function K(r){var e=fe|Ne;D===null?e|=it:D.f|=An;var t=U!==null&&U.f&fe?U:null;const n={children:null,ctx:W,deps:null,equals:Pn,f:e,fn:r,reactions:null,rv:0,v:null,wv:0,parent:t??D};return t!==null&&(t.children??(t.children=[])).push(n),n}function Bn(r){const e=K(r);return e.equals=Fr,e}function Qn(r){var e=r.children;if(e!==null){r.children=null;for(var t=0;t<e.length;t+=1){var n=e[t];n.f&fe?$r(n):Te(n)}}}function ps(r){for(var e=r.parent;e!==null;){if(!(e.f&fe))return e;e=e.parent}return null}function qn(r){var e,t=D;Ie(ps(r));try{Qn(r),e=ri(r)}finally{Ie(t)}return e}function Gn(r){var e=qn(r),t=(et||r.f&it)&&r.deps!==null?yt:ne;ye(r,t),r.equals(e)||(r.v=e,r.wv=ei())}function $r(r){Qn(r),Rt(r,0),ye(r,bt),r.v=r.children=r.deps=r.ctx=r.reactions=null}function Wn(r){D===null&&U===null&&Yi(),U!==null&&U.f&it&&Hi(),Dr&&zi()}function ms(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function xt(r,e,t,n=!0){var i=(r&wt)!==0,s=D,a={ctx:W,deps:null,deriveds:null,nodes_start:null,nodes_end:null,f:r|Ne,first:null,fn:e,last:null,next:null,parent:i?null:s,prev:null,teardown:null,transitions:null,wv:0};if(t){var c=dt;try{en(!0),Ur(a),a.f|=Qi}catch(o){throw Te(a),o}finally{en(c)}}else e!==null&&nr(a);var u=t&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&(An|Vt))===0;if(!u&&!i&&n&&(s!==null&&ms(a,s),U!==null&&U.f&fe)){var d=U;(d.children??(d.children=[])).push(a)}return a}function gs(r){const e=xt($t,null,!1);return ye(e,ne),e.teardown=r,e}function ze(r){Wn();var e=D!==null&&(D.f&Ee)!==0&&W!==null&&!W.m;if(e){var t=W;(t.e??(t.e=[])).push({fn:r,effect:D,reaction:U})}else{var n=Lr(r);return n}}function vs(r){return Wn(),Nr(r)}function _s(r){const e=xt(wt,r,!0);return(t={})=>new Promise(n=>{t.outro?mt(e,()=>{Te(e),n(void 0)}):(Te(e),n(void 0))})}function Lr(r){return xt(En,r,!1)}function Nr(r){return xt($t,r,!0)}function re(r){return kt(r)}function kt(r,e=0){return xt($t|Ar|e,r,!0)}function He(r,e=!0){return xt($t|Ee,r,!0,e)}function Vn(r){var e=r.teardown;if(e!==null){const t=Dr,n=U;tn(!0),Ye(null);try{e.call(null)}finally{tn(t),Ye(n)}}}function zn(r){var e=r.deriveds;if(e!==null){r.deriveds=null;for(var t=0;t<e.length;t+=1)$r(e[t])}}function Hn(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){var n=t.next;Te(t,e),t=n}}function ws(r){for(var e=r.first;e!==null;){var t=e.next;e.f&Ee||Te(e),e=t}}function Te(r,e=!0){var t=!1;if((e||r.f&Gi)&&r.nodes_start!==null){for(var n=r.nodes_start,i=r.nodes_end;n!==null;){var s=n===i?null:er(n);n.remove(),n=s}t=!0}Hn(r,e&&!t),zn(r),Rt(r,0),ye(r,bt);var a=r.transitions;if(a!==null)for(const u of a)u.stop();Vn(r);var c=r.parent;c!==null&&c.first!==null&&Yn(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=null}function Yn(r){var e=r.parent,t=r.prev,n=r.next;t!==null&&(t.next=n),n!==null&&(n.prev=t),e!==null&&(e.first===r&&(e.first=n),e.last===r&&(e.last=t))}function mt(r,e){var t=[];jr(r,t,!0),Kn(t,()=>{Te(r),e&&e()})}function Kn(r,e){var t=r.length;if(t>0){var n=()=>--t||e();for(var i of r)i.out(n)}else e()}function jr(r,e,t){if(!(r.f&Me)){if(r.f^=Me,r.transitions!==null)for(const a of r.transitions)(a.is_global||t)&&e.push(a);for(var n=r.first;n!==null;){var i=n.next,s=(n.f&Lt)!==0||(n.f&Ee)!==0;jr(n,e,s?t:!1),n=i}}}function Pt(r){Jn(r,!0)}function Jn(r,e){if(r.f&Me){r.f^=Me,r.f&ne||(r.f^=ne),jt(r)&&(ye(r,Ne),nr(r));for(var t=r.first;t!==null;){var n=t.next,i=(t.f&Lt)!==0||(t.f&Ee)!==0;Jn(t,i?e:!1),t=n}if(r.transitions!==null)for(const s of r.transitions)(s.is_global||e)&&s.in()}}let pr=!1,mr=[];function ys(){pr=!1;const r=mr.slice();mr=[],hr(r)}function tr(r){pr||(pr=!0,queueMicrotask(ys)),mr.push(r)}function Zn(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let qt=!1,Ht=!1,Yt=null,dt=!1,Dr=!1;function en(r){dt=r}function tn(r){Dr=r}let gr=[],At=0;let U=null;function Ye(r){U=r}let D=null;function Ie(r){D=r}let Se=null;function bs(r){Se=r}let ce=null,de=0,Re=null;function Cs(r){Re=r}let Xn=1,Kt=0,et=!1,W=null;function ei(){return++Xn}function Nt(){return!Ct||W!==null&&W.l===null}function jt(r){var d;var e=r.f;if(e&Ne)return!0;if(e&yt){var t=r.deps,n=(e&it)!==0;if(t!==null){var i,s,a=(e&zt)!==0,c=n&&D!==null&&!et,u=t.length;if(a||c){for(i=0;i<u;i++)s=t[i],(a||!((d=s==null?void 0:s.reactions)!=null&&d.includes(r)))&&(s.reactions??(s.reactions=[])).push(r);a&&(r.f^=zt)}for(i=0;i<u;i++)if(s=t[i],jt(s)&&Gn(s),s.wv>r.wv)return!0}(!n||D!==null&&!et)&&ye(r,ne)}return!1}function xs(r,e){for(var t=e;t!==null;){if(t.f&Vt)try{t.fn(r);return}catch{t.f^=Vt}t=t.parent}throw qt=!1,r}function ks(r){return(r.f&bt)===0&&(r.parent===null||(r.parent.f&Vt)===0)}function rr(r,e,t,n){if(qt){if(t===null&&(qt=!1),ks(e))throw r;return}t!==null&&(qt=!0);{xs(r,e);return}}function ti(r,e,t=0){var n=r.reactions;if(n!==null)for(var i=0;i<n.length;i++){var s=n[i];s.f&fe?ti(s,e,t+1):e===s&&(t===0?ye(s,Ne):s.f&ne&&ye(s,yt),nr(s))}}function ri(r){var h;var e=ce,t=de,n=Re,i=U,s=et,a=Se,c=W,u=r.f;ce=null,de=0,Re=null,U=u&(Ee|wt)?null:r,et=!dt&&(u&it)!==0,Se=null,W=r.ctx,Kt++;try{var d=(0,r.fn)(),o=r.deps;if(ce!==null){var l;if(Rt(r,de),o!==null&&de>0)for(o.length=de+ce.length,l=0;l<ce.length;l++)o[de+l]=ce[l];else r.deps=o=ce;if(!et)for(l=de;l<o.length;l++)((h=o[l]).reactions??(h.reactions=[])).push(r)}else o!==null&&de<o.length&&(Rt(r,de),o.length=de);if(Nt()&&Re!==null&&!(r.f&(fe|yt|Ne)))for(l=0;l<Re.length;l++)ti(Re[l],r);return i!==null&&Kt++,d}finally{ce=e,de=t,Re=n,U=i,et=s,Se=a,W=c}}function Ms(r,e){let t=e.reactions;if(t!==null){var n=ji.call(t,r);if(n!==-1){var i=t.length-1;i===0?t=e.reactions=null:(t[n]=t[i],t.pop())}}t===null&&e.f&fe&&(ce===null||!ce.includes(e))&&(ye(e,yt),e.f&(it|zt)||(e.f^=zt),Rt(e,0))}function Rt(r,e){var t=r.deps;if(t!==null)for(var n=e;n<t.length;n++)Ms(r,t[n])}function Ur(r){var e=r.f;if(!(e&bt)){ye(r,ne);var t=D,n=W;D=r;try{e&Ar?ws(r):Hn(r),zn(r),Vn(r);var i=ri(r);r.teardown=typeof i=="function"?i:null,r.wv=Xn;var s=r.deps,a;Jr&&rs&&r.f&Ne}catch(c){rr(c,r,t,n||r.ctx)}finally{D=t}}}function Ss(){if(At>1e3){At=0;try{Ki()}catch(r){if(Yt!==null)rr(r,Yt,null);else throw r}}At++}function Ts(r){var e=r.length;if(e!==0){Ss();var t=dt;dt=!0;try{for(var n=0;n<e;n++){var i=r[n];i.f&ne||(i.f^=ne);var s=[];ni(i,s),Is(s)}}finally{dt=t}}}function Is(r){var e=r.length;if(e!==0)for(var t=0;t<e;t++){var n=r[t];if(!(n.f&(bt|Me)))try{jt(n)&&(Ur(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?Yn(n):n.fn=null))}catch(i){rr(i,n,null,n.ctx)}}}function Es(){if(Ht=!1,At>1001)return;const r=gr;gr=[],Ts(r),Ht||(At=0,Yt=null)}function nr(r){Ht||(Ht=!0,queueMicrotask(Es)),Yt=r;for(var e=r;e.parent!==null;){e=e.parent;var t=e.f;if(t&(wt|Ee)){if(!(t&ne))return;e.f^=ne}}gr.push(e)}function ni(r,e){var t=r.first,n=[];e:for(;t!==null;){var i=t.f,s=(i&Ee)!==0,a=s&&(i&ne)!==0,c=t.next;if(!a&&!(i&Me))if(i&$t){if(s)t.f^=ne;else try{jt(t)&&Ur(t)}catch(l){rr(l,t,null,t.ctx)}var u=t.first;if(u!==null){t=u;continue}}else i&En&&n.push(t);if(c===null){let l=t.parent;for(;l!==null;){if(r===l)break e;var d=l.next;if(d!==null){t=d;continue e}l=l.parent}}t=c}for(var o=0;o<n.length;o++)u=n[o],e.push(u),ni(u,e)}function _(r){var o;var e=r.f,t=(e&fe)!==0;if(t&&e&bt){var n=qn(r);return $r(r),n}if(U!==null){Se!==null&&Se.includes(r)&&es();var i=U.deps;r.rv<Kt&&(r.rv=Kt,ce===null&&i!==null&&i[de]===r?de++:ce===null?ce=[r]:ce.push(r))}else if(t&&r.deps===null)for(var s=r,a=s.parent,c=s;a!==null;)if(a.f&fe){var u=a;c=u,a=u.parent}else{var d=a;(o=d.deriveds)!=null&&o.includes(c)||(d.deriveds??(d.deriveds=[])).push(c);break}return t&&(s=r,jt(s)&&Gn(s)),r.v}function rt(r){const e=U;try{return U=null,r()}finally{U=e}}const As=-7169;function ye(r,e){r.f=r.f&As|e}function rn(r,e=1){var t=_(r),n=e===1?t++:t--;return J(r,t),n}function je(r,e=!1,t){W={p:W,c:null,e:null,m:!1,s:r,x:null,l:null},Ct&&!e&&(W.l={s:null,u:null,r1:[],r2:ue(!1)})}function De(r){const e=W;if(e!==null){const a=e.e;if(a!==null){var t=D,n=U;e.e=null;try{for(var i=0;i<a.length;i++){var s=a[i];Ie(s.effect),Ye(s.reaction),Lr(s.fn)}}finally{Ie(t),Ye(n)}}W=e.p,e.m=!0}return{}}function Fs(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(Ve in r)vr(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&Ve in t&&vr(t)}}}function vr(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let n in r)try{vr(r[n],e)}catch{}const t=Er(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const n=In(t);for(let i in n){const s=n[i].get;if(s)try{s.call(r)}catch{}}}}}function Ps(r){return r.endsWith("capture")&&r!=="gotpointercapture"&&r!=="lostpointercapture"}const Rs=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function $s(r){return Rs.includes(r)}const Ls={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject"};function Ns(r){return r=r.toLowerCase(),Ls[r]??r}const js=["touchstart","touchmove"];function Ds(r){return js.includes(r)}function Us(r,e){if(e){const t=document.body;r.autofocus=!0,tr(()=>{document.activeElement===t&&r.focus()})}}let nn=!1;function Os(){nn||(nn=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function ii(r){var e=U,t=D;Ye(null),Ie(null);try{return r()}finally{Ye(e),Ie(t)}}function Bs(r,e,t,n=t){r.addEventListener(e,()=>ii(t));const i=r.__on_r;i?r.__on_r=()=>{i(),n(!0)}:r.__on_r=()=>n(!0),Os()}const si=new Set,_r=new Set;function ai(r,e,t,n){function i(s){if(n.capture||It.call(e,s),!s.cancelBubble)return ii(()=>t.call(this,s))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?tr(()=>{e.addEventListener(r,i,n)}):e.addEventListener(r,i,n),i}function wr(r,e,t,n,i){var s={capture:n,passive:i},a=ai(r,e,t,s);(e===document.body||e===window||e===document)&&gs(()=>{e.removeEventListener(r,a,s)})}function Ke(r){for(var e=0;e<r.length;e++)si.add(r[e]);for(var t of _r)t(r)}function It(r){var C;var e=this,t=e.ownerDocument,n=r.type,i=((C=r.composedPath)==null?void 0:C.call(r))||[],s=i[0]||r.target,a=0,c=r.__root;if(c){var u=i.indexOf(c);if(u!==-1&&(e===document||e===window)){r.__root=e;return}var d=i.indexOf(e);if(d===-1)return;u<=d&&(a=u)}if(s=i[a]||r.target,s!==e){Di(r,"currentTarget",{configurable:!0,get(){return s||t}});var o=U,l=D;Ye(null),Ie(null);try{for(var h,f=[];s!==null;){var m=s.assignedSlot||s.parentNode||s.host||null;try{var g=s["__"+n];if(g!==void 0&&!s.disabled)if(Tr(g)){var[w,...k]=g;w.apply(s,[r,...k])}else g.call(s,r)}catch(S){h?f.push(S):h=S}if(r.cancelBubble||m===e||m===null)break;s=m}if(h){for(let S of f)queueMicrotask(()=>{throw S});throw h}}finally{r.__root=e,delete r.currentTarget,Ye(o),Ie(l)}}}function Or(r){var e=document.createElement("template");return e.innerHTML=r,e.content}function Dt(r,e){var t=D;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function V(r,e){var t=(e&cs)!==0,n,i=!r.startsWith("<!>");return()=>{n===void 0&&(n=Or(i?r:"<!>"+r),n=pt(n));var s=t?document.importNode(n,!0):n.cloneNode(!0);return Dt(s,s),s}}function Qs(r,e,t="svg"){var n=!r.startsWith("<!>"),i=`<${t}>${n?r:"<!>"+r}</${t}>`,s;return()=>{if(!s){var a=Or(i),c=pt(a);s=pt(c)}var u=s.cloneNode(!0);return Dt(u,u),u}}function ve(){var r=document.createDocumentFragment(),e=document.createComment(""),t=Xt();return r.append(e,t),Dt(e,t),r}function R(r,e){r!==null&&r.before(e)}function Y(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=t,r.nodeValue=t==null?"":t+"")}function qs(r,e){return Gs(r,e)}const lt=new Map;function Gs(r,{target:e,anchor:t,props:n={},events:i,context:s,intro:a=!0}){hs();var c=new Set,u=l=>{for(var h=0;h<l.length;h++){var f=l[h];if(!c.has(f)){c.add(f);var m=Ds(f);e.addEventListener(f,It,{passive:m});var g=lt.get(f);g===void 0?(document.addEventListener(f,It,{passive:m}),lt.set(f,1)):lt.set(f,g+1)}}};u(Ir(si)),_r.add(u);var d=void 0,o=_s(()=>{var l=t??e.appendChild(Xt());return He(()=>{if(s){je({});var h=W;h.c=s}i&&(n.$$events=i),d=r(l,n)||{},s&&De()}),()=>{var m;for(var h of c){e.removeEventListener(h,It);var f=lt.get(h);--f===0?(document.removeEventListener(h,It),lt.delete(h)):lt.set(h,f)}_r.delete(u),l!==t&&((m=l.parentNode)==null||m.removeChild(l))}});return Ws.set(d,o),d}let Ws=new WeakMap;function he(r,e,t=!1){var n=r,i=null,s=null,a=ae,c=t?Lt:0,u=!1;const d=(l,h=!0)=>{u=!0,o(h,l)},o=(l,h)=>{a!==(a=l)&&(a?(i?Pt(i):h&&(i=He(()=>h(n))),s&&mt(s,()=>{s=null})):(s?Pt(s):h&&(s=He(()=>h(n))),i&&mt(i,()=>{i=null})))};kt(()=>{u=!1,e(d),u||o(null,null)},c)}function Br(r,e){return e}function Vs(r,e,t,n){for(var i=[],s=e.length,a=0;a<s;a++)jr(e[a].e,i,!0);var c=s>0&&i.length===0&&t!==null;if(c){var u=t.parentNode;fs(u),u.append(t),n.clear(),qe(r,e[0].prev,e[s-1].next)}Kn(i,()=>{for(var d=0;d<s;d++){var o=e[d];c||(n.delete(o.k),qe(r,o.prev,o.next)),Te(o.e,!c)}})}function ir(r,e,t,n,i,s=null){var a=r,c={flags:e,items:new Map,first:null},u=(e&Rn)!==0;if(u){var d=r;a=d.appendChild(Xt())}var o=null,l=!1,h=Bn(()=>{var f=t();return Tr(f)?f:f==null?[]:Ir(f)});kt(()=>{var f=_(h),m=f.length;if(!(l&&m===0)){l=m===0;{var g=U;zs(f,c,a,i,e,(g.f&Me)!==0,n)}s!==null&&(m===0?o?Pt(o):o=He(()=>s(a)):o!==null&&mt(o,()=>{o=null})),_(h)}})}function zs(r,e,t,n,i,s,a,c){var we,Ue,Ce,ee;var u=(i&is)!==0,d=(i&(Pr|Rr))!==0,o=r.length,l=e.items,h=e.first,f=h,m,g=null,w,k=[],C=[],S,T,M,x;if(u)for(x=0;x<o;x+=1)S=r[x],T=a(S,x),M=l.get(T),M!==void 0&&((we=M.a)==null||we.measure(),(w??(w=new Set)).add(M));for(x=0;x<o;x+=1){if(S=r[x],T=a(S,x),M=l.get(T),M===void 0){var F=f?f.e.nodes_start:t;g=Ys(F,e,g,g===null?e.first:g.next,S,T,x,n,i),l.set(T,g),k=[],C=[],f=g.next;continue}if(d&&Hs(M,S,x,i),M.e.f&Me&&(Pt(M.e),u&&((Ue=M.a)==null||Ue.unfix(),(w??(w=new Set)).delete(M))),M!==f){if(m!==void 0&&m.has(M)){if(k.length<C.length){var E=C[0],L;g=E.prev;var H=k[0],j=k[k.length-1];for(L=0;L<k.length;L+=1)sn(k[L],E,t);for(L=0;L<C.length;L+=1)m.delete(C[L]);qe(e,H.prev,j.next),qe(e,g,H),qe(e,j,E),f=E,g=j,x-=1,k=[],C=[]}else m.delete(M),sn(M,f,t),qe(e,M.prev,M.next),qe(e,M,g===null?e.first:g.next),qe(e,g,M),g=M;continue}for(k=[],C=[];f!==null&&f.k!==T;)(s||!(f.e.f&Me))&&(m??(m=new Set)).add(f),C.push(f),f=f.next;if(f===null)continue;M=f}k.push(M),g=M,f=M.next}if(f!==null||m!==void 0){for(var q=m===void 0?[]:Ir(m);f!==null;)(s||!(f.e.f&Me))&&q.push(f),f=f.next;var Z=q.length;if(Z>0){var be=i&Rn&&o===0?t:null;if(u){for(x=0;x<Z;x+=1)(Ce=q[x].a)==null||Ce.measure();for(x=0;x<Z;x+=1)(ee=q[x].a)==null||ee.fix()}Vs(e,q,be,l)}}u&&tr(()=>{var at;if(w!==void 0)for(M of w)(at=M.a)==null||at.apply()}),D.first=e.first&&e.first.e,D.last=g&&g.e}function Hs(r,e,t,n){n&Pr&&fr(r.v,e),n&Rr?fr(r.i,t):r.i=t}function Ys(r,e,t,n,i,s,a,c,u,d){var o=(u&Pr)!==0,l=(u&ss)===0,h=o?l?Nn(i):ue(i):i,f=u&Rr?ue(a):a,m={i:f,v:h,k:s,a:null,e:null,prev:t,next:n};try{return m.e=He(()=>c(r,h,f),Dn),m.e.prev=t&&t.e,m.e.next=n&&n.e,t===null?e.first=m:(t.next=m,t.e.next=m.e),n!==null&&(n.prev=m,n.e.prev=m.e),m}finally{}}function sn(r,e,t){for(var n=r.next?r.next.e.nodes_start:t,i=e?e.e.nodes_start:t,s=r.e.nodes_start;s!==n;){var a=er(s);i.before(s),s=a}}function qe(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Ks(r,e,t,n,i){var s=r,a="",c;kt(()=>{a!==(a=e()??"")&&(c!==void 0&&(Te(c),c=void 0),a!==""&&(c=He(()=>{var u=a+"",d=Or(u);Dt(pt(d),d.lastChild),s.before(d)})))})}function _e(r,e,t,n,i){var c;var s=(c=e.$$slots)==null?void 0:c[t],a=!1;s===!0&&(s=e[t==="default"?"children":t],a=!0),s===void 0?i!==null&&i(r):s(r,a?()=>n:n)}function Js(r,e,t){var n=r,i,s;kt(()=>{i!==(i=e())&&(s&&(mt(s),s=null),i&&(s=He(()=>t(n,i))))},Lt)}function Zs(r,e,t,n,i,s){var a,c,u=null,d=r,o;kt(()=>{const l=e()||null;var h=Ln;l!==a&&(o&&(l===null?mt(o,()=>{o=null,c=null}):l===c?Pt(o):Te(o)),l&&l!==c&&(o=He(()=>{u=document.createElementNS(h,l),Dt(u,u);{var f=u.appendChild(Xt());n(u,f)}D.nodes_end=u,d.before(u)})),a=l,a&&(c=a))},Lt)}function oi(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=oi(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Xs(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=oi(r))&&(n&&(n+=" "),n+=e);return n}function ea(r){return typeof r=="object"?Xs(r):r??""}function ta(r,e){e?r.hasAttribute("selected")||r.setAttribute("selected",""):r.removeAttribute("selected")}function Jt(r,e,t,n){var i=r.__attributes??(r.__attributes={});i[e]!==(i[e]=t)&&(e==="style"&&"__styles"in r&&(r.__styles={}),e==="loading"&&(r[Wi]=t),t==null?r.removeAttribute(e):typeof t!="string"&&li(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function an(r,e,t,n,i=!1,s=!1,a=!1){var c=e||{},u=r.tagName==="OPTION";for(var d in e)d in t||(t[d]=null);t.class&&(t.class=ea(t.class));var o=li(r),l=r.__attributes??(r.__attributes={});for(const C in t){let S=t[C];if(u&&C==="value"&&S==null){r.value=r.__value="",c[C]=S;continue}var h=c[C];if(S!==h){c[C]=S;var f=C[0]+C[1];if(f!=="$$"){if(f==="on"){const T={},M="$$"+C;let x=C.slice(2);var m=$s(x);if(Ps(x)&&(x=x.slice(0,-7),T.capture=!0),!m&&h){if(S!=null)continue;r.removeEventListener(x,c[M],T),c[M]=null}if(S!=null)if(m)r[`__${x}`]=S,Ke([x]);else{let F=function(E){c[C].call(this,E)};var k=F;c[M]=ai(x,r,F,T)}else m&&(r[`__${x}`]=void 0)}else if(C==="style"&&S!=null)r.style.cssText=S+"";else if(C==="autofocus")Us(r,!!S);else if(C==="__value"||C==="value"&&S!=null)r.value=r[C]=r.__value=S;else if(C==="selected"&&u)ta(r,S);else{var g=C;i||(g=Ns(g));var w=g==="defaultValue"||g==="defaultChecked";if(S==null&&!s&&!w)if(l[C]=null,g==="value"||g==="checked"){let T=r;if(g==="value"){let M=T.defaultValue;T.removeAttribute(g),T.defaultValue=M}else{let M=T.defaultChecked;T.removeAttribute(g),T.defaultChecked=M}}else r.removeAttribute(C);else w||o.includes(g)&&(s||typeof S!="string")?r[g]=S:typeof S!="function"&&Jt(r,g,S)}C==="style"&&"__styles"in r&&(r.__styles={})}}}return c}var on=new Map;function li(r){var e=on.get(r.nodeName);if(e)return e;on.set(r.nodeName,e=[]);for(var t,n=r,i=Element.prototype;i!==n;){t=In(n);for(var s in t)t[s].set&&e.push(s);n=Er(n)}return e}function $e(r,e,t){var n=r.__className,i=ra(e);(n!==i||Dn)&&(e==null?r.removeAttribute("class"):r.className=i,r.__className=i)}function ra(r,e){return(r??"")+""}function na(r,e,t){if(t){if(r.classList.contains(e))return;r.classList.add(e)}else{if(!r.classList.contains(e))return;r.classList.remove(e)}}function Qr(r,e,t=e){var n=Nt();Bs(r,"input",i=>{var s=i?r.defaultValue:r.value;if(s=ar(r)?or(s):s,t(s),n&&s!==(s=e())){var a=r.selectionStart,c=r.selectionEnd;r.value=s??"",c!==null&&(r.selectionStart=a,r.selectionEnd=Math.min(c,r.value.length))}}),rt(e)==null&&r.value&&t(ar(r)?or(r.value):r.value),Nr(()=>{var i=e();ar(r)&&i===or(r.value)||r.type==="date"&&!i&&!r.value||i!==r.value&&(r.value=i??"")})}function ar(r){var e=r.type;return e==="number"||e==="range"}function or(r){return r===""?null:+r}function ln(r,e){return r===e||(r==null?void 0:r[Ve])===e}function ia(r={},e,t,n){return Lr(()=>{var i,s;return Nr(()=>{i=s,s=[],rt(()=>{r!==t(...s)&&(e(r,...s),i&&ln(t(...i),r)&&e(null,...i))})}),()=>{tr(()=>{s&&ln(t(...s),r)&&e(null,...s)})}}),r}function sa(r=!1){const e=W,t=e.l.u;if(!t)return;let n=()=>Fs(e.s);if(r){let i=0,s={};const a=K(()=>{let c=!1;const u=e.s;for(const d in u)u[d]!==s[d]&&(s[d]=u[d],c=!0);return c&&i++,i});n=()=>_(a)}t.b.length&&vs(()=>{un(e,n),hr(t.b)}),ze(()=>{const i=rt(()=>t.m.map(Bi));return()=>{for(const s of i)typeof s=="function"&&s()}}),t.a.length&&ze(()=>{un(e,n),hr(t.a)})}function un(r,e){if(r.l.s)for(const t of r.l.s)_(t);e()}let Ut=!1;function aa(r){var e=Ut;try{return Ut=!1,[r(),Ut]}finally{Ut=e}}const oa={get(r,e){if(!r.exclude.includes(e))return _(r.version),e in r.special?r.special[e]():r.props[e]},set(r,e,t){return e in r.special||(r.special[e]=Ge({get[e](){return r.props[e]}},e,$n)),r.special[e](t),rn(r.version),!0},getOwnPropertyDescriptor(r,e){if(!r.exclude.includes(e)&&e in r.props)return{enumerable:!0,configurable:!0,value:r.props[e]}},deleteProperty(r,e){return r.exclude.includes(e)||(r.exclude.push(e),rn(r.version)),!0},has(r,e){return r.exclude.includes(e)?!1:e in r.props},ownKeys(r){return Reflect.ownKeys(r.props).filter(e=>!r.exclude.includes(e))}};function me(r,e){return new Proxy({props:r,exclude:e,special:{},version:ue(0)},oa)}const la={get(r,e){let t=r.props.length;for(;t--;){let n=r.props[t];if(St(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n)return n[e]}},set(r,e,t){let n=r.props.length;for(;n--;){let i=r.props[n];St(i)&&(i=i());const s=We(i,e);if(s&&s.set)return s.set(t),!0}return!1},getOwnPropertyDescriptor(r,e){let t=r.props.length;for(;t--;){let n=r.props[t];if(St(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n){const i=We(n,e);return i&&!i.configurable&&(i.configurable=!0),i}}},has(r,e){if(e===Ve||e===Fn)return!1;for(let t of r.props)if(St(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(r){const e=[];for(let t of r.props){St(t)&&(t=t());for(const n in t)e.includes(n)||e.push(n)}return e}};function Ae(...r){return new Proxy({props:r},la)}function cn(r){for(var e=D,t=D;e!==null&&!(e.f&(Ee|wt));)e=e.parent;try{return Ie(e),r()}finally{Ie(t)}}function Ge(r,e,t,n){var F;var i=(t&as)!==0,s=!Ct||(t&os)!==0,a=(t&ls)!==0,c=(t&us)!==0,u=!1,d;a?[d,u]=aa(()=>r[e]):d=r[e];var o=Ve in r||Fn in r,l=a&&(((F=We(r,e))==null?void 0:F.set)??(o&&e in r&&(E=>r[e]=E)))||void 0,h=n,f=!0,m=!1,g=()=>(m=!0,f&&(f=!1,c?h=rt(n):h=n),h);d===void 0&&n!==void 0&&(l&&s&&Ji(),d=g(),l&&l(d));var w;if(s)w=()=>{var E=r[e];return E===void 0?g():(f=!0,m=!1,E)};else{var k=cn(()=>(i?K:Bn)(()=>r[e]));k.f|=qi,w=()=>{var E=_(k);return E!==void 0&&(h=void 0),E===void 0?h:E}}if(!(t&$n))return w;if(l){var C=r.$$legacy;return function(E,L){return arguments.length>0?((!s||!L||C||u)&&l(L?w():E),E):w()}}var S=!1,T=!1,M=Nn(d),x=cn(()=>K(()=>{var E=w(),L=_(M);return S?(S=!1,T=!0,L):(T=!1,M.v=E)}));return i||(x.equals=Fr),function(E,L){if(arguments.length>0){const H=L?_(x):s&&a?X(E):E;return x.equals(H)||(S=!0,J(M,H),m&&h!==void 0&&(h=H),rt(()=>_(x))),E}return _(x)}}function ua(r){W===null&&Zn(),Ct&&W.l!==null?da(W).m.push(r):ze(()=>{const e=rt(r);if(typeof e=="function")return e})}function ca(r){W===null&&Zn(),ua(()=>()=>rt(r))}function da(r){var e=r.l;return e.u??(e.u={a:[],b:[],m:[]})}const ha="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ha);const dn=new Map;function fa(r){const e=Array.isArray(r)?r:[r],t=e.join(","),n=dn.get(t)??(()=>{const i=ui(e),s=pa(i);return dn.set(t,s),s})();return i=>n(i)}function ui(r){return Array.isArray(r)?r.map(e=>e.split(":")):[r.split(":")]}function pa(r){const e=r.flatMap(i=>ma(i,ci(i))),t=va(e),n=_a(t);return i=>!!n(i.update,i)}function ci(r){const e=Gt,t=[r].flatMap(n=>{const[i,s,a]=n;if(!(i in _n))return[n];if(!i&&!s&&!a)return[n];const u=_n[i].map(d=>[d,s,a]);return s===void 0||s in ur&&(s||a)?u:u.filter(([d])=>{var o;return!!((o=e[d])!=null&&o[s])})}).flatMap(n=>{const[i,s,a]=n;if(!(s in ur))return[n];if(!s&&!a)return[n];const u=ur[s].map(d=>[i,d,a]);return a===void 0?u:u.filter(([,d])=>{var o,l;return!!((l=(o=e[i])==null?void 0:o[d])!=null&&l[a])})});if(t.length===0)throw new Error(`Shortcuts in '${r.join(":")}' do not expand to any valid filter query`);return t}function ma(r,e){if(e.length===0)throw new Error("Empty filter query given");const t=e.map(ga).filter(n=>n!==!0);if(t.length===0)return e;throw t.length===1?new Error(t[0]):new Error(`Invalid filter query '${r.join(":")}'. There are ${t.length} errors after expanding the contained shortcuts: ${t.join("; ")}`)}function ga(r){const[e,t,n,...i]=r;if(e===void 0)return"Empty filter query given";if(!(e in Gt)){const c=Object.keys(Gt);return`Invalid L1 filter '${e}' given in '${r.join(":")}'. Permitted values are: ${c.map(u=>`'${u}'`).join(", ")}.`}if(t===void 0)return!0;const s=Gt[e];if(!(t in s)){const c=Object.keys(s);return`Invalid L2 filter '${t}' given in '${r.join(":")}'. Permitted values are: ${c.map(u=>`'${u}'`).join(", ")}.`}if(n===void 0)return!0;const a=s[t];if(!(n in a)){const c=Object.keys(a);return`Invalid L3 filter '${n}' given in '${r.join(":")}'. ${c.length===0?`No further filtering is possible after '${e}:${t}'.`:`Permitted values are: ${c.map(u=>`'${u}'`).join(", ")}.`}`}return i.length===0?!0:`Cannot filter further than three levels, ':${i.join(":")}' is invalid!`}function va(r){const e={};for(const[t,n,i]of r){const s=e[t]??(e[t]={});if(n!==void 0){const a=s[n]??(s[n]=new Set);i!==void 0&&a.add(i)}}return e}function lr(r,e){return(t,n)=>r(t,n)||e(t,n)}function hn(r,e){return(t,n)=>{const i=r(t,n);return i&&e(i,n)}}function fn(r){return(e,t)=>r(e,t)!=null}function _a(r){const e=Object.entries(r).map(([t,n])=>{const i=a=>a[t],s=Object.entries(n).map(([a,c])=>{const u=o=>o[a],d=Array.from(c).map(o=>o==="me"?(h,f)=>{const m=f.me.id;return pn(h,g=>g.id===m)}:h=>pn(h,f=>f[o]||f.type===o));return d.length===0?fn(u):hn(u,d.reduce(lr))});return s.length===0?fn(i):hn(i,s.reduce(lr))});if(e.length===0)throw new Error("Cannot create filter function for empty query");return e.reduce(lr)}function pn(r,e){const t=n=>n!=null&&e(n);return Array.isArray(r)?r.some(t):t(r)}const mn={mention:{},hashtag:{},cashtag:{},bot_command:{},url:{},email:{},phone_number:{},bold:{},italic:{},underline:{},strikethrough:{},spoiler:{},blockquote:{},expandable_blockquote:{},code:{},pre:{},text_link:{},text_mention:{},custom_emoji:{}},yr={me:{},is_bot:{},is_premium:{},added_to_attachment_menu:{}},wa={user:{},hidden_user:{},chat:{},channel:{}},ya={is_video:{},is_animated:{},premium_animation:{}},br={emoji:{},custom_emoji:{},paid:{}},di={forward_origin:wa,is_topic_message:{},is_automatic_forward:{},business_connection_id:{},text:{},animation:{},audio:{},document:{},paid_media:{},photo:{},sticker:ya,story:{},video:{},video_note:{},voice:{},contact:{},dice:{},game:{},poll:{},venue:{},location:{},entities:mn,caption_entities:mn,caption:{},effect_id:{},has_media_spoiler:{},new_chat_title:{},new_chat_photo:{},delete_chat_photo:{},message_auto_delete_timer_changed:{},pinned_message:{},invoice:{},proximity_alert_triggered:{},chat_background_set:{},giveaway_created:{},giveaway:{only_new_members:{},has_public_winners:{}},giveaway_winners:{only_new_members:{},was_refunded:{}},giveaway_completed:{},video_chat_scheduled:{},video_chat_started:{},video_chat_ended:{},video_chat_participants_invited:{},web_app_data:{}},Ot={...di,new_chat_members:yr,left_chat_member:yr,group_chat_created:{},supergroup_chat_created:{},migrate_to_chat_id:{},migrate_from_chat_id:{},successful_payment:{},refunded_payment:{},users_shared:{},chat_shared:{},connected_website:{},write_access_allowed:{},passport_data:{},boost_added:{},forum_topic_created:{},forum_topic_edited:{name:{},icon_custom_emoji_id:{}},forum_topic_closed:{},forum_topic_reopened:{},general_forum_topic_hidden:{},general_forum_topic_unhidden:{},sender_boost_count:{}},gn={...di,channel_chat_created:{}},ba={can_reply:{},is_enabled:{}},Ca={old_reaction:br,new_reaction:br},xa={reactions:br},ka={data:{},game_short_name:{}},vn={from:yr},Gt={message:Ot,edited_message:Ot,channel_post:gn,edited_channel_post:gn,business_connection:ba,business_message:Ot,edited_business_message:Ot,deleted_business_messages:{},inline_query:{},chosen_inline_result:{},callback_query:ka,shipping_query:{},pre_checkout_query:{},poll:{},poll_answer:{},my_chat_member:vn,chat_member:vn,chat_join_request:{},message_reaction:Ca,message_reaction_count:xa,chat_boost:{},removed_chat_boost:{},purchased_paid_media:{}},_n={"":["message","channel_post"],msg:["message","channel_post"],edit:["edited_message","edited_channel_post"]},ur={"":["entities","caption_entities"],media:["photo","video"],file:["photo","animation","audio","document","video","video_note","voice","sticker"]},ke={filterQuery(r){const e=fa(r);return t=>e(t)},text(r){const e=ke.filterQuery([":text",":caption"]),t=Je(r);return n=>{if(!e(n))return!1;const i=n.message??n.channelPost,s=i.text??i.caption;return Ze(n,s,t)}},command(r){const e=ke.filterQuery(":entities:bot_command"),t=new Set,n=new Set;return Zt(r).forEach(i=>{if(i.startsWith("/"))throw new Error(`Do not include '/' when registering command handlers (use '${i.substring(1)}' not '${i}')`);(i.includes("@")?t:n).add(i)}),i=>{if(!e(i))return!1;const s=i.message??i.channelPost,a=s.text??s.caption;return s.entities.some(c=>{if(c.type!=="bot_command"||c.offset!==0)return!1;const u=a.substring(1,c.length);if(n.has(u)||t.has(u))return i.match=a.substring(u.length+1).trimStart(),!0;const d=u.indexOf("@");if(d===-1)return!1;const o=u.substring(d+1).toLowerCase(),l=i.me.username.toLowerCase();if(o!==l)return!1;const h=u.substring(0,d);return n.has(h)?(i.match=a.substring(u.length+1).trimStart(),!0):!1})}},reaction(r){const e=ke.filterQuery("message_reaction"),t=typeof r=="string"?[{type:"emoji",emoji:r}]:(Array.isArray(r)?r:[r]).map(a=>typeof a=="string"?{type:"emoji",emoji:a}:a),n=new Set(t.filter(a=>a.type==="emoji").map(a=>a.emoji)),i=new Set(t.filter(a=>a.type==="custom_emoji").map(a=>a.custom_emoji_id)),s=t.some(a=>a.type==="paid");return a=>{if(!e(a))return!1;const{old_reaction:c,new_reaction:u}=a.messageReaction;for(const d of u){let o=!1;if(d.type==="emoji"){for(const l of c)if(l.type==="emoji"&&l.emoji===d.emoji){o=!0;break}}else if(d.type==="custom_emoji"){for(const l of c)if(l.type==="custom_emoji"&&l.custom_emoji_id===d.custom_emoji_id){o=!0;break}}else if(d.type==="paid"){for(const l of c)if(l.type==="paid"){o=!0;break}}if(!o)if(d.type==="emoji"){if(n.has(d.emoji))return!0}else if(d.type==="custom_emoji"){if(i.has(d.custom_emoji_id))return!0}else if(d.type==="paid"){if(s)return!0}else return!0}return!1}},chatType(r){const e=new Set(Zt(r));return t=>{var n;return((n=t.chat)==null?void 0:n.type)!==void 0&&e.has(t.chat.type)}},callbackQuery(r){const e=ke.filterQuery("callback_query:data"),t=Je(r);return n=>e(n)&&Ze(n,n.callbackQuery.data,t)},gameQuery(r){const e=ke.filterQuery("callback_query:game_short_name"),t=Je(r);return n=>e(n)&&Ze(n,n.callbackQuery.game_short_name,t)},inlineQuery(r){const e=ke.filterQuery("inline_query"),t=Je(r);return n=>e(n)&&Ze(n,n.inlineQuery.query,t)},chosenInlineResult(r){const e=ke.filterQuery("chosen_inline_result"),t=Je(r);return n=>e(n)&&Ze(n,n.chosenInlineResult.result_id,t)},preCheckoutQuery(r){const e=ke.filterQuery("pre_checkout_query"),t=Je(r);return n=>e(n)&&Ze(n,n.preCheckoutQuery.invoice_payload,t)},shippingQuery(r){const e=ke.filterQuery("shipping_query"),t=Je(r);return n=>e(n)&&Ze(n,n.shippingQuery.invoice_payload,t)}},oe=class oe{constructor(e,t,n){P(this,"update");P(this,"api");P(this,"me");P(this,"match");this.update=e,this.api=t,this.me=n}get message(){return this.update.message}get editedMessage(){return this.update.edited_message}get channelPost(){return this.update.channel_post}get editedChannelPost(){return this.update.edited_channel_post}get businessConnection(){return this.update.business_connection}get businessMessage(){return this.update.business_message}get editedBusinessMessage(){return this.update.edited_business_message}get deletedBusinessMessages(){return this.update.deleted_business_messages}get messageReaction(){return this.update.message_reaction}get messageReactionCount(){return this.update.message_reaction_count}get inlineQuery(){return this.update.inline_query}get chosenInlineResult(){return this.update.chosen_inline_result}get callbackQuery(){return this.update.callback_query}get shippingQuery(){return this.update.shipping_query}get preCheckoutQuery(){return this.update.pre_checkout_query}get poll(){return this.update.poll}get pollAnswer(){return this.update.poll_answer}get myChatMember(){return this.update.my_chat_member}get chatMember(){return this.update.chat_member}get chatJoinRequest(){return this.update.chat_join_request}get chatBoost(){return this.update.chat_boost}get removedChatBoost(){return this.update.removed_chat_boost}get purchasedPaidMedia(){return this.update.purchased_paid_media}get msg(){var e;return this.message??this.editedMessage??this.channelPost??this.editedChannelPost??this.businessMessage??this.editedBusinessMessage??((e=this.callbackQuery)==null?void 0:e.message)}get chat(){var e;return(e=this.msg??this.deletedBusinessMessages??this.messageReaction??this.messageReactionCount??this.myChatMember??this.chatMember??this.chatJoinRequest??this.chatBoost??this.removedChatBoost)==null?void 0:e.chat}get senderChat(){var e;return(e=this.msg)==null?void 0:e.sender_chat}get from(){var e,t,n,i;return((n=this.businessConnection??this.messageReaction??((t=((e=this.chatBoost)==null?void 0:e.boost)??this.removedChatBoost)==null?void 0:t.source))==null?void 0:n.user)??((i=this.callbackQuery??this.msg??this.inlineQuery??this.chosenInlineResult??this.shippingQuery??this.preCheckoutQuery??this.myChatMember??this.chatMember??this.chatJoinRequest??this.purchasedPaidMedia)==null?void 0:i.from)}get msgId(){var e,t,n;return((e=this.msg)==null?void 0:e.message_id)??((t=this.messageReaction)==null?void 0:t.message_id)??((n=this.messageReactionCount)==null?void 0:n.message_id)}get chatId(){var e,t;return((e=this.chat)==null?void 0:e.id)??((t=this.businessConnection)==null?void 0:t.user_chat_id)}get inlineMessageId(){var e,t;return((e=this.callbackQuery)==null?void 0:e.inline_message_id)??((t=this.chosenInlineResult)==null?void 0:t.inline_message_id)}get businessConnectionId(){var e,t,n;return((e=this.msg)==null?void 0:e.business_connection_id)??((t=this.businessConnection)==null?void 0:t.id)??((n=this.deletedBusinessMessages)==null?void 0:n.business_connection_id)}entities(e){const t=this.msg;if(t===void 0)return[];const n=t.text??t.caption;if(n===void 0)return[];let i=t.entities??t.caption_entities;if(i===void 0)return[];if(e!==void 0){const s=new Set(Zt(e));i=i.filter(a=>s.has(a.type))}return i.map(s=>({...s,text:n.substring(s.offset,s.offset+s.length)}))}reactions(){const e=[],t=[],n=[],i=[],s=[],a=[],c=[],u=[];let d=!1,o=!1;const l=this.messageReaction;if(l!==void 0){const{old_reaction:h,new_reaction:f}=l;for(const m of f)m.type==="emoji"?e.push(m.emoji):m.type==="custom_emoji"?s.push(m.custom_emoji_id):m.type==="paid"&&(d=o=!0);for(const m of h)m.type==="emoji"?i.push(m.emoji):m.type==="custom_emoji"?u.push(m.custom_emoji_id):m.type==="paid"&&(o=!1);t.push(...e),a.push(...s);for(let m=0;m<i.length;m++){const g=t.length;if(g===0)break;const w=i[m];for(let k=0;k<g;k++)if(w===t[k]){n.push(w),i.splice(m,1),t.splice(k,1),m--;break}}for(let m=0;m<u.length;m++){const g=a.length;if(g===0)break;const w=u[m];for(let k=0;k<g;k++)if(w===a[k]){c.push(w),u.splice(m,1),a.splice(k,1),m--;break}}}return{emoji:e,emojiAdded:t,emojiKept:n,emojiRemoved:i,customEmoji:s,customEmojiAdded:a,customEmojiKept:c,customEmojiRemoved:u,paid:d,paidAdded:o}}has(e){return oe.has.filterQuery(e)(this)}hasText(e){return oe.has.text(e)(this)}hasCommand(e){return oe.has.command(e)(this)}hasReaction(e){return oe.has.reaction(e)(this)}hasChatType(e){return oe.has.chatType(e)(this)}hasCallbackQuery(e){return oe.has.callbackQuery(e)(this)}hasGameQuery(e){return oe.has.gameQuery(e)(this)}hasInlineQuery(e){return oe.has.inlineQuery(e)(this)}hasChosenInlineResult(e){return oe.has.chosenInlineResult(e)(this)}hasPreCheckoutQuery(e){return oe.has.preCheckoutQuery(e)(this)}hasShippingQuery(e){return oe.has.shippingQuery(e)(this)}reply(e,t,n){return this.api.sendMessage(p(this.chatId,"sendMessage"),e,{business_connection_id:this.businessConnectionId,...t},n)}forwardMessage(e,t,n){return this.api.forwardMessage(e,p(this.chatId,"forwardMessage"),p(this.msgId,"forwardMessage"),t,n)}forwardMessages(e,t,n,i){return this.api.forwardMessages(e,p(this.chatId,"forwardMessages"),t,n,i)}copyMessage(e,t,n){return this.api.copyMessage(e,p(this.chatId,"copyMessage"),p(this.msgId,"copyMessage"),t,n)}copyMessages(e,t,n,i){return this.api.copyMessages(e,p(this.chatId,"copyMessages"),t,n,i)}replyWithPhoto(e,t,n){return this.api.sendPhoto(p(this.chatId,"sendPhoto"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithAudio(e,t,n){return this.api.sendAudio(p(this.chatId,"sendAudio"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithDocument(e,t,n){return this.api.sendDocument(p(this.chatId,"sendDocument"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithVideo(e,t,n){return this.api.sendVideo(p(this.chatId,"sendVideo"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithAnimation(e,t,n){return this.api.sendAnimation(p(this.chatId,"sendAnimation"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithVoice(e,t,n){return this.api.sendVoice(p(this.chatId,"sendVoice"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithVideoNote(e,t,n){return this.api.sendVideoNote(p(this.chatId,"sendVideoNote"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithMediaGroup(e,t,n){return this.api.sendMediaGroup(p(this.chatId,"sendMediaGroup"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithLocation(e,t,n,i){return this.api.sendLocation(p(this.chatId,"sendLocation"),e,t,{business_connection_id:this.businessConnectionId,...n},i)}editMessageLiveLocation(e,t,n,i){const s=this.inlineMessageId;return s!==void 0?this.api.editMessageLiveLocationInline(s,e,t,n):this.api.editMessageLiveLocation(p(this.chatId,"editMessageLiveLocation"),p(this.msgId,"editMessageLiveLocation"),e,t,n,i)}stopMessageLiveLocation(e,t){const n=this.inlineMessageId;return n!==void 0?this.api.stopMessageLiveLocationInline(n,e):this.api.stopMessageLiveLocation(p(this.chatId,"stopMessageLiveLocation"),p(this.msgId,"stopMessageLiveLocation"),e,t)}sendPaidMedia(e,t,n,i){return this.api.sendPaidMedia(p(this.chatId,"sendPaidMedia"),e,t,n,i)}replyWithVenue(e,t,n,i,s,a){return this.api.sendVenue(p(this.chatId,"sendVenue"),e,t,n,i,{business_connection_id:this.businessConnectionId,...s},a)}replyWithContact(e,t,n,i){return this.api.sendContact(p(this.chatId,"sendContact"),e,t,{business_connection_id:this.businessConnectionId,...n},i)}replyWithPoll(e,t,n,i){return this.api.sendPoll(p(this.chatId,"sendPoll"),e,t,{business_connection_id:this.businessConnectionId,...n},i)}replyWithDice(e,t,n){return this.api.sendDice(p(this.chatId,"sendDice"),e,{business_connection_id:this.businessConnectionId,...t},n)}replyWithChatAction(e,t,n){return this.api.sendChatAction(p(this.chatId,"sendChatAction"),e,{business_connection_id:this.businessConnectionId,...t},n)}react(e,t,n){return this.api.setMessageReaction(p(this.chatId,"setMessageReaction"),p(this.msgId,"setMessageReaction"),typeof e=="string"?[{type:"emoji",emoji:e}]:(Array.isArray(e)?e:[e]).map(i=>typeof i=="string"?{type:"emoji",emoji:i}:i),t,n)}getUserProfilePhotos(e,t){return this.api.getUserProfilePhotos(p(this.from,"getUserProfilePhotos").id,e,t)}setUserEmojiStatus(e,t){return this.api.setUserEmojiStatus(p(this.from,"setUserEmojiStatus").id,e,t)}getUserChatBoosts(e,t){return this.api.getUserChatBoosts(e,p(this.from,"getUserChatBoosts").id,t)}getBusinessConnection(e){return this.api.getBusinessConnection(p(this.businessConnectionId,"getBusinessConnection"),e)}getFile(e){const t=p(this.msg,"getFile"),n=t.photo!==void 0?t.photo[t.photo.length-1]:t.animation??t.audio??t.document??t.video??t.video_note??t.voice??t.sticker;return this.api.getFile(p(n,"getFile").file_id,e)}kickAuthor(...e){return this.banAuthor(...e)}banAuthor(e,t){return this.api.banChatMember(p(this.chatId,"banAuthor"),p(this.from,"banAuthor").id,e,t)}kickChatMember(...e){return this.banChatMember(...e)}banChatMember(e,t,n){return this.api.banChatMember(p(this.chatId,"banChatMember"),e,t,n)}unbanChatMember(e,t,n){return this.api.unbanChatMember(p(this.chatId,"unbanChatMember"),e,t,n)}restrictAuthor(e,t,n){return this.api.restrictChatMember(p(this.chatId,"restrictAuthor"),p(this.from,"restrictAuthor").id,e,t,n)}restrictChatMember(e,t,n,i){return this.api.restrictChatMember(p(this.chatId,"restrictChatMember"),e,t,n,i)}promoteAuthor(e,t){return this.api.promoteChatMember(p(this.chatId,"promoteAuthor"),p(this.from,"promoteAuthor").id,e,t)}promoteChatMember(e,t,n){return this.api.promoteChatMember(p(this.chatId,"promoteChatMember"),e,t,n)}setChatAdministratorAuthorCustomTitle(e,t){return this.api.setChatAdministratorCustomTitle(p(this.chatId,"setChatAdministratorAuthorCustomTitle"),p(this.from,"setChatAdministratorAuthorCustomTitle").id,e,t)}setChatAdministratorCustomTitle(e,t,n){return this.api.setChatAdministratorCustomTitle(p(this.chatId,"setChatAdministratorCustomTitle"),e,t,n)}banChatSenderChat(e,t){return this.api.banChatSenderChat(p(this.chatId,"banChatSenderChat"),e,t)}unbanChatSenderChat(e,t){return this.api.unbanChatSenderChat(p(this.chatId,"unbanChatSenderChat"),e,t)}setChatPermissions(e,t,n){return this.api.setChatPermissions(p(this.chatId,"setChatPermissions"),e,t,n)}exportChatInviteLink(e){return this.api.exportChatInviteLink(p(this.chatId,"exportChatInviteLink"),e)}createChatInviteLink(e,t){return this.api.createChatInviteLink(p(this.chatId,"createChatInviteLink"),e,t)}editChatInviteLink(e,t,n){return this.api.editChatInviteLink(p(this.chatId,"editChatInviteLink"),e,t,n)}createChatSubscriptionInviteLink(e,t,n,i){return this.api.createChatSubscriptionInviteLink(p(this.chatId,"createChatSubscriptionInviteLink"),e,t,n,i)}editChatSubscriptionInviteLink(e,t,n){return this.api.editChatSubscriptionInviteLink(p(this.chatId,"editChatSubscriptionInviteLink"),e,t,n)}revokeChatInviteLink(e,t){return this.api.revokeChatInviteLink(p(this.chatId,"editChatInviteLink"),e,t)}approveChatJoinRequest(e,t){return this.api.approveChatJoinRequest(p(this.chatId,"approveChatJoinRequest"),e,t)}declineChatJoinRequest(e,t){return this.api.declineChatJoinRequest(p(this.chatId,"declineChatJoinRequest"),e,t)}setChatPhoto(e,t){return this.api.setChatPhoto(p(this.chatId,"setChatPhoto"),e,t)}deleteChatPhoto(e){return this.api.deleteChatPhoto(p(this.chatId,"deleteChatPhoto"),e)}setChatTitle(e,t){return this.api.setChatTitle(p(this.chatId,"setChatTitle"),e,t)}setChatDescription(e,t){return this.api.setChatDescription(p(this.chatId,"setChatDescription"),e,t)}pinChatMessage(e,t,n){return this.api.pinChatMessage(p(this.chatId,"pinChatMessage"),e,t,n)}unpinChatMessage(e,t){return this.api.unpinChatMessage(p(this.chatId,"unpinChatMessage"),e,t)}unpinAllChatMessages(e){return this.api.unpinAllChatMessages(p(this.chatId,"unpinAllChatMessages"),e)}leaveChat(e){return this.api.leaveChat(p(this.chatId,"leaveChat"),e)}getChat(e){return this.api.getChat(p(this.chatId,"getChat"),e)}getChatAdministrators(e){return this.api.getChatAdministrators(p(this.chatId,"getChatAdministrators"),e)}getChatMembersCount(...e){return this.getChatMemberCount(...e)}getChatMemberCount(e){return this.api.getChatMemberCount(p(this.chatId,"getChatMemberCount"),e)}getAuthor(e){return this.api.getChatMember(p(this.chatId,"getAuthor"),p(this.from,"getAuthor").id,e)}getChatMember(e,t){return this.api.getChatMember(p(this.chatId,"getChatMember"),e,t)}setChatStickerSet(e,t){return this.api.setChatStickerSet(p(this.chatId,"setChatStickerSet"),e,t)}deleteChatStickerSet(e){return this.api.deleteChatStickerSet(p(this.chatId,"deleteChatStickerSet"),e)}createForumTopic(e,t,n){return this.api.createForumTopic(p(this.chatId,"createForumTopic"),e,t,n)}editForumTopic(e,t){const n=p(this.msg,"editForumTopic"),i=p(n.message_thread_id,"editForumTopic");return this.api.editForumTopic(n.chat.id,i,e,t)}closeForumTopic(e){const t=p(this.msg,"closeForumTopic"),n=p(t.message_thread_id,"closeForumTopic");return this.api.closeForumTopic(t.chat.id,n,e)}reopenForumTopic(e){const t=p(this.msg,"reopenForumTopic"),n=p(t.message_thread_id,"reopenForumTopic");return this.api.reopenForumTopic(t.chat.id,n,e)}deleteForumTopic(e){const t=p(this.msg,"deleteForumTopic"),n=p(t.message_thread_id,"deleteForumTopic");return this.api.deleteForumTopic(t.chat.id,n,e)}unpinAllForumTopicMessages(e){const t=p(this.msg,"unpinAllForumTopicMessages"),n=p(t.message_thread_id,"unpinAllForumTopicMessages");return this.api.unpinAllForumTopicMessages(t.chat.id,n,e)}editGeneralForumTopic(e,t){return this.api.editGeneralForumTopic(p(this.chatId,"editGeneralForumTopic"),e,t)}closeGeneralForumTopic(e){return this.api.closeGeneralForumTopic(p(this.chatId,"closeGeneralForumTopic"),e)}reopenGeneralForumTopic(e){return this.api.reopenGeneralForumTopic(p(this.chatId,"reopenGeneralForumTopic"),e)}hideGeneralForumTopic(e){return this.api.hideGeneralForumTopic(p(this.chatId,"hideGeneralForumTopic"),e)}unhideGeneralForumTopic(e){return this.api.unhideGeneralForumTopic(p(this.chatId,"unhideGeneralForumTopic"),e)}unpinAllGeneralForumTopicMessages(e){return this.api.unpinAllGeneralForumTopicMessages(p(this.chatId,"unpinAllGeneralForumTopicMessages"),e)}answerCallbackQuery(e,t){return this.api.answerCallbackQuery(p(this.callbackQuery,"answerCallbackQuery").id,typeof e=="string"?{text:e}:e,t)}setChatMenuButton(e,t){return this.api.setChatMenuButton(e,t)}getChatMenuButton(e,t){return this.api.getChatMenuButton(e,t)}setMyDefaultAdministratorRights(e,t){return this.api.setMyDefaultAdministratorRights(e,t)}getMyDefaultAdministratorRights(e,t){return this.api.getMyDefaultAdministratorRights(e,t)}editMessageText(e,t,n){var s,a,c;const i=this.inlineMessageId;return i!==void 0?this.api.editMessageTextInline(i,e,t):this.api.editMessageText(p(this.chatId,"editMessageText"),p(((s=this.msg)==null?void 0:s.message_id)??((a=this.messageReaction)==null?void 0:a.message_id)??((c=this.messageReactionCount)==null?void 0:c.message_id),"editMessageText"),e,t,n)}editMessageCaption(e,t){var i,s,a;const n=this.inlineMessageId;return n!==void 0?this.api.editMessageCaptionInline(n,e):this.api.editMessageCaption(p(this.chatId,"editMessageCaption"),p(((i=this.msg)==null?void 0:i.message_id)??((s=this.messageReaction)==null?void 0:s.message_id)??((a=this.messageReactionCount)==null?void 0:a.message_id),"editMessageCaption"),e,t)}editMessageMedia(e,t,n){var s,a,c;const i=this.inlineMessageId;return i!==void 0?this.api.editMessageMediaInline(i,e,t):this.api.editMessageMedia(p(this.chatId,"editMessageMedia"),p(((s=this.msg)==null?void 0:s.message_id)??((a=this.messageReaction)==null?void 0:a.message_id)??((c=this.messageReactionCount)==null?void 0:c.message_id),"editMessageMedia"),e,t,n)}editMessageReplyMarkup(e,t){var i,s,a;const n=this.inlineMessageId;return n!==void 0?this.api.editMessageReplyMarkupInline(n,e):this.api.editMessageReplyMarkup(p(this.chatId,"editMessageReplyMarkup"),p(((i=this.msg)==null?void 0:i.message_id)??((s=this.messageReaction)==null?void 0:s.message_id)??((a=this.messageReactionCount)==null?void 0:a.message_id),"editMessageReplyMarkup"),e,t)}stopPoll(e,t){var n,i,s;return this.api.stopPoll(p(this.chatId,"stopPoll"),p(((n=this.msg)==null?void 0:n.message_id)??((i=this.messageReaction)==null?void 0:i.message_id)??((s=this.messageReactionCount)==null?void 0:s.message_id),"stopPoll"),e,t)}deleteMessage(e){var t,n,i;return this.api.deleteMessage(p(this.chatId,"deleteMessage"),p(((t=this.msg)==null?void 0:t.message_id)??((n=this.messageReaction)==null?void 0:n.message_id)??((i=this.messageReactionCount)==null?void 0:i.message_id),"deleteMessage"),e)}deleteMessages(e,t){return this.api.deleteMessages(p(this.chatId,"deleteMessages"),e,t)}replyWithSticker(e,t,n){return this.api.sendSticker(p(this.chatId,"sendSticker"),e,{business_connection_id:this.businessConnectionId,...t},n)}getCustomEmojiStickers(e){var t;return this.api.getCustomEmojiStickers((((t=this.msg)==null?void 0:t.entities)??[]).filter(n=>n.type==="custom_emoji").map(n=>n.custom_emoji_id),e)}replyWithGift(e,t,n){return this.api.sendGift(p(this.from,"sendGift").id,e,t,n)}answerInlineQuery(e,t,n){return this.api.answerInlineQuery(p(this.inlineQuery,"answerInlineQuery").id,e,t,n)}savePreparedInlineMessage(e,t,n){return this.api.savePreparedInlineMessage(p(this.from,"savePreparedInlineMessage").id,e,t,n)}replyWithInvoice(e,t,n,i,s,a,c){return this.api.sendInvoice(p(this.chatId,"sendInvoice"),e,t,n,i,s,a,c)}answerShippingQuery(e,t,n){return this.api.answerShippingQuery(p(this.shippingQuery,"answerShippingQuery").id,e,t,n)}answerPreCheckoutQuery(e,t,n){return this.api.answerPreCheckoutQuery(p(this.preCheckoutQuery,"answerPreCheckoutQuery").id,e,typeof t=="string"?{error_message:t}:t,n)}refundStarPayment(e){var t;return this.api.refundStarPayment(p(this.from,"refundStarPayment").id,p((t=this.msg)==null?void 0:t.successful_payment,"refundStarPayment").telegram_payment_charge_id,e)}editUserStarSubscription(e,t,n){return this.api.editUserStarSubscription(p(this.from,"editUserStarSubscription").id,e,t,n)}verifyUser(e,t){return this.api.verifyUser(p(this.from,"verifyUser").id,e,t)}verifyChat(e,t){return this.api.verifyChat(p(this.chatId,"verifyChat"),e,t)}removeUserVerification(e){return this.api.removeUserVerification(p(this.from,"removeUserVerification").id,e)}removeChatVerification(e){return this.api.removeChatVerification(p(this.chatId,"removeChatVerification"),e)}setPassportDataErrors(e,t){return this.api.setPassportDataErrors(p(this.from,"setPassportDataErrors").id,e,t)}replyWithGame(e,t,n){return this.api.sendGame(p(this.chatId,"sendGame"),e,{business_connection_id:this.businessConnectionId,...t},n)}};P(oe,"has",ke);let le=oe;function p(r,e){if(r===void 0)throw new Error(`Missing information for API call to ${e}`);return r}function Je(r){return Zt(r).map(e=>typeof e=="string"?t=>t===e?e:null:t=>t.match(e))}function Ze(r,e,t){for(const n of t){const i=n(e);if(i)return r.match=i,!0}return!1}function Zt(r){return Array.isArray(r)?r:[r]}class Cr extends Error{constructor(t,n){super(Ma(t));P(this,"error");P(this,"ctx");this.error=t,this.ctx=n,this.name="BotError",t instanceof Error&&(this.stack=t.stack)}}function Ma(r){let e;if(r instanceof Error)e=`${r.name} in middleware: ${r.message}`;else{const t=typeof r;switch(e=`Non-error value of type ${t} thrown in middleware`,t){case"bigint":case"boolean":case"number":case"symbol":e+=`: ${r}`;break;case"string":e+=`: ${String(r).substring(0,50)}`;break;default:e+="!";break}}return e}function Tt(r){return typeof r=="function"?r:(e,t)=>r.middleware()(e,t)}function wn(r,e){return async(t,n)=>{let i=!1;await r(t,async()=>{if(i)throw new Error("`next` already called before!");i=!0,await e(t,n)})}}function cr(r,e){return e()}const Sa=()=>Promise.resolve();async function hi(r,e){await r(e,Sa)}class Xe{constructor(...e){P(this,"handler");this.handler=e.length===0?cr:e.map(Tt).reduce(wn)}middleware(){return this.handler}use(...e){const t=new Xe(...e);return this.handler=wn(this.handler,Tt(t)),t}on(e,...t){return this.filter(le.has.filterQuery(e),...t)}hears(e,...t){return this.filter(le.has.text(e),...t)}command(e,...t){return this.filter(le.has.command(e),...t)}reaction(e,...t){return this.filter(le.has.reaction(e),...t)}chatType(e,...t){return this.filter(le.has.chatType(e),...t)}callbackQuery(e,...t){return this.filter(le.has.callbackQuery(e),...t)}gameQuery(e,...t){return this.filter(le.has.gameQuery(e),...t)}inlineQuery(e,...t){return this.filter(le.has.inlineQuery(e),...t)}chosenInlineResult(e,...t){return this.filter(le.has.chosenInlineResult(e),...t)}preCheckoutQuery(e,...t){return this.filter(le.has.preCheckoutQuery(e),...t)}shippingQuery(e,...t){return this.filter(le.has.shippingQuery(e),...t)}filter(e,...t){const n=new Xe(...t);return this.branch(e,n,cr),n}drop(e,...t){return this.filter(async n=>!await e(n),...t)}fork(...e){const t=new Xe(...e),n=Tt(t);return this.use((i,s)=>Promise.all([s(),hi(n,i)])),t}lazy(e){return this.use(async(t,n)=>{const i=await e(t),s=Array.isArray(i)?i:[i];await Tt(new Xe(...s))(t,n)})}route(e,t,n=cr){return this.lazy(async i=>{const s=await e(i);return(s===void 0||!t[s]?n:t[s])??[]})}branch(e,t,n){return this.lazy(async i=>await e(i)?t:n)}errorBoundary(e,...t){const n=new Xe(...t),i=Tt(n);return this.use(async(s,a)=>{let c=!1;const u=()=>(c=!0,Promise.resolve());try{await i(s,u)}catch(d){c=!1,await e(new Cr(d,s),u)}c&&await a()}),n}}var gt=1e3,vt=gt*60,_t=vt*60,nt=_t*24,Ta=nt*7,Ia=nt*365.25,Ea=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return Aa(r);if(t==="number"&&isFinite(r))return e.long?Pa(r):Fa(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function Aa(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*Ia;case"weeks":case"week":case"w":return t*Ta;case"days":case"day":case"d":return t*nt;case"hours":case"hour":case"hrs":case"hr":case"h":return t*_t;case"minutes":case"minute":case"mins":case"min":case"m":return t*vt;case"seconds":case"second":case"secs":case"sec":case"s":return t*gt;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function Fa(r){var e=Math.abs(r);return e>=nt?Math.round(r/nt)+"d":e>=_t?Math.round(r/_t)+"h":e>=vt?Math.round(r/vt)+"m":e>=gt?Math.round(r/gt)+"s":r+"ms"}function Pa(r){var e=Math.abs(r);return e>=nt?Bt(r,e,nt,"day"):e>=_t?Bt(r,e,_t,"hour"):e>=vt?Bt(r,e,vt,"minute"):e>=gt?Bt(r,e,gt,"second"):r+" ms"}function Bt(r,e,t,n){var i=e>=t*1.5;return Math.round(r/t)+" "+n+(i?"s":"")}function fi(){throw new Error("setTimeout has not been defined")}function pi(){throw new Error("clearTimeout has not been defined")}var Be=fi,Qe=pi,ht;typeof window<"u"?ht=window:typeof self<"u"?ht=self:ht={};typeof ht.setTimeout=="function"&&(Be=setTimeout);typeof ht.clearTimeout=="function"&&(Qe=clearTimeout);function mi(r){if(Be===setTimeout)return setTimeout(r,0);if((Be===fi||!Be)&&setTimeout)return Be=setTimeout,setTimeout(r,0);try{return Be(r,0)}catch{try{return Be.call(null,r,0)}catch{return Be.call(this,r,0)}}}function Ra(r){if(Qe===clearTimeout)return clearTimeout(r);if((Qe===pi||!Qe)&&clearTimeout)return Qe=clearTimeout,clearTimeout(r);try{return Qe(r)}catch{try{return Qe.call(null,r)}catch{return Qe.call(this,r)}}}var Le=[],ft=!1,tt,Wt=-1;function $a(){!ft||!tt||(ft=!1,tt.length?Le=tt.concat(Le):Wt=-1,Le.length&&gi())}function gi(){if(!ft){var r=mi($a);ft=!0;for(var e=Le.length;e;){for(tt=Le,Le=[];++Wt<e;)tt&&tt[Wt].run();Wt=-1,e=Le.length}tt=null,ft=!1,Ra(r)}}function La(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Le.push(new vi(r,e)),Le.length===1&&!ft&&mi(gi)}function vi(r,e){this.fun=r,this.array=e}vi.prototype.run=function(){this.fun.apply(null,this.array)};var Na="browser",ja="browser",Da=!0,Ua=[],Oa="",Ba={},Qa={},qa={};function st(){}var Ga=st,Wa=st,Va=st,za=st,Ha=st,Ya=st,Ka=st;function Ja(r){throw new Error("process.binding is not supported")}function Za(){return"/"}function Xa(r){throw new Error("process.chdir is not supported")}function eo(){return 0}var ut=ht.performance||{},to=ut.now||ut.mozNow||ut.msNow||ut.oNow||ut.webkitNow||function(){return new Date().getTime()};function ro(r){var e=to.call(ut)*.001,t=Math.floor(e),n=Math.floor(e%1*1e9);return r&&(t=t-r[0],n=n-r[1],n<0&&(t--,n+=1e9)),[t,n]}var no=new Date;function io(){var r=new Date,e=r-no;return e/1e3}var dr={nextTick:La,title:Na,browser:Da,env:{NODE_ENV:"production"},argv:Ua,version:Oa,versions:Ba,on:Ga,addListener:Wa,once:Va,off:za,removeListener:Ha,removeAllListeners:Ya,emit:Ka,binding:Ja,cwd:Za,chdir:Xa,umask:eo,hrtime:ro,platform:ja,release:Qa,config:qa,uptime:io};function so(r,e,t){return t={path:e,exports:{},require:function(n,i){return ao(n,i??t.path)}},r(t,t.exports),t.exports}function ao(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}function oo(r){t.debug=t,t.default=t,t.coerce=u,t.disable=s,t.enable=i,t.enabled=a,t.humanize=Ea,t.destroy=d,Object.keys(r).forEach(o=>{t[o]=r[o]}),t.names=[],t.skips=[],t.formatters={};function e(o){let l=0;for(let h=0;h<o.length;h++)l=(l<<5)-l+o.charCodeAt(h),l|=0;return t.colors[Math.abs(l)%t.colors.length]}t.selectColor=e;function t(o){let l,h=null,f,m;function g(...w){if(!g.enabled)return;const k=g,C=Number(new Date),S=C-(l||C);k.diff=S,k.prev=l,k.curr=C,l=C,w[0]=t.coerce(w[0]),typeof w[0]!="string"&&w.unshift("%O");let T=0;w[0]=w[0].replace(/%([a-zA-Z%])/g,(x,F)=>{if(x==="%%")return"%";T++;const E=t.formatters[F];if(typeof E=="function"){const L=w[T];x=E.call(k,L),w.splice(T,1),T--}return x}),t.formatArgs.call(k,w),(k.log||t.log).apply(k,w)}return g.namespace=o,g.useColors=t.useColors(),g.color=t.selectColor(o),g.extend=n,g.destroy=t.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(f!==t.namespaces&&(f=t.namespaces,m=t.enabled(o)),m),set:w=>{h=w}}),typeof t.init=="function"&&t.init(g),g}function n(o,l){const h=t(this.namespace+(typeof l>"u"?":":l)+o);return h.log=this.log,h}function i(o){t.save(o),t.namespaces=o,t.names=[],t.skips=[];let l;const h=(typeof o=="string"?o:"").split(/[\s,]+/),f=h.length;for(l=0;l<f;l++)h[l]&&(o=h[l].replace(/\*/g,".*?"),o[0]==="-"?t.skips.push(new RegExp("^"+o.slice(1)+"$")):t.names.push(new RegExp("^"+o+"$")))}function s(){const o=[...t.names.map(c),...t.skips.map(c).map(l=>"-"+l)].join(",");return t.enable(""),o}function a(o){if(o[o.length-1]==="*")return!0;let l,h;for(l=0,h=t.skips.length;l<h;l++)if(t.skips[l].test(o))return!1;for(l=0,h=t.names.length;l<h;l++)if(t.names[l].test(o))return!0;return!1}function c(o){return o.toString().substring(2,o.toString().length-2).replace(/\.\*\?$/,"*")}function u(o){return o instanceof Error?o.stack||o.message:o}function d(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var lo=oo,ie=so(function(r,e){e.formatArgs=n,e.save=i,e.load=s,e.useColors=t,e.storage=a(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const d="color: "+this.color;u.splice(1,0,d,"color: inherit");let o=0,l=0;u[0].replace(/%[a-zA-Z%]/g,h=>{h!=="%%"&&(o++,h==="%c"&&(l=o))}),u.splice(l,0,d)}e.log=console.debug||console.log||(()=>{});function i(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function s(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof dr<"u"&&"env"in dr&&(u=dr.env.DEBUG),u}function a(){try{return localStorage}catch{}}r.exports=lo(e);const{formatters:c}=r.exports;c.j=function(u){try{return JSON.stringify(u)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}});ie.colors;ie.destroy;ie.formatArgs;ie.load;ie.log;ie.save;ie.storage;ie.useColors;const uo=r=>{const e=r[Symbol.asyncIterator]();return new ReadableStream({async pull(t){const n=await e.next();n.done?t.close():t.enqueue(n.value)}})},co=r=>({}),yn=ie("grammy:warn");class qr extends Error{constructor(t,n,i,s){super(`${t} (${n.error_code}: ${n.description})`);P(this,"method");P(this,"payload");P(this,"ok");P(this,"error_code");P(this,"description");P(this,"parameters");this.method=i,this.payload=s,this.ok=!1,this.name="GrammyError",this.error_code=n.error_code,this.description=n.description,this.parameters=n.parameters??{}}}function ho(r,e,t){switch(r.error_code){case 401:yn("Error 401 means that your bot token is wrong, talk to https://t.me/BotFather to check it.");break;case 409:yn("Error 409 means that you are running your bot several times on long polling. Consider revoking the bot token if you believe that no other instance is running.");break}return new qr(`Call to '${e}' failed!`,r,e,t)}class _i extends Error{constructor(t,n){super(t);P(this,"error");this.error=n,this.name="HttpError"}}function fo(r){return typeof r=="object"&&r!==null&&"status"in r&&"statusText"in r}function po(r,e){return t=>{let n=`Network request for '${r}' failed!`;throw fo(t)&&(n+=` (${t.status}: ${t.statusText})`),e&&t instanceof Error&&(n+=` ${t.message}`),new _i(n,t)}}const mo=(()=>{var t,n,i;const{Deno:r}=globalThis;if(typeof((t=r==null?void 0:r.build)==null?void 0:t.os)=="string")return r.build.os;const{navigator:e}=globalThis;return(i=(n=e==null?void 0:e.appVersion)==null?void 0:n.includes)!=null&&i.call(n,"Win")?"windows":"linux"})(),go=mo==="windows";function vo(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function wi(r,e){if(e.length>=r.length)return r;const t=r.length-e.length;for(let n=e.length-1;n>=0;--n)if(r.charCodeAt(t+n)!==e.charCodeAt(n))return r;return r.slice(0,-e.length)}function yi(r,e,t=0){let n=!1,i=r.length;for(let s=r.length-1;s>=t;--s)if(e(r.charCodeAt(s))){if(n){t=s+1;break}}else n||(n=!0,i=s+1);return r.slice(t,i)}function bi(r,e){if(vo(r),r.length===0)return r;if(typeof e!="string")throw new TypeError(`Suffix must be a string. Received ${JSON.stringify(e)}`)}function Ci(r,e){if(r.length<=1)return r;let t=r.length;for(let n=r.length-1;n>0&&e(r.charCodeAt(n));n--)t=n;return r.slice(0,t)}function bn(r){return r===47}function _o(r,e=""){bi(r,e);const t=yi(r,bn),n=Ci(t,bn);return e?wi(n,e):n}function Cn(r){return r===47||r===92}function wo(r){return r>=97&&r<=122||r>=65&&r<=90}function yo(r,e=""){bi(r,e);let t=0;if(r.length>=2){const s=r.charCodeAt(0);wo(s)&&r.charCodeAt(1)===58&&(t=2)}const n=yi(r,Cn,t),i=Ci(n,Cn);return e?wi(i,e):i}function Qt(r,e=""){return go?yo(r,e):_o(r,e)}class xr{constructor(e,t){P(this,"consumed",!1);P(this,"fileData");P(this,"filename");this.fileData=e,t??(t=this.guessFilename(e)),this.filename=t}guessFilename(e){if(typeof e=="string")return Qt(e);if(typeof e=="object"){if("url"in e)return Qt(e.url);if(e instanceof URL)return Qt(e.pathname)||Qt(e.hostname)}}toRaw(){if(this.consumed)throw new Error("Cannot reuse InputFile data source!");const e=this.fileData;return e instanceof Blob?e.stream():e instanceof URL?xn(e):"url"in e?xn(e.url):(e instanceof Uint8Array||(this.consumed=!0),e)}}async function*xn(r){const{body:e}=await fetch(r);if(e===null)throw new Error(`Download failed, no response body from '${r}'`);yield*e}function kr(r){return r instanceof xr||typeof r=="object"&&r!==null&&Object.values(r).some(e=>Array.isArray(e)?e.some(kr):e instanceof xr||kr(e))}function xi(r){return JSON.stringify(r,(e,t)=>t??void 0)}function kn(r){return{method:"POST",headers:{"content-type":"application/json",connection:"keep-alive"},body:xi(r)}}async function*bo(r,e){try{yield*r}catch(t){e(t)}}function Co(r,e){const t=xo(),n=ko(r,t),i=bo(n,e),s=uo(i);return{method:"POST",headers:{"content-type":`multipart/form-data; boundary=${t}`,connection:"keep-alive"},body:s}}function xo(){return"----------"+ki(32)}function ki(r=16){return Array.from(Array(r)).map(()=>Math.random().toString(36)[2]||0).join("")}const Ft=new TextEncoder;async function*ko(r,e){const t=Mr(r);yield Ft.encode(`--${e}\r
`);const n=Ft.encode(`\r
--${e}\r
`);let i=!0;for(const[s,a]of Object.entries(r))a!=null&&(i||(yield n),yield Mo(s,typeof a=="object"?xi(a):a),i=!1);for(const{id:s,origin:a,file:c}of t)i||(yield n),yield*So(s,a,c),i=!1;yield Ft.encode(`\r
--${e}--\r
`)}function Mr(r){return typeof r!="object"||r===null?[]:Object.entries(r).flatMap(([e,t])=>{if(Array.isArray(t))return t.flatMap(n=>Mr(n));if(t instanceof xr){const n=ki();Object.assign(r,{[e]:`attach://${n}`});const i=e==="media"&&"type"in r&&typeof r.type=="string"?r.type:e;return{id:n,origin:i,file:t}}else return Mr(t)})}function Mo(r,e){return Ft.encode(`content-disposition:form-data;name="${r}"\r
\r
${e}`)}async function*So(r,e,t){const n=t.filename||`${e}.${To(e)}`;if(n.includes("\r")||n.includes(`
`))throw new Error(`File paths cannot contain carriage-return (\\r) or newline (\\n) characters! Filename for property '${e}' was:
"""
${n}
"""`);yield Ft.encode(`content-disposition:form-data;name="${r}";filename=${n}\r
content-type:application/octet-stream\r
\r
`);const i=await t.toRaw();i instanceof Uint8Array?yield i:yield*i}function To(r){switch(r){case"certificate":return"pem";case"photo":case"thumbnail":return"jpg";case"voice":return"ogg";case"audio":return"mp3";case"animation":case"video":case"video_note":return"mp4";case"sticker":return"webp";default:return"dat"}}const Io=ie("grammy:core");function Eo(r,e){return(t,n,i)=>e(r,t,n,i)}class Ao{constructor(e,t={},n={}){P(this,"token");P(this,"webhookReplyEnvelope");P(this,"options");P(this,"fetch");P(this,"hasUsedWebhookReply");P(this,"installedTransformers");P(this,"call");this.token=e,this.webhookReplyEnvelope=n,this.hasUsedWebhookReply=!1,this.installedTransformers=[],this.call=async(u,d,o)=>{const l=d??{};Io(`Calling ${u}`),o!==void 0&&jo(u,l,o);const h=this.options,f=kr(l);if(this.webhookReplyEnvelope.send!==void 0&&!this.hasUsedWebhookReply&&!f&&h.canUseWebhookReply(u)){this.hasUsedWebhookReply=!0;const F=kn({...l,method:u});return await this.webhookReplyEnvelope.send(F.body),{ok:!0,result:!0}}const m=No(o),g=$o(m,h.timeoutSeconds,u),w=Lo(m),k=h.buildUrl(h.apiRoot,this.token,u,h.environment),C=f?Co(l,F=>w.catch(F)):kn(l),S=m.signal,T={...h.baseFetchConfig,signal:S,...C},x=[this.fetch(k instanceof URL?k.href:k,T).catch(po(u,h.sensitiveLogs)),w.promise,g.promise];try{return await(await Promise.race(x)).json()}finally{g.handle!==void 0&&clearTimeout(g.handle)}};const i=t.apiRoot??"https://api.telegram.org",s=t.environment??"prod",{fetch:a}=t,c=a??fetch;if(this.options={apiRoot:i,environment:s,buildUrl:t.buildUrl??Po,timeoutSeconds:t.timeoutSeconds??500,baseFetchConfig:{...co(),...t.baseFetchConfig},canUseWebhookReply:t.canUseWebhookReply??(()=>!1),sensitiveLogs:t.sensitiveLogs??!1,fetch:(...u)=>c(...u)},this.fetch=this.options.fetch,this.options.apiRoot.endsWith("/"))throw new Error(`Remove the trailing '/' from the 'apiRoot' option (use '${this.options.apiRoot.substring(0,this.options.apiRoot.length-1)}' instead of '${this.options.apiRoot}')`)}use(...e){return this.call=e.reduce(Eo,this.call),this.installedTransformers.push(...e),this}async callApi(e,t,n){const i=await this.call(e,t,n);if(i.ok)return i.result;throw ho(i,e,t)}}function Fo(r,e,t){const n=new Ao(r,e,t),i={get(u,d){return d==="toJSON"?"__internal":d==="getMe"||d==="getWebhookInfo"||d==="getForumTopicIconStickers"||d==="logOut"||d==="close"?n.callApi.bind(n,d,{}):n.callApi.bind(n,d)},...Ro},s=new Proxy({},i),a=n.installedTransformers,c={raw:s,installedTransformers:a,use:(...u)=>(n.use(...u),c)};return c}const Po=(r,e,t,n)=>`${r}/bot${e}/${n==="test"?"test/":""}${t}`,Ro={set(){return!1},defineProperty(){return!1},deleteProperty(){return!1},ownKeys(){return[]}};function $o(r,e,t){let n;return{promise:new Promise((s,a)=>{n=setTimeout(()=>{const c=`Request to '${t}' timed out after ${e} seconds`;a(new Error(c)),r.abort()},1e3*e)}),handle:n}}function Lo(r){let e=n=>{throw n};return{promise:new Promise((n,i)=>{e=s=>{i(s),r.abort()}}),catch:e}}function No(r){const e=new AbortController;if(r===void 0)return e;const t=r;function n(){e.abort(),t.removeEventListener("abort",n)}return t.aborted?n():t.addEventListener("abort",n),{abort:n,signal:e.signal}}function jo(r,e,t){if(typeof(t==null?void 0:t.addEventListener)=="function")return;let n=JSON.stringify(e);n.length>20&&(n=n.substring(0,16)+" ...");let i=JSON.stringify(t);throw i.length>20&&(i=i.substring(0,16)+" ..."),new Error(`Incorrect abort signal instance found! You passed two payloads to '${r}' but you should merge the second one containing '${i}' into the first one containing '${n}'! If you are using context shortcuts, you may want to use a method on 'ctx.api' instead.

If you want to prevent such mistakes in the future, consider using TypeScript. https://www.typescriptlang.org/`)}class Mn{constructor(e,t,n){P(this,"token");P(this,"options");P(this,"raw");P(this,"config");this.token=e,this.options=t;const{raw:i,use:s,installedTransformers:a}=Fo(e,t,n);this.raw=i,this.config={use:s,installedTransformers:()=>a.slice()}}getUpdates(e,t){return this.raw.getUpdates({...e},t)}setWebhook(e,t,n){return this.raw.setWebhook({url:e,...t},n)}deleteWebhook(e,t){return this.raw.deleteWebhook({...e},t)}getWebhookInfo(e){return this.raw.getWebhookInfo(e)}getMe(e){return this.raw.getMe(e)}logOut(e){return this.raw.logOut(e)}close(e){return this.raw.close(e)}sendMessage(e,t,n,i){return this.raw.sendMessage({chat_id:e,text:t,...n},i)}forwardMessage(e,t,n,i,s){return this.raw.forwardMessage({chat_id:e,from_chat_id:t,message_id:n,...i},s)}forwardMessages(e,t,n,i,s){return this.raw.forwardMessages({chat_id:e,from_chat_id:t,message_ids:n,...i},s)}copyMessage(e,t,n,i,s){return this.raw.copyMessage({chat_id:e,from_chat_id:t,message_id:n,...i},s)}copyMessages(e,t,n,i,s){return this.raw.copyMessages({chat_id:e,from_chat_id:t,message_ids:n,...i},s)}sendPhoto(e,t,n,i){return this.raw.sendPhoto({chat_id:e,photo:t,...n},i)}sendAudio(e,t,n,i){return this.raw.sendAudio({chat_id:e,audio:t,...n},i)}sendDocument(e,t,n,i){return this.raw.sendDocument({chat_id:e,document:t,...n},i)}sendVideo(e,t,n,i){return this.raw.sendVideo({chat_id:e,video:t,...n},i)}sendAnimation(e,t,n,i){return this.raw.sendAnimation({chat_id:e,animation:t,...n},i)}sendVoice(e,t,n,i){return this.raw.sendVoice({chat_id:e,voice:t,...n},i)}sendVideoNote(e,t,n,i){return this.raw.sendVideoNote({chat_id:e,video_note:t,...n},i)}sendMediaGroup(e,t,n,i){return this.raw.sendMediaGroup({chat_id:e,media:t,...n},i)}sendLocation(e,t,n,i,s){return this.raw.sendLocation({chat_id:e,latitude:t,longitude:n,...i},s)}editMessageLiveLocation(e,t,n,i,s,a){return this.raw.editMessageLiveLocation({chat_id:e,message_id:t,latitude:n,longitude:i,...s},a)}editMessageLiveLocationInline(e,t,n,i,s){return this.raw.editMessageLiveLocation({inline_message_id:e,latitude:t,longitude:n,...i},s)}stopMessageLiveLocation(e,t,n,i){return this.raw.stopMessageLiveLocation({chat_id:e,message_id:t,...n},i)}stopMessageLiveLocationInline(e,t,n){return this.raw.stopMessageLiveLocation({inline_message_id:e,...t},n)}sendPaidMedia(e,t,n,i,s){return this.raw.sendPaidMedia({chat_id:e,star_count:t,media:n,...i},s)}sendVenue(e,t,n,i,s,a,c){return this.raw.sendVenue({chat_id:e,latitude:t,longitude:n,title:i,address:s,...a},c)}sendContact(e,t,n,i,s){return this.raw.sendContact({chat_id:e,phone_number:t,first_name:n,...i},s)}sendPoll(e,t,n,i,s){return this.raw.sendPoll({chat_id:e,question:t,options:n,...i},s)}sendDice(e,t,n,i){return this.raw.sendDice({chat_id:e,emoji:t,...n},i)}setMessageReaction(e,t,n,i,s){return this.raw.setMessageReaction({chat_id:e,message_id:t,reaction:n,...i},s)}sendChatAction(e,t,n,i){return this.raw.sendChatAction({chat_id:e,action:t,...n},i)}getUserProfilePhotos(e,t,n){return this.raw.getUserProfilePhotos({user_id:e,...t},n)}setUserEmojiStatus(e,t,n){return this.raw.setUserEmojiStatus({user_id:e,...t},n)}getUserChatBoosts(e,t,n){return this.raw.getUserChatBoosts({chat_id:e,user_id:t},n)}getBusinessConnection(e,t){return this.raw.getBusinessConnection({business_connection_id:e},t)}getFile(e,t){return this.raw.getFile({file_id:e},t)}kickChatMember(...e){return this.banChatMember(...e)}banChatMember(e,t,n,i){return this.raw.banChatMember({chat_id:e,user_id:t,...n},i)}unbanChatMember(e,t,n,i){return this.raw.unbanChatMember({chat_id:e,user_id:t,...n},i)}restrictChatMember(e,t,n,i,s){return this.raw.restrictChatMember({chat_id:e,user_id:t,permissions:n,...i},s)}promoteChatMember(e,t,n,i){return this.raw.promoteChatMember({chat_id:e,user_id:t,...n},i)}setChatAdministratorCustomTitle(e,t,n,i){return this.raw.setChatAdministratorCustomTitle({chat_id:e,user_id:t,custom_title:n},i)}banChatSenderChat(e,t,n){return this.raw.banChatSenderChat({chat_id:e,sender_chat_id:t},n)}unbanChatSenderChat(e,t,n){return this.raw.unbanChatSenderChat({chat_id:e,sender_chat_id:t},n)}setChatPermissions(e,t,n,i){return this.raw.setChatPermissions({chat_id:e,permissions:t,...n},i)}exportChatInviteLink(e,t){return this.raw.exportChatInviteLink({chat_id:e},t)}createChatInviteLink(e,t,n){return this.raw.createChatInviteLink({chat_id:e,...t},n)}editChatInviteLink(e,t,n,i){return this.raw.editChatInviteLink({chat_id:e,invite_link:t,...n},i)}createChatSubscriptionInviteLink(e,t,n,i,s){return this.raw.createChatSubscriptionInviteLink({chat_id:e,subscription_period:t,subscription_price:n,...i},s)}editChatSubscriptionInviteLink(e,t,n,i){return this.raw.editChatSubscriptionInviteLink({chat_id:e,invite_link:t,...n},i)}revokeChatInviteLink(e,t,n){return this.raw.revokeChatInviteLink({chat_id:e,invite_link:t},n)}approveChatJoinRequest(e,t,n){return this.raw.approveChatJoinRequest({chat_id:e,user_id:t},n)}declineChatJoinRequest(e,t,n){return this.raw.declineChatJoinRequest({chat_id:e,user_id:t},n)}setChatPhoto(e,t,n){return this.raw.setChatPhoto({chat_id:e,photo:t},n)}deleteChatPhoto(e,t){return this.raw.deleteChatPhoto({chat_id:e},t)}setChatTitle(e,t,n){return this.raw.setChatTitle({chat_id:e,title:t},n)}setChatDescription(e,t,n){return this.raw.setChatDescription({chat_id:e,description:t},n)}pinChatMessage(e,t,n,i){return this.raw.pinChatMessage({chat_id:e,message_id:t,...n},i)}unpinChatMessage(e,t,n){return this.raw.unpinChatMessage({chat_id:e,message_id:t},n)}unpinAllChatMessages(e,t){return this.raw.unpinAllChatMessages({chat_id:e},t)}leaveChat(e,t){return this.raw.leaveChat({chat_id:e},t)}getChat(e,t){return this.raw.getChat({chat_id:e},t)}getChatAdministrators(e,t){return this.raw.getChatAdministrators({chat_id:e},t)}getChatMembersCount(...e){return this.getChatMemberCount(...e)}getChatMemberCount(e,t){return this.raw.getChatMemberCount({chat_id:e},t)}getChatMember(e,t,n){return this.raw.getChatMember({chat_id:e,user_id:t},n)}setChatStickerSet(e,t,n){return this.raw.setChatStickerSet({chat_id:e,sticker_set_name:t},n)}deleteChatStickerSet(e,t){return this.raw.deleteChatStickerSet({chat_id:e},t)}getForumTopicIconStickers(e){return this.raw.getForumTopicIconStickers(e)}createForumTopic(e,t,n,i){return this.raw.createForumTopic({chat_id:e,name:t,...n},i)}editForumTopic(e,t,n,i){return this.raw.editForumTopic({chat_id:e,message_thread_id:t,...n},i)}closeForumTopic(e,t,n){return this.raw.closeForumTopic({chat_id:e,message_thread_id:t},n)}reopenForumTopic(e,t,n){return this.raw.reopenForumTopic({chat_id:e,message_thread_id:t},n)}deleteForumTopic(e,t,n){return this.raw.deleteForumTopic({chat_id:e,message_thread_id:t},n)}unpinAllForumTopicMessages(e,t,n){return this.raw.unpinAllForumTopicMessages({chat_id:e,message_thread_id:t},n)}editGeneralForumTopic(e,t,n){return this.raw.editGeneralForumTopic({chat_id:e,name:t},n)}closeGeneralForumTopic(e,t){return this.raw.closeGeneralForumTopic({chat_id:e},t)}reopenGeneralForumTopic(e,t){return this.raw.reopenGeneralForumTopic({chat_id:e},t)}hideGeneralForumTopic(e,t){return this.raw.hideGeneralForumTopic({chat_id:e},t)}unhideGeneralForumTopic(e,t){return this.raw.unhideGeneralForumTopic({chat_id:e},t)}unpinAllGeneralForumTopicMessages(e,t){return this.raw.unpinAllGeneralForumTopicMessages({chat_id:e},t)}answerCallbackQuery(e,t,n){return this.raw.answerCallbackQuery({callback_query_id:e,...t},n)}setMyName(e,t,n){return this.raw.setMyName({name:e,...t},n)}getMyName(e,t){return this.raw.getMyName(e??{},t)}setMyCommands(e,t,n){return this.raw.setMyCommands({commands:e,...t},n)}deleteMyCommands(e,t){return this.raw.deleteMyCommands({...e},t)}getMyCommands(e,t){return this.raw.getMyCommands({...e},t)}setMyDescription(e,t,n){return this.raw.setMyDescription({description:e,...t},n)}getMyDescription(e,t){return this.raw.getMyDescription({...e},t)}setMyShortDescription(e,t,n){return this.raw.setMyShortDescription({short_description:e,...t},n)}getMyShortDescription(e,t){return this.raw.getMyShortDescription({...e},t)}setChatMenuButton(e,t){return this.raw.setChatMenuButton({...e},t)}getChatMenuButton(e,t){return this.raw.getChatMenuButton({...e},t)}setMyDefaultAdministratorRights(e,t){return this.raw.setMyDefaultAdministratorRights({...e},t)}getMyDefaultAdministratorRights(e,t){return this.raw.getMyDefaultAdministratorRights({...e},t)}editMessageText(e,t,n,i,s){return this.raw.editMessageText({chat_id:e,message_id:t,text:n,...i},s)}editMessageTextInline(e,t,n,i){return this.raw.editMessageText({inline_message_id:e,text:t,...n},i)}editMessageCaption(e,t,n,i){return this.raw.editMessageCaption({chat_id:e,message_id:t,...n},i)}editMessageCaptionInline(e,t,n){return this.raw.editMessageCaption({inline_message_id:e,...t},n)}editMessageMedia(e,t,n,i,s){return this.raw.editMessageMedia({chat_id:e,message_id:t,media:n,...i},s)}editMessageMediaInline(e,t,n,i){return this.raw.editMessageMedia({inline_message_id:e,media:t,...n},i)}editMessageReplyMarkup(e,t,n,i){return this.raw.editMessageReplyMarkup({chat_id:e,message_id:t,...n},i)}editMessageReplyMarkupInline(e,t,n){return this.raw.editMessageReplyMarkup({inline_message_id:e,...t},n)}stopPoll(e,t,n,i){return this.raw.stopPoll({chat_id:e,message_id:t,...n},i)}deleteMessage(e,t,n){return this.raw.deleteMessage({chat_id:e,message_id:t},n)}deleteMessages(e,t,n){return this.raw.deleteMessages({chat_id:e,message_ids:t},n)}sendSticker(e,t,n,i){return this.raw.sendSticker({chat_id:e,sticker:t,...n},i)}getStickerSet(e,t){return this.raw.getStickerSet({name:e},t)}getCustomEmojiStickers(e,t){return this.raw.getCustomEmojiStickers({custom_emoji_ids:e},t)}uploadStickerFile(e,t,n,i){return this.raw.uploadStickerFile({user_id:e,sticker_format:t,sticker:n},i)}createNewStickerSet(e,t,n,i,s,a){return this.raw.createNewStickerSet({user_id:e,name:t,title:n,stickers:i,...s},a)}addStickerToSet(e,t,n,i){return this.raw.addStickerToSet({user_id:e,name:t,sticker:n},i)}setStickerPositionInSet(e,t,n){return this.raw.setStickerPositionInSet({sticker:e,position:t},n)}deleteStickerFromSet(e,t){return this.raw.deleteStickerFromSet({sticker:e},t)}replaceStickerInSet(e,t,n,i,s){return this.raw.replaceStickerInSet({user_id:e,name:t,old_sticker:n,sticker:i},s)}setStickerEmojiList(e,t,n){return this.raw.setStickerEmojiList({sticker:e,emoji_list:t},n)}setStickerKeywords(e,t,n){return this.raw.setStickerKeywords({sticker:e,keywords:t},n)}setStickerMaskPosition(e,t,n){return this.raw.setStickerMaskPosition({sticker:e,mask_position:t},n)}setStickerSetTitle(e,t,n){return this.raw.setStickerSetTitle({name:e,title:t},n)}deleteStickerSet(e,t){return this.raw.deleteStickerSet({name:e},t)}setStickerSetThumbnail(e,t,n,i,s){return this.raw.setStickerSetThumbnail({name:e,user_id:t,thumbnail:n,format:i},s)}setCustomEmojiStickerSetThumbnail(e,t,n){return this.raw.setCustomEmojiStickerSetThumbnail({name:e,custom_emoji_id:t},n)}getAvailableGifts(e){return this.raw.getAvailableGifts(e)}sendGift(e,t,n,i){return this.raw.sendGift({user_id:e,gift_id:t,...n},i)}answerInlineQuery(e,t,n,i){return this.raw.answerInlineQuery({inline_query_id:e,results:t,...n},i)}answerWebAppQuery(e,t,n){return this.raw.answerWebAppQuery({web_app_query_id:e,result:t},n)}savePreparedInlineMessage(e,t,n,i){return this.raw.savePreparedInlineMessage({user_id:e,result:t,...n},i)}sendInvoice(e,t,n,i,s,a,c,u){return this.raw.sendInvoice({chat_id:e,title:t,description:n,payload:i,currency:s,prices:a,...c},u)}createInvoiceLink(e,t,n,i,s,a,c,u){return this.raw.createInvoiceLink({title:e,description:t,payload:n,provider_token:i,currency:s,prices:a,...c},u)}answerShippingQuery(e,t,n,i){return this.raw.answerShippingQuery({shipping_query_id:e,ok:t,...n},i)}answerPreCheckoutQuery(e,t,n,i){return this.raw.answerPreCheckoutQuery({pre_checkout_query_id:e,ok:t,...n},i)}getStarTransactions(e,t){return this.raw.getStarTransactions({...e},t)}refundStarPayment(e,t,n){return this.raw.refundStarPayment({user_id:e,telegram_payment_charge_id:t},n)}editUserStarSubscription(e,t,n,i){return this.raw.editUserStarSubscription({user_id:e,telegram_payment_charge_id:t,is_canceled:n},i)}verifyUser(e,t,n){return this.raw.verifyUser({user_id:e,...t},n)}verifyChat(e,t,n){return this.raw.verifyChat({chat_id:e,...t},n)}removeUserVerification(e,t){return this.raw.removeUserVerification({user_id:e},t)}removeChatVerification(e,t){return this.raw.removeChatVerification({chat_id:e},t)}setPassportDataErrors(e,t,n){return this.raw.setPassportDataErrors({user_id:e,errors:t},n)}sendGame(e,t,n,i){return this.raw.sendGame({chat_id:e,game_short_name:t,...n},i)}setGameScore(e,t,n,i,s,a){return this.raw.setGameScore({chat_id:e,message_id:t,user_id:n,score:i,...s},a)}setGameScoreInline(e,t,n,i,s){return this.raw.setGameScore({inline_message_id:e,user_id:t,score:n,...i},s)}getGameHighScores(e,t,n,i){return this.raw.getGameHighScores({chat_id:e,message_id:t,user_id:n},i)}getGameHighScoresInline(e,t,n){return this.raw.getGameHighScores({inline_message_id:e,user_id:t},n)}}const xe=ie("grammy:bot"),Do=ie("grammy:warn"),ct=ie("grammy:error"),Mi=["message","edited_message","channel_post","edited_channel_post","business_connection","business_message","edited_business_message","deleted_business_messages","inline_query","chosen_inline_result","callback_query","shipping_query","pre_checkout_query","poll","poll_answer","my_chat_member","chat_join_request","chat_boost","removed_chat_boost"];class Uo extends Xe{constructor(t,n){super();P(this,"token");P(this,"pollingRunning");P(this,"pollingAbortController");P(this,"lastTriedUpdateId");P(this,"api");P(this,"me");P(this,"mePromise");P(this,"clientConfig");P(this,"ContextConstructor");P(this,"observedUpdateTypes");P(this,"errorHandler");if(this.token=t,this.pollingRunning=!1,this.lastTriedUpdateId=0,this.observedUpdateTypes=new Set,this.errorHandler=async i=>{var s,a;throw console.error("Error in middleware while handling update",(a=(s=i.ctx)==null?void 0:s.update)==null?void 0:a.update_id,i.error),console.error("No error handler was set!"),console.error("Set your own error handler with `bot.catch = ...`"),this.pollingRunning&&(console.error("Stopping bot"),await this.stop()),i},!t)throw new Error("Empty token!");this.me=n==null?void 0:n.botInfo,this.clientConfig=n==null?void 0:n.client,this.ContextConstructor=(n==null?void 0:n.ContextConstructor)??le,this.api=new Mn(t,this.clientConfig)}set botInfo(t){this.me=t}get botInfo(){if(this.me===void 0)throw new Error("Bot information unavailable! Make sure to call `await bot.init()` before accessing `bot.botInfo`!");return this.me}on(t,...n){for(const[i]of ui(t).flatMap(ci))this.observedUpdateTypes.add(i);return super.on(t,...n)}reaction(t,...n){return this.observedUpdateTypes.add("message_reaction"),super.reaction(t,...n)}isInited(){return this.me!==void 0}async init(t){if(!this.isInited()){xe("Initializing bot"),this.mePromise??(this.mePromise=Sn(()=>this.api.getMe(t),t));let n;try{n=await this.mePromise}finally{this.mePromise=void 0}this.me===void 0?this.me=n:xe("Bot info was set by now, will not overwrite")}xe(`I am ${this.me.username}!`)}async handleUpdates(t){for(const n of t){this.lastTriedUpdateId=n.update_id;try{await this.handleUpdate(n)}catch(i){if(i instanceof Cr)await this.errorHandler(i);else throw console.error("FATAL: grammY unable to handle:",i),i}}}async handleUpdate(t,n){if(this.me===void 0)throw new Error("Bot not initialized! Either call `await bot.init()`, or directly set the `botInfo` option in the `Bot` constructor to specify a known bot info object.");xe(`Processing update ${t.update_id}`);const i=new Mn(this.token,this.clientConfig,n),s=this.api.config.installedTransformers();s.length>0&&i.config.use(...s);const a=new this.ContextConstructor(t,i,this.me);try{await hi(this.middleware(),a)}catch(c){throw ct(`Error in middleware for update ${t.update_id}`),new Cr(c,a)}}async start(t){var i,s,a;const n=[];if(this.isInited()||n.push(this.init((i=this.pollingAbortController)==null?void 0:i.signal)),this.pollingRunning){await Promise.all(n),xe("Simple long polling already running!");return}this.pollingRunning=!0,this.pollingAbortController=new AbortController;try{n.push(Sn(async()=>{var c;await this.api.deleteWebhook({drop_pending_updates:t==null?void 0:t.drop_pending_updates},(c=this.pollingAbortController)==null?void 0:c.signal)},(s=this.pollingAbortController)==null?void 0:s.signal)),await Promise.all(n),await((a=t==null?void 0:t.onStart)==null?void 0:a.call(t,this.botInfo))}catch(c){throw this.pollingRunning=!1,this.pollingAbortController=void 0,c}this.pollingRunning&&(Oo(this.observedUpdateTypes,t==null?void 0:t.allowed_updates),this.use=Bo,xe("Starting simple long polling"),await this.loop(t),xe("Middleware is done running"))}async stop(){var t;if(this.pollingRunning){xe("Stopping bot, saving update offset"),this.pollingRunning=!1,(t=this.pollingAbortController)==null||t.abort();const n=this.lastTriedUpdateId+1;await this.api.getUpdates({offset:n,limit:1}).finally(()=>this.pollingAbortController=void 0)}else xe("Bot is not running!")}isRunning(){return this.pollingRunning}catch(t){this.errorHandler=t}async loop(t){const n=t==null?void 0:t.limit,i=(t==null?void 0:t.timeout)??30;let s=(t==null?void 0:t.allowed_updates)??[];try{for(;this.pollingRunning;){const a=await this.fetchUpdates({limit:n,timeout:i,allowed_updates:s});if(a===void 0)break;await this.handleUpdates(a),s=void 0}}finally{this.pollingRunning=!1}}async fetchUpdates({limit:t,timeout:n,allowed_updates:i}){var c;const s=this.lastTriedUpdateId+1;let a;do try{a=await this.api.getUpdates({offset:s,limit:t,timeout:n,allowed_updates:i},(c=this.pollingAbortController)==null?void 0:c.signal)}catch(u){await this.handlePollingError(u)}while(a===void 0&&this.pollingRunning);return a}async handlePollingError(t){if(!this.pollingRunning){xe("Pending getUpdates request cancelled");return}let n=3;if(t instanceof qr){if(ct(t.message),t.error_code===401||t.error_code===409)throw t;t.error_code===429&&(ct("Bot API server is closing."),n=t.parameters.retry_after??n)}else ct(t);ct(`Call to getUpdates failed, retrying in ${n} seconds ...`),await Sr(n)}}async function Sn(r,e){let n=50;async function i(a){let c=!1,u="rethrow";if(a instanceof _i)c=!0,u="retry";else if(a instanceof qr){if(a.error_code>=500)c=!0,u="retry";else if(a.error_code===429){const d=a.parameters.retry_after;typeof d=="number"?(await Sr(d,e),n=50):c=!0,u="retry"}}if(c){n!==50&&await Sr(n,e);const d=20*60*1e3;n=Math.min(d,2*n)}return u}let s={ok:!1};for(;!s.ok;)try{s={ok:!0,value:await r()}}catch(a){switch(ct(a),await i(a)){case"retry":continue;case"rethrow":throw a}}return s.value}async function Sr(r,e){let t,n;function i(){n==null||n(new Error("Aborted delay")),t!==void 0&&clearTimeout(t)}try{await new Promise((s,a)=>{if(n=a,e!=null&&e.aborted){i();return}e==null||e.addEventListener("abort",i),t=setTimeout(s,1e3*r)})}finally{e==null||e.removeEventListener("abort",i)}}function Oo(r,e=Mi){const t=Array.from(r).filter(n=>!e.includes(n));t.length>0&&Do(`You registered listeners for the following update types, but you did not specify them in \`allowed_updates\` so they may not be received: ${t.map(n=>`'${n}'`).join(", ")}`)}function Bo(){throw new Error(`It looks like you are registering more listeners on your bot from within other listeners! This means that every time your bot handles a message like this one, new listeners will be added. This list grows until your machine crashes, so grammY throws this error to tell you that you should probably do things a bit differently. If you're unsure how to resolve this problem, you can ask in the group chat: https://telegram.me/grammyjs

On the other hand, if you actually know what you're doing and you do need to install further middleware while your bot is running, consider installing a composer instance on your bot, and in turn augment the composer after the fact. This way, you can circumvent this protection against memory leaks.`)}[...Mi];ie("grammy:session");ie("grammy:error");function Qo(r){var s,a;const e=(r||"").trim();if(!e)return"?";const t=e.split(/\s+/).filter(Boolean),n=((s=t[0])==null?void 0:s[0])||"",i=((a=t[1])==null?void 0:a[0])||"";return(n+i).toUpperCase()||n.toUpperCase()||"?"}function qo(r){return(r||"").replace(/\s+/g," ").slice(0,60)}function Go(r){return r.from?[r.from.first_name,r.from.last_name].filter(Boolean).join(" ")||r.from.username||"Ngi dng":r.author_signature?r.author_signature:"H thng"}function Wo(){let r=localStorage.getItem("token")||"",e=$state(r),t=$state(localStorage.getItem("proxyBase")||""),n=$state(new Map),i=$state(null),s=$state(null),a=$state(new Map),c=$state([]),u=$state(null),d=$state(!1),o=$state(!1),l=$state(window.innerWidth>768),h=$state(!1),f=null;const m=b=>{e=b,localStorage.setItem("token",b),n.clear(),i=null,a.clear(),o=!1,k(),b&&C()},g=()=>{const b=prompt("Enter your bot token:");if(!b)throw new Error("Bot token is required");return m(b),b},w=()=>{if(!e)return;const b={proxyBase:t,chats:Array.from(n.entries()).map(([v,$])=>[v,{...$,messageIds:[...$.messageIds]}]),currentChatId:i,cachedFileUrls:Array.from(a.entries())};localStorage.setItem(`telegram_${e}`,JSON.stringify(b))},k=()=>{if(!e)return;const b=localStorage.getItem(`telegram_${e}`);if(b)try{const v=JSON.parse(b);if(t=v.proxyBase||"",v.chats){const $=new Map;for(const[Q,se]of v.chats){const te=se;$.set(Q,{...te,messageIds:new Set(te.messageIds)})}n=$}i=v.currentChatId||null,v.cachedFileUrls&&(a=new Map(v.cachedFileUrls)),o=!1}catch(v){console.error("Error loading state:",v)}},C=async()=>{if(e)try{f=new Uo(e),t&&f.api.config.use(async(b,v,$,Q)=>{const se=`https://api.telegram.org/bot${e}/${v}`,te=t.replace(/\/+$/,"")+"/"+se;return(await fetch(te,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($||{}),signal:Q})).json()}),u=await f.api.getMe(),document.title=`${u==null?void 0:u.first_name} - Bottelegram`||"Bottelegram",f.command("start",b=>b.reply(`Welcome! This bot is powered by 
https://bottelegram.web.app

Channel: @contentdownload

Group: @contentdownload_group`)),f.on("message",async b=>{const v=b.message;v!=null&&v.chat&&await S(v.chat.id.toString(),v,!0)}),await f.start(),d=!0}catch(b){console.error("Error initializing bot:",b),d=!1,H("Connection Error","Failed to initialize bot. Please check your token.","error")}},S=async(b,v,$)=>{var ot;if(!n.has(b)){const O=v.chat,Pe=O.type==="private"?[v.chat.first_name,v.chat.last_name].filter(Boolean).join(" ")||v.chat.username||"Ngi dng":v.chat.title||O.type||"Chat";n.set(b,{id:b,type:O.type,title:Pe,avatarText:Qo(Pe),messages:[],messageIds:new Set,lastText:"",lastDate:0,unread:0})}const Q=n.get(b),se=Go(v),te={id:v.message_id,chatId:b,side:$?"left":"right",date:(v.date||Math.floor(Date.now()/1e3))*1e3,fromName:se,reply_to:(ot=v.reply_to_message)==null?void 0:ot.message_id,reply_preview:v.reply_to_message?qo(v.reply_to_message.text||v.reply_to_message.caption||""):void 0};let z;if(v.text)z={...te,type:"text",text:v.text};else if(v.photo){const O=v.photo[v.photo.length-1],Oe=await T(O.file_id);z={...te,type:"photo",mediaUrl:Oe,caption:v.caption||""}}else if(v.video){const O=await T(v.video.file_id);z={...te,type:"video",mediaUrl:O,caption:v.caption||""}}else if(v.audio){const O=await T(v.audio.file_id);z={...te,type:"audio",mediaUrl:O,caption:v.caption||""}}else if(v.voice){const O=await T(v.voice.file_id);z={...te,type:"voice",mediaUrl:O,caption:v.caption||""}}else if(v.document){const O=await T(v.document.file_id);z={...te,type:"document",mediaUrl:O,caption:v.caption||"",fileName:v.document.file_name||"Tp"}}else if(v.sticker){const O=v.sticker;let Oe="tgs",Pe="";O.is_video?(Oe="webm",Pe=await T(O.file_id)):O.is_animated||(Oe="webp",Pe=await T(O.file_id)),z={...te,type:"sticker",mediaUrl:Pe,stickerFormat:Oe,emoji:O.emoji||""}}else z={...te,type:"text",text:"[Khng hin th loi ni dung ny]"};if(!Q.messageIds.has(z.id)){Q.messageIds.add(z.id),Q.messages.push(z);let O="";z.type==="text"?O=z.text:"caption"in z&&z.caption?O=z.caption:"text"in z?O=z.text:O=`[${z.type}]`,Q.lastText=O,Q.lastDate=z.date,$&&(b!==i?(Q.unread++,H(Q.title,Q.lastText,"info")):o=!0),w()}},T=async b=>{if(a.has(b))return a.get(b);if(!f)throw new Error("Bot not initialized");try{const v=await f.api.getFile(b),Q=`https://api.telegram.org/file/bot${e}/${v.file_path}`;if(t){const se=t.replace(/\/+$/,"")+"/"+Q;a.set(b,se)}else a.set(b,Q);return w(),a.get(b)}catch(v){throw console.error("Error getting file URL:",v),v}},M=b=>{i=b,o=!1;const v=n.get(b);v&&(v.unread=0,w())},x=b=>{const v=n.get(b);v&&(v.unread=0,w())},F=b=>{o=b};let E=null;const L=()=>{try{E||(E=new(window.AudioContext||window.webkitAudioContext));const b=E.createOscillator(),v=E.createGain();b.connect(v),v.connect(E.destination),b.frequency.value=800,b.type="sine",v.gain.setValueAtTime(.3,E.currentTime),v.gain.exponentialRampToValueAtTime(.01,E.currentTime+.1),b.start(E.currentTime),b.stop(E.currentTime+.1)}catch(b){console.warn("Could not play notification sound:",b)}},H=(b,v,$="info",Q)=>{const se={id:Date.now().toString()+Math.random().toString(36).substr(2,9),title:b,body:v,type:$,timestamp:Date.now(),duration:Q||($==="error"?8e3:5e3)};c.push(se),($==="success"||$==="info")&&L()},j=b=>{const v=c.findIndex($=>$.id===b);v!==-1&&c.splice(v,1)},q=()=>{c.length=0},Z=async(b,v,$)=>{if(!f)throw new Error("Bot not initialized");try{const Q={chat_id:b,text:v};$&&(Q.reply_to_message_id=$);const se=await f.api.sendMessage(b,v,{reply_to_message_id:$});await S(b,se,!1),o=!1,H("Message Sent","Your message was delivered successfully","success",2e3)}catch(Q){throw console.error("Error sending message:",Q),H("Send Failed","Failed to send message. Please try again.","error"),Q}},be=async(b,v)=>{if(!f)throw new Error("Bot not initialized");await f.api.sendChatAction(b,v)},we=async(b,v)=>{if(!f)throw new Error("Bot not initialized");try{await f.api.deleteMessage(b,v);const $=n.get(b);$&&($.messages=$.messages.filter(Q=>Q.id!==v),$.messageIds.delete(v),w()),H("Message Deleted","Message was deleted successfully","success",2e3)}catch($){throw console.error("Error deleting message:",$),H("Delete Failed","Failed to delete message. Please try again.","error"),$}},Ue=async b=>{if(!f)throw new Error("Bot not initialized");return f.api.getChat(b)},Ce=async b=>{if(!f)throw new Error("Bot not initialized");return f.api.getChatAdministrators(b)},ee=()=>{s=null},at=(b,v)=>{s=b};return k(),{token:e,proxyBase:t,chats:n,currentChatId:i,replyTo:s,cachedFileUrls:a,toastQueue:c,botInfo:u,isConnected:d,hasNewerMessages:o,showSidebar:l,showSettings:h,...{initializeBot:C,selectChat:M,markRead:x,saveState:w,loadState:k,setHasNewerMessages:F,enqueueToast:H,dismissToast:j,clearToasts:q,sendText:Z,sendChatAction:be,deleteMessage:we,getChat:Ue,getChatAdministrators:Ce,getFileUrl:T,clearReplyContext:ee,setReplyContext:at,setToken:m,getTokenPrompt:g}}}const G=Wo(),Vo=(r,e)=>{Notification.permission==="granted"?new Notification(r,{body:e}):Notification.permission!=="denied"&&Notification.requestPermission().then(t=>{t==="granted"&&new Notification(r,{body:e})})};ns();/**
 * @license lucide-svelte v0.473.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 */const zo={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Ho=Qs("<svg><!><!></svg>");function Fe(r,e){const t=me(e,["children","$$slots","$$events","$$legacy"]),n=me(t,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);je(e,!1);let i=Ge(e,"name",8,void 0),s=Ge(e,"color",8,"currentColor"),a=Ge(e,"size",8,24),c=Ge(e,"strokeWidth",8,2),u=Ge(e,"absoluteStrokeWidth",8,!1),d=Ge(e,"iconNode",24,()=>[]);const o=(...g)=>g.filter((w,k,C)=>!!w&&C.indexOf(w)===k).join(" ");sa();var l=Ho();let h;var f=y(l);ir(f,1,d,Br,(g,w)=>{let k=()=>_(w)[0],C=()=>_(w)[1];var S=ve(),T=ge(S);Zs(T,k,!0,(M,x)=>{let F;re(()=>F=an(M,F,{...C()},void 0,M.namespaceURI===Ln,M.nodeName.includes("-")))}),R(g,S)});var m=A(f);_e(m,e,"default",{},null),re(()=>h=an(l,h,{...zo,...n,width:a(),height:a(),stroke:s(),"stroke-width":u()?Number(c())*24/Number(a()):c(),class:o("lucide-icon","lucide",i()?`lucide-${i()}`:"",t.class)},void 0,!0)),R(r,l),De()}function Yo(r,e){const t=me(e,["children","$$slots","$$events","$$legacy"]);Fe(r,Ae({name:"circle-alert"},()=>t,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16"}]],children:(i,s)=>{var a=ve(),c=ge(a);_e(c,e,"default",{},null),R(i,a)},$$slots:{default:!0}}))}function Ko(r,e){const t=me(e,["children","$$slots","$$events","$$legacy"]);Fe(r,Ae({name:"circle-check-big"},()=>t,{iconNode:[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335"}],["path",{d:"m9 11 3 3L22 4"}]],children:(i,s)=>{var a=ve(),c=ge(a);_e(c,e,"default",{},null),R(i,a)},$$slots:{default:!0}}))}function Jo(r,e){const t=me(e,["children","$$slots","$$events","$$legacy"]);Fe(r,Ae({name:"info"},()=>t,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 16v-4"}],["path",{d:"M12 8h.01"}]],children:(i,s)=>{var a=ve(),c=ge(a);_e(c,e,"default",{},null),R(i,a)},$$slots:{default:!0}}))}function Zo(r,e){const t=me(e,["children","$$slots","$$events","$$legacy"]);Fe(r,Ae({name:"menu"},()=>t,{iconNode:[["line",{x1:"4",x2:"20",y1:"12",y2:"12"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18"}]],children:(i,s)=>{var a=ve(),c=ge(a);_e(c,e,"default",{},null),R(i,a)},$$slots:{default:!0}}))}function Xo(r,e){const t=me(e,["children","$$slots","$$events","$$legacy"]);Fe(r,Ae({name:"paperclip"},()=>t,{iconNode:[["path",{d:"M13.234 20.252 21 12.3"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486"}]],children:(i,s)=>{var a=ve(),c=ge(a);_e(c,e,"default",{},null),R(i,a)},$$slots:{default:!0}}))}function el(r,e){const t=me(e,["children","$$slots","$$events","$$legacy"]);Fe(r,Ae({name:"send"},()=>t,{iconNode:[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]],children:(i,s)=>{var a=ve(),c=ge(a);_e(c,e,"default",{},null),R(i,a)},$$slots:{default:!0}}))}function tl(r,e){const t=me(e,["children","$$slots","$$events","$$legacy"]);Fe(r,Ae({name:"settings-2"},()=>t,{iconNode:[["path",{d:"M20 7h-9"}],["path",{d:"M14 17H5"}],["circle",{cx:"17",cy:"17",r:"3"}],["circle",{cx:"7",cy:"7",r:"3"}]],children:(i,s)=>{var a=ve(),c=ge(a);_e(c,e,"default",{},null),R(i,a)},$$slots:{default:!0}}))}function rl(r,e){const t=me(e,["children","$$slots","$$events","$$legacy"]);Fe(r,Ae({name:"triangle-alert"},()=>t,{iconNode:[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]],children:(i,s)=>{var a=ve(),c=ge(a);_e(c,e,"default",{},null),R(i,a)},$$slots:{default:!0}}))}function Tn(r,e){const t=me(e,["children","$$slots","$$events","$$legacy"]);Fe(r,Ae({name:"users-round"},()=>t,{iconNode:[["path",{d:"M18 21a8 8 0 0 0-16 0"}],["circle",{cx:"10",cy:"8",r:"5"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3"}]],children:(i,s)=>{var a=ve(),c=ge(a);_e(c,e,"default",{},null),R(i,a)},$$slots:{default:!0}}))}function Si(r,e){const t=me(e,["children","$$slots","$$events","$$legacy"]);Fe(r,Ae({name:"x"},()=>t,{iconNode:[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]],children:(i,s)=>{var a=ve(),c=ge(a);_e(c,e,"default",{},null),R(i,a)},$$slots:{default:!0}}))}var nl=V('<div class="flex items-center gap-2"><button class="inline-flex h-10 w-10 items-center justify-center rounded-full border border-slate-700 text-slate-200 transition hover:bg-slate-800 md:hidden" aria-label="Open members panel"><!></button> <button class="hidden items-center gap-2 rounded-full border border-slate-700 px-3 py-1 text-xs font-medium text-slate-200 transition hover:border-slate-500 hover:text-white md:flex" aria-label="Open members panel"><!> Members</button></div>'),il=V('<header class="flex items-center justify-between border-b border-slate-800 bg-slate-900 px-4 py-3"><div class="flex min-w-0 items-center gap-3"><button class="inline-flex h-10 w-10 items-center justify-center rounded-full border border-slate-700 text-slate-200 transition hover:bg-slate-800 md:hidden" aria-label="Toggle sidebar"><!></button> <div class="flex h-10 w-10 items-center justify-center rounded-full bg-slate-800 text-sm font-semibold uppercase text-slate-100"> </div> <div class="flex min-w-0 flex-col"><span class="truncate text-sm font-semibold text-white md:text-base"> </span> <div class="mt-1 flex items-center gap-2 text-xs text-slate-400"><span aria-hidden="true"></span> <span class="truncate"> </span></div></div></div> <div class="flex items-center gap-2 md:gap-3"><!> <div class="hidden min-w-0 flex-col text-right text-xs text-slate-400 lg:flex"><span class="truncate"> </span></div> <button class="inline-flex h-10 w-10 items-center justify-center rounded-full border border-slate-700 text-slate-200 transition hover:bg-slate-800" aria-label="Open settings"><!></button></div></header>');function sl(r,e){je(e,!0);const t=K(()=>()=>{var j;return((j=e.activeChat)==null?void 0:j.title)??"Select a chat"}),n=K(()=>()=>{var j;return((j=e.activeChat)==null?void 0:j.avatarText)??"?"}),i=K(()=>()=>e.botInfo?`${e.botInfo.username?`@${e.botInfo.username}`:e.botInfo.first_name}  ID ${e.botInfo.id}`:"Bot disconnected"),s=K(()=>()=>{var q;const j=((q=e.statusText)==null?void 0:q.toLowerCase())??"";return j.includes("token")?"bg-slate-500":j.includes("connected")&&!j.includes("disconnected")?"bg-emerald-500":j.includes("disconnected")||j.includes("error")?"bg-rose-500":"bg-amber-400"});var a=il(),c=y(a),u=y(c);u.__click=function(...j){var q;(q=e.toggleSidebar)==null||q.apply(this,j)};var d=y(u);Zo(d,{class:"h-5 w-5"});var o=A(u,2),l=y(o),h=A(o,2),f=y(h),m=y(f),g=A(f,2),w=y(g),k=A(w,2),C=y(k),S=A(c,2),T=y(S);{var M=j=>{var q=nl(),Z=y(q);Z.__click=function(...Ce){var ee;(ee=e.onToggleMembers)==null||ee.apply(this,Ce)};var be=y(Z);Tn(be,{class:"h-5 w-5"});var we=A(Z,2);we.__click=function(...Ce){var ee;(ee=e.onToggleMembers)==null||ee.apply(this,Ce)};var Ue=y(we);Tn(Ue,{class:"h-4 w-4"}),R(j,q)};he(T,j=>{e.canShowMembers&&j(M)})}var x=A(T,2),F=y(x),E=y(F),L=A(x,2);L.__click=function(...j){var q;(q=e.toggleSettings)==null||q.apply(this,j)};var H=y(L);tl(H,{class:"h-5 w-5"}),re(()=>{Y(l,_(n)),Y(m,_(t)),$e(w,`inline-flex h-2 w-2 rounded-full ${_(s)}`),Y(C,e.statusText),Y(E,_(i))}),R(r,a),De()}Ke(["click"]);const al=(r,e)=>{localStorage.setItem("token",_(e)),window.location.reload()};var ol=V('<section class="rounded-xl border border-slate-800 bg-slate-900/80 p-5 shadow-inner"><h2 class="text-lg font-semibold text-white">Bot information</h2> <dl class="mt-4 grid grid-cols-1 gap-4 text-sm text-slate-300 sm:grid-cols-2"><div><dt class="text-xs uppercase tracking-wide text-slate-500">ID</dt> <dd class="mt-1 text-slate-100"> </dd></div> <div><dt class="text-xs uppercase tracking-wide text-slate-500">Name</dt> <dd class="mt-1 text-slate-100"> </dd></div> <div><dt class="text-xs uppercase tracking-wide text-slate-500">Username</dt> <dd class="mt-1 text-slate-100"> </dd></div> <div><dt class="text-xs uppercase tracking-wide text-slate-500">Can join groups</dt> <dd class="mt-1 text-slate-100"> </dd></div> <div><dt class="text-xs uppercase tracking-wide text-slate-500">Read group messages</dt> <dd class="mt-1 text-slate-100"> </dd></div></dl></section>'),ll=V('<div class="flex flex-col gap-6 bg-slate-900 px-6 py-6 text-slate-100"><!> <section class="rounded-xl border border-slate-800 bg-slate-900/80 p-5 shadow-inner"><h2 class="text-lg font-semibold text-white">Connection</h2> <p class="mt-2 text-sm text-slate-400">Update your bot token or clear cached chat history for a fresh start.</p> <div class="mt-4 flex flex-col gap-3 sm:flex-row"><input class="flex-1 rounded-lg border border-slate-800 bg-slate-900/80 px-4 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500" type="text" placeholder="Enter new bot token..."> <button class="inline-flex items-center justify-center rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white transition hover:bg-blue-500">Update token</button></div> <div class="mt-4 flex flex-col gap-3 sm:flex-row"><button class="inline-flex items-center justify-center rounded-lg border border-slate-700 px-4 py-2 text-sm font-medium text-slate-200 transition hover:border-slate-500 hover:text-white">Clear data</button> <div class="flex-1 text-xs text-slate-500">Removes local chat history stored for this bot token.</div></div></section></div>');function ul(r,e){je(e,!0);let t=Et(X(e.token));var n=ll(),i=y(n);{var s=h=>{var f=ol(),m=A(y(f),2),g=y(m),w=A(y(g),2),k=y(w),C=A(g,2),S=A(y(C),2),T=y(S),M=A(C,2),x=A(y(M),2),F=y(x),E=A(M,2),L=A(y(E),2),H=y(L),j=A(E,2),q=A(y(j),2),Z=y(q);re(()=>{Y(k,e.botInfo.id),Y(T,e.botInfo.first_name),Y(F,`@${e.botInfo.username??""}`),Y(H,e.botInfo.can_join_groups?"Yes":"No"),Y(Z,e.botInfo.can_read_all_group_messages?"Yes":"No")}),R(h,f)};he(i,h=>{e.botInfo&&h(s)})}var a=A(i,2),c=A(y(a),4),u=y(c),d=A(u,2);d.__click=[al,t];var o=A(c,2),l=y(o);l.__click=function(...h){var f;(f=e.clearData)==null||f.apply(this,h)},Qr(u,()=>_(t),h=>J(t,h)),R(r,n),De()}Ke(["click"]);var cl=V('<div class="px-4 py-3 text-sm text-slate-500">Search coming soon.</div>'),dl=V('<div class="px-4 py-6 text-center text-sm text-slate-500">No conversations yet. Messages will appear here once they arrive.</div>'),hl=(r,e,t)=>e(_(t).id),fl=V('<span class="ml-2 inline-flex h-6 min-w-[1.5rem] items-center justify-center rounded-full bg-blue-600 px-2 text-xs font-semibold text-white"> </span>'),pl=V('<button><div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-slate-800 text-sm font-semibold uppercase text-slate-100"> </div> <div class="flex min-w-0 flex-1 flex-col gap-1"><div class="flex items-center gap-2"><span class="truncate text-sm font-semibold text-slate-100"> </span> <span class="ml-auto text-xs text-slate-500"> </span></div> <span> </span></div> <!></button>'),ml=V('<div class="flex h-full flex-col bg-slate-950"><div class="border-b border-slate-900/60"><!></div> <div class="flex-1 overflow-y-auto"><!></div></div>');function gl(r,e){je(e,!0);function t(l){if(!l)return"";const h=new Date(l),f=new Date;if(h.toDateString()===f.toDateString()){const g=h.getHours().toString().padStart(2,"0"),w=h.getMinutes().toString().padStart(2,"0");return`${g}:${w}`}return h.toLocaleDateString()}const n=l=>{e.selectChat(l),typeof window<"u"&&window.innerWidth<768&&e.showSidebar&&e.toggleSidebar()};var i=ml(),s=y(i),a=y(s);_e(a,e,"search",{},l=>{var h=cl();R(l,h)});var c=A(s,2),u=y(c);{var d=l=>{var h=dl();R(l,h)},o=l=>{var h=ve(),f=ge(h);ir(f,17,()=>e.chats,Br,(m,g)=>{var w=pl();w.__click=[hl,n,g];var k=y(w),C=y(k),S=A(k,2),T=y(S),M=y(T),x=y(M),F=A(M,2),E=y(F);re(()=>Y(E,t(_(g).lastTimestamp)));var L=A(T,2),H=y(L),j=A(S,2);{var q=Z=>{var be=fl(),we=y(be);re(()=>Y(we,_(g).unread)),R(Z,be)};he(j,Z=>{_(g).unread&&Z(q)})}re(()=>{$e(w,`group relative flex w-full items-center gap-3 border-b border-slate-900/60 px-4 py-3 text-left transition ${e.currentChat===_(g).id?"bg-slate-900":"hover:bg-slate-900/60"}`),Jt(w,"aria-pressed",e.currentChat===_(g).id),Y(C,_(g).avatarText??"?"),Y(x,_(g).name),$e(L,`truncate text-xs ${_(g).unread?"text-slate-200":"text-slate-400"}`),Y(H,_(g).lastMessage||"No messages yet")}),R(m,w)}),R(l,h)};he(u,l=>{e.chats.length===0?l(d):l(o,!1)})}R(r,i),De()}Ke(["click"]);var vl=V('<div class="py-10 text-center text-sm text-slate-500">Select a chat to load messages.</div>'),_l=V('<div><div class="font-semibold text-slate-200">Replying to</div> <div class="truncate"> </div></div>'),wl=V('<div><div><span class="truncate font-medium"> </span> <span> </span></div> <!> <div><!></div></div>'),yl=V('<button class="fixed bottom-28 right-6 rounded-full bg-slate-800 p-3 text-white shadow-lg transition hover:bg-slate-700" aria-label="Scroll to bottom"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg></button>'),bl=V('<div class="relative flex-1 overflow-y-auto bg-slate-900 px-4 py-6"><!> <!> <!></div>');function Cl(r,e){je(e,!0);let t;ze(()=>{t&&e.setContainer(t)});function n(o){switch(o.type){case"text":return o.text;case"photo":return`<img src="${o.mediaUrl}" alt="Photo" class="max-w-full rounded-xl border border-slate-800/70 shadow-md" />${o.caption?`<p class="mt-2 text-sm text-slate-200">${o.caption}</p>`:""}`;case"video":return`<video src="${o.mediaUrl}" controls class="max-w-full rounded-xl border border-slate-800/70 shadow-md" />${o.caption?`<p class="mt-2 text-sm text-slate-200">${o.caption}</p>`:""}`;case"audio":case"voice":return`<audio src="${o.mediaUrl}" controls class="w-full" />${o.caption?`<p class="mt-2 text-sm text-slate-200">${o.caption}</p>`:""}`;case"document":return`<a href="${o.mediaUrl}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 rounded-lg border border-slate-800/70 bg-slate-900/80 p-3 text-sm text-slate-100 transition hover:border-slate-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
            <span class="truncate">${o.fileName||"Document"}</span>
          </a>${o.caption?`<p class="mt-2 text-sm text-slate-200">${o.caption}</p>`:""}`;case"sticker":return o.stickerFormat==="webp"?`<img src="${o.mediaUrl}" alt="${o.emoji||"Sticker"}" class="max-w-[8rem] rounded-lg" />`:o.stickerFormat==="webm"?`<video src="${o.mediaUrl}" autoplay loop muted playsinline class="max-w-[8rem] rounded-lg" />`:`<span class="text-2xl">${o.emoji||""}</span>`;default:return"[Unsupported message type]"}}var i=bl(),s=y(i);{var a=o=>{var l=vl();R(o,l)};he(s,o=>{e.messages.length===0&&o(a)})}var c=A(s,2);ir(c,17,()=>e.messages,Br,(o,l)=>{var h=wl(),f=y(h),m=y(f),g=y(m),w=A(m,2),k=y(w);re(()=>Y(k,new Date(_(l).date).toLocaleString()));var C=A(f,2);{var S=x=>{var F=_l(),E=A(y(F),2),L=y(E);re(()=>{$e(F,`mb-2 rounded-lg border border-slate-800/70 bg-slate-900/70 px-3 py-2 text-xs text-slate-300 ${_(l).side==="right"?"text-right":"text-left"}`),Y(L,_(l).reply_preview)}),R(x,F)};he(C,x=>{_(l).reply_preview&&x(S)})}var T=A(C,2),M=y(T);Ks(M,()=>n(_(l))),re(()=>{$e(h,`mb-5 max-w-[min(78%,32rem)] ${_(l).side==="right"?"ml-auto":""}`),$e(f,`mb-1 flex items-center gap-2 text-xs ${_(l).side==="right"?"justify-end text-slate-400":"text-slate-500"}`),Y(g,_(l).fromName),$e(T,`rounded-2xl px-4 py-3 text-sm leading-relaxed shadow-lg ${_(l).side==="right"?"bg-blue-600 text-white":"bg-slate-800/80 text-slate-100"}`)}),R(o,h)});var u=A(c,2);{var d=o=>{var l=yl();l.__click=function(...h){var f;(f=e.scrollToBottom)==null||f.apply(this,h)},R(o,l)};he(u,o=>{e.showScrollButton&&o(d)})}ia(i,o=>t=o,()=>t),wr("scroll",i,function(...o){var l;(l=e.handleScroll)==null||l.apply(this,o)}),R(r,i),De()}Ke(["click"]);const xl=(r,e)=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),e())};var kl=V('<div class="mb-3 flex items-start gap-3 rounded-xl border border-slate-800 bg-slate-900/80 px-3 py-2 text-xs text-slate-200"><div class="flex-1"><span class="text-[11px] uppercase tracking-wide text-slate-500">Replying to</span> <p class="mt-1 overflow-hidden text-sm text-slate-200" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;"> </p></div> <button class="mt-1 rounded-full p-1 text-slate-400 transition hover:bg-slate-800 hover:text-white" aria-label="Cancel reply"><!></button></div>'),Ml=V('<div class="px-4 py-3"><!> <div class="flex items-end gap-3"><button class="flex h-10 w-10 items-center justify-center rounded-full border border-slate-700 text-slate-200 transition hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-50" aria-label="Attach file"><!></button> <div class="relative flex-1"><textarea class="h-11 w-full resize-none rounded-2xl border border-slate-800 bg-slate-900/80 px-4 py-3 text-sm text-slate-100 placeholder:text-slate-500 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-60"></textarea></div> <button class="inline-flex h-11 min-w-[3rem] items-center justify-center rounded-2xl bg-blue-600 px-4 text-sm font-semibold text-white shadow-lg transition hover:bg-blue-500 disabled:cursor-not-allowed disabled:bg-slate-700 disabled:text-slate-400" aria-label="Send message"><!></button></div></div>');function Sl(r,e){je(e,!0);let t=Et("");const n=()=>{const m=_(t).trim();!m||e.disabled||(e.sendMessage(m),J(t,""))};var i=Ml(),s=y(i);{var a=m=>{var g=kl(),w=y(g),k=A(y(w),2),C=y(k),S=A(w,2);S.__click=function(...M){var x;(x=e.clearReply)==null||x.apply(this,M)};var T=y(S);Si(T,{class:"h-4 w-4"}),re(()=>Y(C,e.replyPreview)),R(m,g)};he(s,m=>{e.replyPreview&&m(a)})}var c=A(s,2),u=y(c);u.__click=function(...m){var g;(g=e.onAttach)==null||g.apply(this,m)};var d=y(u);Xo(d,{class:"h-5 w-5"});var o=A(u,2),l=y(o);Jt(l,"rows",1),l.__keydown=[xl,n];var h=A(o,2);h.__click=n,re(()=>h.disabled=e.disabled||!_(t).trim());var f=y(h);el(f,{class:"h-5 w-5"}),re(()=>{u.disabled=e.disabled,Jt(l,"placeholder",e.disabled?"Select a chat to start messaging":"Write a message..."),l.disabled=e.disabled}),Qr(l,()=>_(t),m=>J(t,m)),R(r,i),De()}Ke(["click","keydown"]);var Tl=V('<p class="text-sm opacity-90 mt-1 leading-tight break-words"> </p>'),Il=(r,e,t)=>e(_(t).id),El=V('<div role="alert" aria-live="polite"><!> <div class="flex-1 min-w-0 svelte-239z62"><h4 class="font-semibold text-sm leading-tight break-words"> </h4> <!></div> <button type="button" class="flex-shrink-0 p-1 rounded-md opacity-70 hover:opacity-100 transition-opacity focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-current" aria-label="Dismiss notification"><!></button></div>'),Al=V('<div class="fixed bottom-4 right-4 z-50 flex flex-col gap-2 pointer-events-none svelte-239z62"></div>');function Fl(r,e){je(e,!0);let t=Ge(e,"toasts",19,()=>[]);const n=new Map,i={info:Jo,success:Ko,warning:rl,error:Yo},s={info:"bg-blue-500 border-blue-600 text-white",success:"bg-green-500 border-green-600 text-white",warning:"bg-yellow-500 border-yellow-600 text-white",error:"bg-red-500 border-red-600 text-white"};ze(()=>{t().forEach(o=>{if(!n.has(o.id)){const l=setTimeout(()=>{a(o.id)},o.duration||5e3);n.set(o.id,l)}});for(const[o,l]of n.entries())t().find(h=>h.id===o)||(clearTimeout(l),n.delete(o))});const a=o=>{const l=t().findIndex(f=>f.id===o);l!==-1&&t().splice(l,1);const h=n.get(o);h&&(clearTimeout(h),n.delete(o))},c=o=>{const l=n.get(o);l&&(clearTimeout(l),n.delete(o))},u=o=>{const l=setTimeout(()=>{a(o.id)},o.duration||5e3);n.set(o.id,l)};ca(()=>{n.forEach(o=>clearTimeout(o))});var d=Al();ir(d,21,t,o=>o.id,(o,l)=>{var h=El();const f=K(()=>i[_(l).type]),m=K(()=>s[_(l).type]);var g=y(h);Js(g,()=>_(f),(F,E)=>{E(F,{class:"w-5 h-5 flex-shrink-0 mt-0.5"})});var w=A(g,2),k=y(w),C=y(k),S=A(k,2);{var T=F=>{var E=Tl(),L=y(E);re(()=>Y(L,_(l).body)),R(F,E)};he(S,F=>{_(l).body&&F(T)})}var M=A(w,2);M.__click=[Il,a,l];var x=y(M);Si(x,{class:"w-4 h-4"}),re(()=>{$e(h,`pointer-events-auto flex items-start gap-3 p-4 rounded-lg border shadow-lg max-w-sm min-w-[300px] transform transition-all duration-300 ease-in-out ${_(m)??""} svelte-239z62`),na(h,"animate-pulse",_(l).type==="warning"),Y(C,_(l).title)}),wr("mouseenter",h,()=>c(_(l).id)),wr("mouseleave",h,()=>u(_(l))),R(o,h)}),R(r,d),De()}Ke(["click"]);const Pl=(r,e,t)=>{e(),t(!1)};var Rl=(r,e)=>{r.target===r.currentTarget&&e()},$l=V('<div class="fixed inset-0 z-30 bg-slate-950/70 backdrop-blur-sm transition-opacity duration-200 md:hidden" role="presentation"></div>'),Ll=V('<div slot="search" class="px-4 py-3"><label class="sr-only" for="chat-search">Search chats</label> <div class="relative"><input id="chat-search" type="text" placeholder="Search chats..." class="w-full rounded-xl border border-slate-800 bg-slate-900/80 px-4 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="none" stroke="currentColor" class="pointer-events-none absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-500"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m1-5a6 6 0 1 1-12 0 6 6 0 0 1 12 0Z"></path></svg></div></div>'),Nl=V('<button class="absolute bottom-28 right-6 flex items-center gap-2 rounded-full bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-lg transition hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-300"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="h-5 w-5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m5 10 7 7 7-7"></path></svg> <span>New messages</span></button>'),jl=(r,e)=>{r.target===r.currentTarget&&e()},Dl=r=>r.stopPropagation(),Ul=V('<div class="fixed inset-0 z-50 flex items-center justify-center bg-slate-950/70 px-4 py-8" role="dialog" aria-modal="true"><div class="relative w-full max-w-2xl overflow-hidden rounded-2xl border border-slate-800 bg-slate-900 shadow-2xl"><button class="absolute right-3 top-3 rounded-full bg-slate-800/80 p-2 text-slate-300 transition hover:bg-slate-700 hover:text-white" aria-label="Close settings"></button> <!></div></div>'),Ol=(r,e)=>{r.target===r.currentTarget&&J(e,!1)},Bl=r=>r.stopPropagation(),Ql=(r,e)=>J(e,!1),ql=V('<div class="fixed inset-0 z-40 flex items-center justify-center bg-slate-950/70 px-4 py-8" role="dialog" aria-modal="true"><div class="w-full max-w-lg rounded-2xl border border-slate-800 bg-slate-900 p-8 text-center shadow-xl"><h2 class="text-lg font-semibold text-white">Members panel</h2> <p class="mt-3 text-sm text-slate-400">Group member management will be available in an upcoming update.</p> <button class="mt-6 inline-flex items-center justify-center rounded-full border border-slate-700 px-4 py-2 text-sm font-medium text-slate-200 transition hover:border-slate-500 hover:text-white">Close</button></div></div>'),Gl=V('<div class="relative flex h-screen w-screen bg-slate-950 text-slate-100"><!> <aside><!></aside> <section class="flex flex-1 flex-col overflow-hidden"><!> <div class="relative flex flex-1 flex-col overflow-hidden bg-slate-900"><!> <div class="border-t border-slate-800 bg-slate-900"><!></div> <!></div></section> <!> <!> <!></div>');function Wl(r,e){je(e,!0);const t=G.initializeBot,n=G.selectChat,i=G.markRead,s=G.enqueueToast,a=G.sendText,c=G.clearReplyContext,u=G.getTokenPrompt,d=G.setHasNewerMessages;let o=X(G.token),l=X(G.chats),h=X(G.currentChatId),f=X(G.replyTo),m=G.toastQueue,g=X(G.botInfo),w=X(G.isConnected),k=X(G.showSidebar),C=X(G.showSettings),S=X(G.hasNewerMessages),T=Et(null),M=Et(""),x=Et(!1);ze(()=>{if(o)t();else try{u()}catch(I){console.error("Failed to get token:",I)}}),ze(()=>{m.slice(-3).forEach(N=>{(N.type==="error"||N.type==="warning"||N.type==="success")&&Vo(N.title,N.body)})});const F=K(()=>h?l.get(h):void 0),E=K(()=>{var I;return((I=_(F))==null?void 0:I.messages)||[]});function L(I){return I?I.type==="text"?I.text:"caption"in I&&I.caption?I.caption:"text"in I&&I.text?I.text:`[${I.type}]`:null}const H=K(()=>()=>{if(!f||!_(F))return null;const I=_(F).messages.find(N=>N.id===f);return L(I)});function j(I){const N=I.trim();return N.length<=80?N:`${N.slice(0,77)}`}const q=K(()=>()=>{const I=_(M).trim().toLowerCase(),N=Array.from(l.values()).sort((B,pe)=>pe.lastDate-B.lastDate).map(B=>({id:B.id,name:B.title,avatarText:B.avatarText,lastMessage:B.lastText?j(B.lastText):"",lastTimestamp:B.lastDate,unread:B.unread,hasNotification:B.unread>0}));return I?N.filter(B=>{var Kr;const pe=B.name.toLowerCase().includes(I),Mt=B.id.toLowerCase().includes(I),sr=(Kr=B.lastMessage)==null?void 0:Kr.toLowerCase().includes(I);return pe||Mt||sr}):N}),Z=K(()=>()=>o?w?"Connected":"Disconnected":"Token required"),be=K(()=>()=>_(F)?["group","supergroup"].includes(_(F).type):!1),we=K(()=>()=>_(F)?{id:_(F).id,title:_(F).title,avatarText:_(F).avatarText,type:_(F).type}:null),Ue=()=>{o&&(localStorage.removeItem(`telegram_${o}`),G.chats.clear(),G.currentChatId=null,d(!1))},Ce=()=>{if(!_(T))return;const{scrollTop:I,scrollHeight:N,clientHeight:B}=_(T);N-(I+B)<120&&d(!1)},ee=()=>{_(T)&&(_(T).scrollTop=_(T).scrollHeight)},at=I=>{!I.trim()||!h||a(h,I,f||void 0).then(()=>{c(),d(!1),requestAnimationFrame(()=>ee())}).catch(()=>{})},Gr=()=>{s("Attachments","File uploads will be available soon.","warning",4e3)},b=I=>{n(I),i(I),d(!1),setTimeout(()=>{ee()},0),typeof window<"u"&&window.innerWidth<768&&(G.showSidebar=!1)},v=()=>{G.showSidebar=!G.showSidebar},$=()=>{G.showSettings=!G.showSettings},Q=()=>{J(x,!_(x))};ze(()=>{if(_(E).length,!_(T))return;const{scrollTop:I,scrollHeight:N,clientHeight:B}=_(T);N-(I+B)<80&&requestAnimationFrame(()=>{ee(),d(!1)})});var se=Gl(),te=y(se);{var z=I=>{var N=$l();N.__click=[Rl,v],R(I,N)};he(te,I=>{k&&I(z)})}var ot=A(te,2),O=y(ot),Oe=K(()=>h||"");gl(O,{get chats(){return _(q)},get currentChat(){return _(Oe)},selectChat:b,get showSidebar(){return k},toggleSidebar:v,$$slots:{search:(I,N)=>{var B=Ll(),pe=A(y(B),2),Mt=y(pe);Qr(Mt,()=>_(M),sr=>J(M,sr)),R(I,B)}}});var Pe=A(ot,2),Wr=y(Pe);sl(Wr,{get botInfo(){return g},get statusText(){return _(Z)},get activeChat(){return _(we)},toggleSettings:$,toggleSidebar:v,onToggleMembers:Q,get canShowMembers(){return _(be)}});var Ti=A(Wr,2),Vr=y(Ti);Cl(Vr,{get messages(){return _(E)},setContainer:I=>{J(T,X(I))},showScrollButton:!1,scrollToBottom:ee,handleScroll:Ce});var zr=A(Vr,2),Ii=y(zr),Ei=K(()=>!h||!w);Sl(Ii,{sendMessage:at,get replyPreview(){return _(H)},clearReply:c,get disabled(){return _(Ei)},onAttach:Gr});var Ai=A(zr,2);{var Fi=I=>{var N=Nl();N.__click=[Pl,ee,d],R(I,N)};he(Ai,I=>{S&&h&&I(Fi)})}var Hr=A(Pe,2);{var Pi=I=>{var N=Ul();N.__click=[jl,$];var B=y(N);B.__click=[Dl];var pe=y(B);pe.__click=$;var Mt=A(pe,2);ul(Mt,{get botInfo(){return g},get token(){return o},clearData:Ue}),R(I,N)};he(Hr,I=>{C&&I(Pi)})}var Yr=A(Hr,2);{var Ri=I=>{var N=ql();N.__click=[Ol,x];var B=y(N);B.__click=[Bl];var pe=A(y(B),4);pe.__click=[Ql,x],R(I,N)};he(Yr,I=>{_(x)&&I(Ri)})}var $i=A(Yr,2);Fl($i,{toasts:m}),re(()=>$e(ot,`fixed inset-y-0 left-0 z-40 flex w-full max-w-xs transform flex-col overflow-hidden border-r border-slate-900/60 bg-slate-950 shadow-2xl transition-transform duration-200 md:static md:max-w-sm md:translate-x-0 md:shadow-none ${k?"translate-x-0":"-translate-x-full md:translate-x-0"}`)),R(r,se),De()}Ke(["click"]);qs(Wl,{target:document.getElementById("app")});
